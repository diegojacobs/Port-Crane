var __decorate = this && this.__decorate || function(e, t, i, r) { var n, o = arguments.length,
            s = o < 3 ? t : null === r ? r = Object.getOwnPropertyDescriptor(t, i) : r; if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) s = Reflect.decorate(e, t, i, r);
        else
            for (var a = e.length - 1; a >= 0; a--)(n = e[a]) && (s = (o < 3 ? n(s) : o > 3 ? n(t, i, s) : n(t, i)) || s); return o > 3 && s && Object.defineProperty(t, i, s), s },
    __extends = this && this.__extends || (function() { var e = Object.setPrototypeOf || { __proto__: [] }
        instanceof Array && function(e, t) { e.__proto__ = t } || function(e, t) { for (var i in t) t.hasOwnProperty(i) && (e[i] = t[i]) }; return function(t, i) {
            function r() { this.constructor = t }
            e(t, i), t.prototype = null === i ? Object.create(i) : (r.prototype = i.prototype, new r) } })(),
    BABYLON;
!(function(e) {
    e.ToGammaSpace = 1 / 2.2, e.ToLinearSpace = 2.2, e.Epsilon = .001;
    var t = (function() {
        function e() {} return e.WithinEpsilon = function(e, t, i) { void 0 === i && (i = 1.401298e-45); var r = e - t; return -i <= r && r <= i }, e.ToHex = function(e) { var t = e.toString(16); return e <= 15 ? ("0" + t).toUpperCase() : t.toUpperCase() }, e.Sign = function(e) { return e = +e, 0 === e || isNaN(e) ? e : e > 0 ? 1 : -1 }, e.Clamp = function(e, t, i) { return void 0 === t && (t = 0), void 0 === i && (i = 1), Math.min(i, Math.max(t, e)) }, e })();
    e.MathTools = t;
    var i = (function() {
        function i(e, t, i) { void 0 === e && (e = 0), void 0 === t && (t = 0), void 0 === i && (i = 0), this.r = e, this.g = t, this.b = i } return i.prototype.toString = function() { return "{R: " + this.r + " G:" + this.g + " B:" + this.b + "}" }, i.prototype.getClassName = function() { return "Color3" }, i.prototype.getHashCode = function() { var e = this.r || 0; return e = 397 * e ^ (this.g || 0), e = 397 * e ^ (this.b || 0) }, i.prototype.toArray = function(e, t) { return void 0 === t && (t = 0), e[t] = this.r, e[t + 1] = this.g, e[t + 2] = this.b, this }, i.prototype.toColor4 = function(e) { return void 0 === e && (e = 1), new r(this.r, this.g, this.b, e) }, i.prototype.asArray = function() { var e = []; return this.toArray(e, 0), e }, i.prototype.toLuminance = function() { return .3 * this.r + .59 * this.g + .11 * this.b }, i.prototype.multiply = function(e) { return new i(this.r * e.r, this.g * e.g, this.b * e.b) }, i.prototype.multiplyToRef = function(e, t) { return t.r = this.r * e.r, t.g = this.g * e.g, t.b = this.b * e.b, this }, i.prototype.equals = function(e) { return e && this.r === e.r && this.g === e.g && this.b === e.b }, i.prototype.equalsFloats = function(e, t, i) { return this.r === e && this.g === t && this.b === i }, i.prototype.scale = function(e) { return new i(this.r * e, this.g * e, this.b * e) }, i.prototype.scaleToRef = function(e, t) { return t.r = this.r * e, t.g = this.g * e, t.b = this.b * e, this }, i.prototype.add = function(e) { return new i(this.r + e.r, this.g + e.g, this.b + e.b) }, i.prototype.addToRef = function(e, t) { return t.r = this.r + e.r, t.g = this.g + e.g, t.b = this.b + e.b, this }, i.prototype.subtract = function(e) { return new i(this.r - e.r, this.g - e.g, this.b - e.b) }, i.prototype.subtractToRef = function(e, t) { return t.r = this.r - e.r, t.g = this.g - e.g, t.b = this.b - e.b, this }, i.prototype.clone = function() { return new i(this.r, this.g, this.b) }, i.prototype.copyFrom = function(e) { return this.r = e.r, this.g = e.g, this.b = e.b, this }, i.prototype.copyFromFloats = function(e, t, i) { return this.r = e, this.g = t, this.b = i, this }, i.prototype.set = function(e, t, i) { return this.copyFromFloats(e, t, i) }, i.prototype.toHexString = function() { var e = 255 * this.r | 0,
                i = 255 * this.g | 0,
                r = 255 * this.b | 0; return "#" + t.ToHex(e) + t.ToHex(i) + t.ToHex(r) }, i.prototype.toLinearSpace = function() { var e = new i; return this.toLinearSpaceToRef(e), e }, i.prototype.toLinearSpaceToRef = function(t) { return t.r = Math.pow(this.r, e.ToLinearSpace), t.g = Math.pow(this.g, e.ToLinearSpace), t.b = Math.pow(this.b, e.ToLinearSpace), this }, i.prototype.toGammaSpace = function() { var e = new i; return this.toGammaSpaceToRef(e), e }, i.prototype.toGammaSpaceToRef = function(t) { return t.r = Math.pow(this.r, e.ToGammaSpace), t.g = Math.pow(this.g, e.ToGammaSpace), t.b = Math.pow(this.b, e.ToGammaSpace), this }, i.FromHexString = function(e) { if ("#" !== e.substring(0, 1) || 7 !== e.length) return new i(0, 0, 0); var t = parseInt(e.substring(1, 3), 16),
                r = parseInt(e.substring(3, 5), 16),
                n = parseInt(e.substring(5, 7), 16); return i.FromInts(t, r, n) }, i.FromArray = function(e, t) { return void 0 === t && (t = 0), new i(e[t], e[t + 1], e[t + 2]) }, i.FromInts = function(e, t, r) { return new i(e / 255, t / 255, r / 255) }, i.Lerp = function(e, t, r) { return new i(e.r + (t.r - e.r) * r, e.g + (t.g - e.g) * r, e.b + (t.b - e.b) * r) }, i.Red = function() { return new i(1, 0, 0) }, i.Green = function() { return new i(0, 1, 0) }, i.Blue = function() { return new i(0, 0, 1) }, i.Black = function() { return new i(0, 0, 0) }, i.White = function() { return new i(1, 1, 1) }, i.Purple = function() { return new i(.5, 0, .5) }, i.Magenta = function() { return new i(1, 0, 1) }, i.Yellow = function() { return new i(1, 1, 0) }, i.Gray = function() { return new i(.5, .5, .5) }, i.Random = function() { return new i(Math.random(), Math.random(), Math.random()) }, i })();
    e.Color3 = i;
    var r = (function() {
        function e(e, t, i, r) { this.r = e, this.g = t, this.b = i, this.a = r } return e.prototype.addInPlace = function(e) { return this.r += e.r, this.g += e.g, this.b += e.b, this.a += e.a, this }, e.prototype.asArray = function() { var e = []; return this.toArray(e, 0), e }, e.prototype.toArray = function(e, t) { return void 0 === t && (t = 0), e[t] = this.r, e[t + 1] = this.g, e[t + 2] = this.b, e[t + 3] = this.a, this }, e.prototype.add = function(t) { return new e(this.r + t.r, this.g + t.g, this.b + t.b, this.a + t.a) }, e.prototype.subtract = function(t) { return new e(this.r - t.r, this.g - t.g, this.b - t.b, this.a - t.a) }, e.prototype.subtractToRef = function(e, t) { return t.r = this.r - e.r, t.g = this.g - e.g, t.b = this.b - e.b, t.a = this.a - e.a, this }, e.prototype.scale = function(t) { return new e(this.r * t, this.g * t, this.b * t, this.a * t) }, e.prototype.scaleToRef = function(e, t) { return t.r = this.r * e, t.g = this.g * e, t.b = this.b * e, t.a = this.a * e, this }, e.prototype.multiply = function(t) { return new e(this.r * t.r, this.g * t.g, this.b * t.b, this.a * t.a) }, e.prototype.multiplyToRef = function(e, t) { return t.r = this.r * e.r, t.g = this.g * e.g, t.b = this.b * e.b, t.a = this.a * e.a, t }, e.prototype.toString = function() { return "{R: " + this.r + " G:" + this.g + " B:" + this.b + " A:" + this.a + "}" }, e.prototype.getClassName = function() { return "Color4" }, e.prototype.getHashCode = function() { var e = this.r || 0; return e = 397 * e ^ (this.g || 0), e = 397 * e ^ (this.b || 0), e = 397 * e ^ (this.a || 0) }, e.prototype.clone = function() { return new e(this.r, this.g, this.b, this.a) }, e.prototype.copyFrom = function(e) { return this.r = e.r, this.g = e.g, this.b = e.b, this.a = e.a, this }, e.prototype.copyFromFloats = function(e, t, i, r) { return this.r = e, this.g = t, this.b = i, this.a = r, this }, e.prototype.set = function(e, t, i, r) { return this.copyFromFloats(e, t, i, r) }, e.prototype.toHexString = function() { var e = 255 * this.r | 0,
                i = 255 * this.g | 0,
                r = 255 * this.b | 0,
                n = 255 * this.a | 0; return "#" + t.ToHex(e) + t.ToHex(i) + t.ToHex(r) + t.ToHex(n) }, e.FromHexString = function(t) { if ("#" !== t.substring(0, 1) || 9 !== t.length) return new e(0, 0, 0, 0); var i = parseInt(t.substring(1, 3), 16),
                r = parseInt(t.substring(3, 5), 16),
                n = parseInt(t.substring(5, 7), 16),
                o = parseInt(t.substring(7, 9), 16); return e.FromInts(i, r, n, o) }, e.Lerp = function(t, i, r) { var n = new e(0, 0, 0, 0); return e.LerpToRef(t, i, r, n), n }, e.LerpToRef = function(e, t, i, r) { r.r = e.r + (t.r - e.r) * i, r.g = e.g + (t.g - e.g) * i, r.b = e.b + (t.b - e.b) * i, r.a = e.a + (t.a - e.a) * i }, e.FromArray = function(t, i) { return void 0 === i && (i = 0), new e(t[i], t[i + 1], t[i + 2], t[i + 3]) }, e.FromInts = function(t, i, r, n) { return new e(t / 255, i / 255, r / 255, n / 255) }, e.CheckColors4 = function(e, t) { if (e.length === 3 * t) { for (var i = [], r = 0; r < e.length; r += 3) { var n = r / 3 * 4;
                    i[n] = e[r], i[n + 1] = e[r + 1], i[n + 2] = e[r + 2], i[n + 3] = 1 } return i } return e }, e })();
    e.Color4 = r;
    var n = (function() {
        function i(e, t) { this.x = e, this.y = t } return i.prototype.toString = function() { return "{X: " + this.x + " Y:" + this.y + "}" }, i.prototype.getClassName = function() { return "Vector2" }, i.prototype.getHashCode = function() { var e = this.x || 0; return e = 397 * e ^ (this.y || 0) }, i.prototype.toArray = function(e, t) { return void 0 === t && (t = 0), e[t] = this.x, e[t + 1] = this.y, this }, i.prototype.asArray = function() { var e = []; return this.toArray(e, 0), e }, i.prototype.copyFrom = function(e) { return this.x = e.x, this.y = e.y, this }, i.prototype.copyFromFloats = function(e, t) { return this.x = e, this.y = t, this }, i.prototype.set = function(e, t) { return this.copyFromFloats(e, t) }, i.prototype.add = function(e) { return new i(this.x + e.x, this.y + e.y) }, i.prototype.addToRef = function(e, t) { return t.x = this.x + e.x, t.y = this.y + e.y, this }, i.prototype.addInPlace = function(e) { return this.x += e.x, this.y += e.y, this }, i.prototype.addVector3 = function(e) { return new i(this.x + e.x, this.y + e.y) }, i.prototype.subtract = function(e) { return new i(this.x - e.x, this.y - e.y) }, i.prototype.subtractToRef = function(e, t) { return t.x = this.x - e.x, t.y = this.y - e.y, this }, i.prototype.subtractInPlace = function(e) { return this.x -= e.x, this.y -= e.y, this }, i.prototype.multiplyInPlace = function(e) { return this.x *= e.x, this.y *= e.y, this }, i.prototype.multiply = function(e) { return new i(this.x * e.x, this.y * e.y) }, i.prototype.multiplyToRef = function(e, t) { return t.x = this.x * e.x, t.y = this.y * e.y, this }, i.prototype.multiplyByFloats = function(e, t) { return new i(this.x * e, this.y * t) }, i.prototype.divide = function(e) { return new i(this.x / e.x, this.y / e.y) }, i.prototype.divideToRef = function(e, t) { return t.x = this.x / e.x, t.y = this.y / e.y, this }, i.prototype.negate = function() { return new i(-this.x, -this.y) }, i.prototype.scaleInPlace = function(e) { return this.x *= e, this.y *= e, this }, i.prototype.scale = function(e) { return new i(this.x * e, this.y * e) }, i.prototype.equals = function(e) { return e && this.x === e.x && this.y === e.y }, i.prototype.equalsWithEpsilon = function(i, r) { return void 0 === r && (r = e.Epsilon), i && t.WithinEpsilon(this.x, i.x, r) && t.WithinEpsilon(this.y, i.y, r) }, i.prototype.length = function() { return Math.sqrt(this.x * this.x + this.y * this.y) }, i.prototype.lengthSquared = function() { return this.x * this.x + this.y * this.y }, i.prototype.normalize = function() { var e = this.length(); if (0 === e) return this; var t = 1 / e; return this.x *= t, this.y *= t, this }, i.prototype.clone = function() { return new i(this.x, this.y) }, i.Zero = function() { return new i(0, 0) }, i.FromArray = function(e, t) { return void 0 === t && (t = 0), new i(e[t], e[t + 1]) }, i.FromArrayToRef = function(e, t, i) { i.x = e[t], i.y = e[t + 1] }, i.CatmullRom = function(e, t, r, n, o) { var s = o * o,
                a = o * s; return new i(.5 * (2 * t.x + (-e.x + r.x) * o + (2 * e.x - 5 * t.x + 4 * r.x - n.x) * s + (-e.x + 3 * t.x - 3 * r.x + n.x) * a), .5 * (2 * t.y + (-e.y + r.y) * o + (2 * e.y - 5 * t.y + 4 * r.y - n.y) * s + (-e.y + 3 * t.y - 3 * r.y + n.y) * a)) }, i.Clamp = function(e, t, r) { var n = e.x;
            n = n > r.x ? r.x : n, n = n < t.x ? t.x : n; var o = e.y; return o = o > r.y ? r.y : o, o = o < t.y ? t.y : o, new i(n, o) }, i.Hermite = function(e, t, r, n, o) { var s = o * o,
                a = o * s,
                h = 2 * a - 3 * s + 1,
                l = -2 * a + 3 * s,
                c = a - 2 * s + o,
                u = a - s; return new i(e.x * h + r.x * l + t.x * c + n.x * u, e.y * h + r.y * l + t.y * c + n.y * u) }, i.Lerp = function(e, t, r) { return new i(e.x + (t.x - e.x) * r, e.y + (t.y - e.y) * r) }, i.Dot = function(e, t) { return e.x * t.x + e.y * t.y }, i.Normalize = function(e) { var t = e.clone(); return t.normalize(), t }, i.Minimize = function(e, t) { return new i(e.x < t.x ? e.x : t.x, e.y < t.y ? e.y : t.y) }, i.Maximize = function(e, t) { return new i(e.x > t.x ? e.x : t.x, e.y > t.y ? e.y : t.y) }, i.Transform = function(e, t) { var r = i.Zero(); return i.TransformToRef(e, t, r), r }, i.TransformToRef = function(e, t, i) { var r = e.x * t.m[0] + e.y * t.m[4] + t.m[12],
                n = e.x * t.m[1] + e.y * t.m[5] + t.m[13];
            i.x = r, i.y = n }, i.PointInTriangle = function(e, t, i, r) { var n = .5 * (-i.y * r.x + t.y * (-i.x + r.x) + t.x * (i.y - r.y) + i.x * r.y),
                o = n < 0 ? -1 : 1,
                s = (t.y * r.x - t.x * r.y + (r.y - t.y) * e.x + (t.x - r.x) * e.y) * o,
                a = (t.x * i.y - t.y * i.x + (t.y - i.y) * e.x + (i.x - t.x) * e.y) * o; return s > 0 && a > 0 && s + a < 2 * n * o }, i.Distance = function(e, t) { return Math.sqrt(i.DistanceSquared(e, t)) }, i.DistanceSquared = function(e, t) { var i = e.x - t.x,
                r = e.y - t.y; return i * i + r * r }, i.Center = function(e, t) { var i = e.add(t); return i.scaleInPlace(.5), i }, i.DistanceOfPointFromSegment = function(e, t, r) { var n = i.DistanceSquared(t, r); if (0 === n) return i.Distance(e, t); var o = r.subtract(t),
                s = Math.max(0, Math.min(1, i.Dot(e.subtract(t), o) / n)),
                a = t.add(o.multiplyByFloats(s, s)); return i.Distance(e, a) }, i })();
    e.Vector2 = n;
    var o = (function() {
        function i(e, t, i) { this.x = e, this.y = t, this.z = i } return i.prototype.toString = function() { return "{X: " + this.x + " Y:" + this.y + " Z:" + this.z + "}" }, i.prototype.getClassName = function() { return "Vector3" }, i.prototype.getHashCode = function() { var e = this.x || 0; return e = 397 * e ^ (this.y || 0), e = 397 * e ^ (this.z || 0) }, i.prototype.asArray = function() { var e = []; return this.toArray(e, 0), e }, i.prototype.toArray = function(e, t) { return void 0 === t && (t = 0), e[t] = this.x, e[t + 1] = this.y, e[t + 2] = this.z, this }, i.prototype.toQuaternion = function() { var e = new h(0, 0, 0, 1),
                t = Math.cos(.5 * (this.x + this.z)),
                i = Math.sin(.5 * (this.x + this.z)),
                r = Math.cos(.5 * (this.z - this.x)),
                n = Math.sin(.5 * (this.z - this.x)),
                o = Math.cos(.5 * this.y),
                s = Math.sin(.5 * this.y); return e.x = r * s, e.y = -n * s, e.z = i * o, e.w = t * o, e }, i.prototype.addInPlace = function(e) { return this.x += e.x, this.y += e.y, this.z += e.z, this }, i.prototype.add = function(e) { return new i(this.x + e.x, this.y + e.y, this.z + e.z) }, i.prototype.addToRef = function(e, t) { return t.x = this.x + e.x, t.y = this.y + e.y, t.z = this.z + e.z, this }, i.prototype.subtractInPlace = function(e) { return this.x -= e.x, this.y -= e.y, this.z -= e.z, this }, i.prototype.subtract = function(e) { return new i(this.x - e.x, this.y - e.y, this.z - e.z) }, i.prototype.subtractToRef = function(e, t) { return t.x = this.x - e.x, t.y = this.y - e.y, t.z = this.z - e.z, this }, i.prototype.subtractFromFloats = function(e, t, r) { return new i(this.x - e, this.y - t, this.z - r) }, i.prototype.subtractFromFloatsToRef = function(e, t, i, r) { return r.x = this.x - e, r.y = this.y - t, r.z = this.z - i, this }, i.prototype.negate = function() { return new i(-this.x, -this.y, -this.z) }, i.prototype.scaleInPlace = function(e) { return this.x *= e, this.y *= e, this.z *= e, this }, i.prototype.scale = function(e) { return new i(this.x * e, this.y * e, this.z * e) }, i.prototype.scaleToRef = function(e, t) { return t.x = this.x * e, t.y = this.y * e, t.z = this.z * e, this }, i.prototype.equals = function(e) { return e && this.x === e.x && this.y === e.y && this.z === e.z }, i.prototype.equalsWithEpsilon = function(i, r) { return void 0 === r && (r = e.Epsilon), i && t.WithinEpsilon(this.x, i.x, r) && t.WithinEpsilon(this.y, i.y, r) && t.WithinEpsilon(this.z, i.z, r) }, i.prototype.equalsToFloats = function(e, t, i) { return this.x === e && this.y === t && this.z === i }, i.prototype.multiplyInPlace = function(e) { return this.x *= e.x, this.y *= e.y, this.z *= e.z, this }, i.prototype.multiply = function(e) { return new i(this.x * e.x, this.y * e.y, this.z * e.z) }, i.prototype.multiplyToRef = function(e, t) { return t.x = this.x * e.x, t.y = this.y * e.y, t.z = this.z * e.z, this }, i.prototype.multiplyByFloats = function(e, t, r) { return new i(this.x * e, this.y * t, this.z * r) }, i.prototype.divide = function(e) { return new i(this.x / e.x, this.y / e.y, this.z / e.z) }, i.prototype.divideToRef = function(e, t) { return t.x = this.x / e.x, t.y = this.y / e.y, t.z = this.z / e.z, this }, i.prototype.MinimizeInPlace = function(e) { return e.x < this.x && (this.x = e.x), e.y < this.y && (this.y = e.y), e.z < this.z && (this.z = e.z), this }, i.prototype.MaximizeInPlace = function(e) { return e.x > this.x && (this.x = e.x), e.y > this.y && (this.y = e.y), e.z > this.z && (this.z = e.z), this }, i.prototype.length = function() { return Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z) }, i.prototype.lengthSquared = function() { return this.x * this.x + this.y * this.y + this.z * this.z }, i.prototype.normalize = function() { var e = this.length(); if (0 === e || 1 === e) return this; var t = 1 / e; return this.x *= t, this.y *= t, this.z *= t, this }, i.prototype.clone = function() { return new i(this.x, this.y, this.z) }, i.prototype.copyFrom = function(e) { return this.x = e.x, this.y = e.y, this.z = e.z, this }, i.prototype.copyFromFloats = function(e, t, i) { return this.x = e, this.y = t, this.z = i, this }, i.prototype.set = function(e, t, i) { return this.copyFromFloats(e, t, i) }, i.GetClipFactor = function(e, t, r, n) { var o = i.Dot(e, r) - n; return o / (o - (i.Dot(t, r) - n)) }, i.FromArray = function(e, t) { return t || (t = 0), new i(e[t], e[t + 1], e[t + 2]) }, i.FromFloatArray = function(e, t) { return t || (t = 0), new i(e[t], e[t + 1], e[t + 2]) }, i.FromArrayToRef = function(e, t, i) { i.x = e[t], i.y = e[t + 1], i.z = e[t + 2] }, i.FromFloatArrayToRef = function(e, t, i) { i.x = e[t], i.y = e[t + 1], i.z = e[t + 2] }, i.FromFloatsToRef = function(e, t, i, r) { r.x = e, r.y = t, r.z = i }, i.Zero = function() { return new i(0, 0, 0) }, i.Up = function() { return new i(0, 1, 0) }, i.Forward = function() { return new i(0, 0, 1) }, i.Right = function() { return new i(1, 0, 0) }, i.Left = function() { return new i(-1, 0, 0) }, i.TransformCoordinates = function(e, t) { var r = i.Zero(); return i.TransformCoordinatesToRef(e, t, r), r }, i.TransformCoordinatesToRef = function(e, t, i) { var r = e.x * t.m[0] + e.y * t.m[4] + e.z * t.m[8] + t.m[12],
                n = e.x * t.m[1] + e.y * t.m[5] + e.z * t.m[9] + t.m[13],
                o = e.x * t.m[2] + e.y * t.m[6] + e.z * t.m[10] + t.m[14],
                s = e.x * t.m[3] + e.y * t.m[7] + e.z * t.m[11] + t.m[15];
            i.x = r / s, i.y = n / s, i.z = o / s }, i.TransformCoordinatesFromFloatsToRef = function(e, t, i, r, n) { var o = e * r.m[0] + t * r.m[4] + i * r.m[8] + r.m[12],
                s = e * r.m[1] + t * r.m[5] + i * r.m[9] + r.m[13],
                a = e * r.m[2] + t * r.m[6] + i * r.m[10] + r.m[14],
                h = e * r.m[3] + t * r.m[7] + i * r.m[11] + r.m[15];
            n.x = o / h, n.y = s / h, n.z = a / h }, i.TransformNormal = function(e, t) { var r = i.Zero(); return i.TransformNormalToRef(e, t, r), r }, i.TransformNormalToRef = function(e, t, i) { var r = e.x * t.m[0] + e.y * t.m[4] + e.z * t.m[8],
                n = e.x * t.m[1] + e.y * t.m[5] + e.z * t.m[9],
                o = e.x * t.m[2] + e.y * t.m[6] + e.z * t.m[10];
            i.x = r, i.y = n, i.z = o }, i.TransformNormalFromFloatsToRef = function(e, t, i, r, n) { n.x = e * r.m[0] + t * r.m[4] + i * r.m[8], n.y = e * r.m[1] + t * r.m[5] + i * r.m[9], n.z = e * r.m[2] + t * r.m[6] + i * r.m[10] }, i.CatmullRom = function(e, t, r, n, o) { var s = o * o,
                a = o * s; return new i(.5 * (2 * t.x + (-e.x + r.x) * o + (2 * e.x - 5 * t.x + 4 * r.x - n.x) * s + (-e.x + 3 * t.x - 3 * r.x + n.x) * a), .5 * (2 * t.y + (-e.y + r.y) * o + (2 * e.y - 5 * t.y + 4 * r.y - n.y) * s + (-e.y + 3 * t.y - 3 * r.y + n.y) * a), .5 * (2 * t.z + (-e.z + r.z) * o + (2 * e.z - 5 * t.z + 4 * r.z - n.z) * s + (-e.z + 3 * t.z - 3 * r.z + n.z) * a)) }, i.Clamp = function(e, t, r) { var n = e.x;
            n = n > r.x ? r.x : n, n = n < t.x ? t.x : n; var o = e.y;
            o = o > r.y ? r.y : o, o = o < t.y ? t.y : o; var s = e.z; return s = s > r.z ? r.z : s, s = s < t.z ? t.z : s, new i(n, o, s) }, i.Hermite = function(e, t, r, n, o) { var s = o * o,
                a = o * s,
                h = 2 * a - 3 * s + 1,
                l = -2 * a + 3 * s,
                c = a - 2 * s + o,
                u = a - s; return new i(e.x * h + r.x * l + t.x * c + n.x * u, e.y * h + r.y * l + t.y * c + n.y * u, e.z * h + r.z * l + t.z * c + n.z * u) }, i.Lerp = function(e, t, r) { var n = new i(0, 0, 0); return i.LerpToRef(e, t, r, n), n }, i.LerpToRef = function(e, t, i, r) { r.x = e.x + (t.x - e.x) * i, r.y = e.y + (t.y - e.y) * i, r.z = e.z + (t.z - e.z) * i }, i.Dot = function(e, t) { return e.x * t.x + e.y * t.y + e.z * t.z }, i.Cross = function(e, t) { var r = i.Zero(); return i.CrossToRef(e, t, r), r }, i.CrossToRef = function(e, t, i) { M.Vector3[0].x = e.y * t.z - e.z * t.y, M.Vector3[0].y = e.z * t.x - e.x * t.z, M.Vector3[0].z = e.x * t.y - e.y * t.x, i.copyFrom(M.Vector3[0]) }, i.Normalize = function(e) { var t = i.Zero(); return i.NormalizeToRef(e, t), t }, i.NormalizeToRef = function(e, t) { t.copyFrom(e), t.normalize() }, i.Project = function(e, t, r, n) { var o = n.width,
                s = n.height,
                a = n.x,
                h = n.y,
                c = i._viewportMatrixCache ? i._viewportMatrixCache : i._viewportMatrixCache = new l;
            l.FromValuesToRef(o / 2, 0, 0, 0, 0, -s / 2, 0, 0, 0, 0, .5, 0, a + o / 2, s / 2 + h, .5, 1, c); var u = i._matrixCache ? i._matrixCache : i._matrixCache = new l; return t.multiplyToRef(r, u), u.multiplyToRef(c, u), i.TransformCoordinates(e, u) }, i.UnprojectFromTransform = function(e, r, n, o, s) { var a = i._matrixCache ? i._matrixCache : i._matrixCache = new l;
            o.multiplyToRef(s, a), a.invert(), e.x = e.x / r * 2 - 1, e.y = -(e.y / n * 2 - 1); var h = i.TransformCoordinates(e, a),
                c = e.x * a.m[3] + e.y * a.m[7] + e.z * a.m[11] + a.m[15]; return t.WithinEpsilon(c, 1) && (h = h.scale(1 / c)), h }, i.Unproject = function(e, r, n, o, s, a) { var h = i._matrixCache ? i._matrixCache : i._matrixCache = new l;
            o.multiplyToRef(s, h), h.multiplyToRef(a, h), h.invert(); var c = new i(e.x / r * 2 - 1, -(e.y / n * 2 - 1), 2 * e.z - 1),
                u = i.TransformCoordinates(c, h),
                d = c.x * h.m[3] + c.y * h.m[7] + c.z * h.m[11] + h.m[15]; return t.WithinEpsilon(d, 1) && (u = u.scale(1 / d)), u }, i.Minimize = function(e, t) { var i = e.clone(); return i.MinimizeInPlace(t), i }, i.Maximize = function(e, t) { var i = e.clone(); return i.MaximizeInPlace(t), i }, i.Distance = function(e, t) { return Math.sqrt(i.DistanceSquared(e, t)) }, i.DistanceSquared = function(e, t) { var i = e.x - t.x,
                r = e.y - t.y,
                n = e.z - t.z; return i * i + r * r + n * n }, i.Center = function(e, t) { var i = e.add(t); return i.scaleInPlace(.5), i }, i.RotationFromAxis = function(e, t, r) { var n = i.Zero(); return i.RotationFromAxisToRef(e, t, r, n), n }, i.RotationFromAxisToRef = function(e, t, i, r) { var n = M.Quaternion[0];
            h.RotationQuaternionFromAxisToRef(e, t, i, n), n.toEulerAnglesToRef(r) }, i })();
    e.Vector3 = o;
    var s = (function() {
        function i(e, t, i, r) { this.x = e, this.y = t, this.z = i, this.w = r } return i.prototype.toString = function() { return "{X: " + this.x + " Y:" + this.y + " Z:" + this.z + " W:" + this.w + "}" }, i.prototype.getClassName = function() { return "Vector4" }, i.prototype.getHashCode = function() { var e = this.x || 0; return e = 397 * e ^ (this.y || 0), e = 397 * e ^ (this.z || 0), e = 397 * e ^ (this.w || 0) }, i.prototype.asArray = function() { var e = []; return this.toArray(e, 0), e }, i.prototype.toArray = function(e, t) { return void 0 === t && (t = 0), e[t] = this.x, e[t + 1] = this.y, e[t + 2] = this.z, e[t + 3] = this.w, this }, i.prototype.addInPlace = function(e) { return this.x += e.x, this.y += e.y, this.z += e.z, this.w += e.w, this }, i.prototype.add = function(e) { return new i(this.x + e.x, this.y + e.y, this.z + e.z, this.w + e.w) }, i.prototype.addToRef = function(e, t) { return t.x = this.x + e.x, t.y = this.y + e.y, t.z = this.z + e.z, t.w = this.w + e.w, this }, i.prototype.subtractInPlace = function(e) { return this.x -= e.x, this.y -= e.y, this.z -= e.z, this.w -= e.w, this }, i.prototype.subtract = function(e) { return new i(this.x - e.x, this.y - e.y, this.z - e.z, this.w - e.w) }, i.prototype.subtractToRef = function(e, t) { return t.x = this.x - e.x, t.y = this.y - e.y, t.z = this.z - e.z, t.w = this.w - e.w, this }, i.prototype.subtractFromFloats = function(e, t, r, n) { return new i(this.x - e, this.y - t, this.z - r, this.w - n) }, i.prototype.subtractFromFloatsToRef = function(e, t, i, r, n) { return n.x = this.x - e, n.y = this.y - t, n.z = this.z - i, n.w = this.w - r, this }, i.prototype.negate = function() { return new i(-this.x, -this.y, -this.z, -this.w) }, i.prototype.scaleInPlace = function(e) { return this.x *= e, this.y *= e, this.z *= e, this.w *= e, this }, i.prototype.scale = function(e) { return new i(this.x * e, this.y * e, this.z * e, this.w * e) }, i.prototype.scaleToRef = function(e, t) { return t.x = this.x * e, t.y = this.y * e, t.z = this.z * e, t.w = this.w * e, this }, i.prototype.equals = function(e) { return e && this.x === e.x && this.y === e.y && this.z === e.z && this.w === e.w }, i.prototype.equalsWithEpsilon = function(i, r) { return void 0 === r && (r = e.Epsilon), i && t.WithinEpsilon(this.x, i.x, r) && t.WithinEpsilon(this.y, i.y, r) && t.WithinEpsilon(this.z, i.z, r) && t.WithinEpsilon(this.w, i.w, r) }, i.prototype.equalsToFloats = function(e, t, i, r) { return this.x === e && this.y === t && this.z === i && this.w === r }, i.prototype.multiplyInPlace = function(e) { return this.x *= e.x, this.y *= e.y, this.z *= e.z, this.w *= e.w, this }, i.prototype.multiply = function(e) { return new i(this.x * e.x, this.y * e.y, this.z * e.z, this.w * e.w) }, i.prototype.multiplyToRef = function(e, t) { return t.x = this.x * e.x, t.y = this.y * e.y, t.z = this.z * e.z, t.w = this.w * e.w, this }, i.prototype.multiplyByFloats = function(e, t, r, n) { return new i(this.x * e, this.y * t, this.z * r, this.w * n) }, i.prototype.divide = function(e) { return new i(this.x / e.x, this.y / e.y, this.z / e.z, this.w / e.w) }, i.prototype.divideToRef = function(e, t) { return t.x = this.x / e.x, t.y = this.y / e.y, t.z = this.z / e.z, t.w = this.w / e.w, this }, i.prototype.MinimizeInPlace = function(e) { return e.x < this.x && (this.x = e.x), e.y < this.y && (this.y = e.y), e.z < this.z && (this.z = e.z), e.w < this.w && (this.w = e.w), this }, i.prototype.MaximizeInPlace = function(e) { return e.x > this.x && (this.x = e.x), e.y > this.y && (this.y = e.y), e.z > this.z && (this.z = e.z), e.w > this.w && (this.w = e.w), this }, i.prototype.length = function() { return Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w) }, i.prototype.lengthSquared = function() { return this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w }, i.prototype.normalize = function() { var e = this.length(); if (0 === e) return this; var t = 1 / e; return this.x *= t, this.y *= t, this.z *= t, this.w *= t, this }, i.prototype.toVector3 = function() { return new o(this.x, this.y, this.z) }, i.prototype.clone = function() { return new i(this.x, this.y, this.z, this.w) }, i.prototype.copyFrom = function(e) { return this.x = e.x, this.y = e.y, this.z = e.z, this.w = e.w, this }, i.prototype.copyFromFloats = function(e, t, i, r) { return this.x = e, this.y = t, this.z = i, this.w = r, this }, i.prototype.set = function(e, t, i, r) { return this.copyFromFloats(e, t, i, r) }, i.FromArray = function(e, t) { return t || (t = 0), new i(e[t], e[t + 1], e[t + 2], e[t + 3]) }, i.FromArrayToRef = function(e, t, i) { i.x = e[t], i.y = e[t + 1], i.z = e[t + 2], i.w = e[t + 3] }, i.FromFloatArrayToRef = function(e, t, i) { i.x = e[t], i.y = e[t + 1], i.z = e[t + 2], i.w = e[t + 3] }, i.FromFloatsToRef = function(e, t, i, r, n) { n.x = e, n.y = t, n.z = i, n.w = r }, i.Zero = function() { return new i(0, 0, 0, 0) }, i.Normalize = function(e) { var t = i.Zero(); return i.NormalizeToRef(e, t), t }, i.NormalizeToRef = function(e, t) { t.copyFrom(e), t.normalize() }, i.Minimize = function(e, t) { var i = e.clone(); return i.MinimizeInPlace(t), i }, i.Maximize = function(e, t) { var i = e.clone(); return i.MaximizeInPlace(t), i }, i.Distance = function(e, t) { return Math.sqrt(i.DistanceSquared(e, t)) }, i.DistanceSquared = function(e, t) { var i = e.x - t.x,
                r = e.y - t.y,
                n = e.z - t.z,
                o = e.w - t.w; return i * i + r * r + n * n + o * o }, i.Center = function(e, t) { var i = e.add(t); return i.scaleInPlace(.5), i }, i.TransformNormal = function(e, t) { var r = i.Zero(); return i.TransformNormalToRef(e, t, r), r }, i.TransformNormalToRef = function(e, t, i) { var r = e.x * t.m[0] + e.y * t.m[4] + e.z * t.m[8],
                n = e.x * t.m[1] + e.y * t.m[5] + e.z * t.m[9],
                o = e.x * t.m[2] + e.y * t.m[6] + e.z * t.m[10];
            i.x = r, i.y = n, i.z = o, i.w = e.w }, i.TransformNormalFromFloatsToRef = function(e, t, i, r, n, o) { o.x = e * n.m[0] + t * n.m[4] + i * n.m[8], o.y = e * n.m[1] + t * n.m[5] + i * n.m[9], o.z = e * n.m[2] + t * n.m[6] + i * n.m[10], o.w = r }, i })();
    e.Vector4 = s;
    var a = (function() {
        function e(e, t) { this.width = e, this.height = t } return e.prototype.toString = function() { return "{W: " + this.width + ", H: " + this.height + "}" }, e.prototype.getClassName = function() { return "Size" }, e.prototype.getHashCode = function() { var e = this.width || 0; return e = 397 * e ^ (this.height || 0) }, e.prototype.copyFrom = function(e) { this.width = e.width, this.height = e.height }, e.prototype.copyFromFloats = function(e, t) { return this.width = e, this.height = t, this }, e.prototype.set = function(e, t) { return this.copyFromFloats(e, t) }, e.prototype.multiplyByFloats = function(t, i) { return new e(this.width * t, this.height * i) }, e.prototype.clone = function() { return new e(this.width, this.height) }, e.prototype.equals = function(e) { return !!e && (this.width === e.width && this.height === e.height) }, Object.defineProperty(e.prototype, "surface", { get: function() { return this.width * this.height }, enumerable: !0, configurable: !0 }), e.Zero = function() { return new e(0, 0) }, e.prototype.add = function(t) { return new e(this.width + t.width, this.height + t.height) }, e.prototype.subtract = function(t) { return new e(this.width - t.width, this.height - t.height) }, e.Lerp = function(t, i, r) { return new e(t.width + (i.width - t.width) * r, t.height + (i.height - t.height) * r) }, e })();
    e.Size = a;
    var h = (function() {
        function t(e, t, i, r) { void 0 === e && (e = 0), void 0 === t && (t = 0), void 0 === i && (i = 0), void 0 === r && (r = 1), this.x = e, this.y = t, this.z = i, this.w = r } return t.prototype.toString = function() { return "{X: " + this.x + " Y:" + this.y + " Z:" + this.z + " W:" + this.w + "}" }, t.prototype.getClassName = function() { return "Quaternion" }, t.prototype.getHashCode = function() { var e = this.x || 0; return e = 397 * e ^ (this.y || 0), e = 397 * e ^ (this.z || 0), e = 397 * e ^ (this.w || 0) }, t.prototype.asArray = function() { return [this.x, this.y, this.z, this.w] }, t.prototype.equals = function(e) { return e && this.x === e.x && this.y === e.y && this.z === e.z && this.w === e.w }, t.prototype.clone = function() { return new t(this.x, this.y, this.z, this.w) }, t.prototype.copyFrom = function(e) { return this.x = e.x, this.y = e.y, this.z = e.z, this.w = e.w, this }, t.prototype.copyFromFloats = function(e, t, i, r) { return this.x = e, this.y = t, this.z = i, this.w = r, this }, t.prototype.set = function(e, t, i, r) { return this.copyFromFloats(e, t, i, r) }, t.prototype.add = function(e) { return new t(this.x + e.x, this.y + e.y, this.z + e.z, this.w + e.w) }, t.prototype.subtract = function(e) { return new t(this.x - e.x, this.y - e.y, this.z - e.z, this.w - e.w) }, t.prototype.scale = function(e) { return new t(this.x * e, this.y * e, this.z * e, this.w * e) }, t.prototype.multiply = function(e) { var i = new t(0, 0, 0, 1); return this.multiplyToRef(e, i), i }, t.prototype.multiplyToRef = function(e, t) { var i = this.x * e.w + this.y * e.z - this.z * e.y + this.w * e.x,
                r = -this.x * e.z + this.y * e.w + this.z * e.x + this.w * e.y,
                n = this.x * e.y - this.y * e.x + this.z * e.w + this.w * e.z,
                o = -this.x * e.x - this.y * e.y - this.z * e.z + this.w * e.w; return t.copyFromFloats(i, r, n, o), this }, t.prototype.multiplyInPlace = function(e) { return this.multiplyToRef(e, this), this }, t.prototype.conjugateToRef = function(e) { return e.copyFromFloats(-this.x, -this.y, -this.z, this.w), this }, t.prototype.conjugateInPlace = function() { return this.x *= -1, this.y *= -1, this.z *= -1, this }, t.prototype.conjugate = function() { return new t(-this.x, -this.y, -this.z, this.w) }, t.prototype.length = function() { return Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w) }, t.prototype.normalize = function() { var e = 1 / this.length(); return this.x *= e, this.y *= e, this.z *= e, this.w *= e, this }, t.prototype.toEulerAngles = function(e) { void 0 === e && (e = "YZX"); var t = o.Zero(); return this.toEulerAnglesToRef(t, e), t }, t.prototype.toEulerAnglesToRef = function(e, t) { void 0 === t && (t = "YZX"); var i = this.z,
                r = this.x,
                n = this.y,
                o = this.w,
                s = o * o,
                a = i * i,
                h = r * r,
                l = n * n,
                c = n * i - r * o; return c < -.4999999 ? (e.y = 2 * Math.atan2(n, o), e.x = Math.PI / 2, e.z = 0) : c > .4999999 ? (e.y = 2 * Math.atan2(n, o), e.x = -Math.PI / 2, e.z = 0) : (e.z = Math.atan2(2 * (r * n + i * o), -a - h + l + s), e.x = Math.asin(-2 * (i * n - r * o)), e.y = Math.atan2(2 * (i * r + n * o), a - h - l + s)), this }, t.prototype.toRotationMatrix = function(e) { var t = this.x * this.x,
                i = this.y * this.y,
                r = this.z * this.z,
                n = this.x * this.y,
                o = this.z * this.w,
                s = this.z * this.x,
                a = this.y * this.w,
                h = this.y * this.z,
                l = this.x * this.w; return e.m[0] = 1 - 2 * (i + r), e.m[1] = 2 * (n + o), e.m[2] = 2 * (s - a), e.m[3] = 0, e.m[4] = 2 * (n - o), e.m[5] = 1 - 2 * (r + t), e.m[6] = 2 * (h + l), e.m[7] = 0, e.m[8] = 2 * (s + a), e.m[9] = 2 * (h - l), e.m[10] = 1 - 2 * (i + t), e.m[11] = 0, e.m[12] = 0, e.m[13] = 0, e.m[14] = 0, e.m[15] = 1, e._markAsUpdated(), this }, t.prototype.fromRotationMatrix = function(e) { return t.FromRotationMatrixToRef(e, this), this }, t.FromRotationMatrix = function(e) { var i = new t; return t.FromRotationMatrixToRef(e, i), i }, t.FromRotationMatrixToRef = function(e, t) { var i, r = e.m,
                n = r[0],
                o = r[4],
                s = r[8],
                a = r[1],
                h = r[5],
                l = r[9],
                c = r[2],
                u = r[6],
                d = r[10],
                f = n + h + d;
            f > 0 ? (i = .5 / Math.sqrt(f + 1), t.w = .25 / i, t.x = (u - l) * i, t.y = (s - c) * i, t.z = (a - o) * i) : n > h && n > d ? (i = 2 * Math.sqrt(1 + n - h - d), t.w = (u - l) / i, t.x = .25 * i, t.y = (o + a) / i, t.z = (s + c) / i) : h > d ? (i = 2 * Math.sqrt(1 + h - n - d), t.w = (s - c) / i, t.x = (o + a) / i, t.y = .25 * i, t.z = (l + u) / i) : (i = 2 * Math.sqrt(1 + d - n - h), t.w = (a - o) / i, t.x = (s + c) / i, t.y = (l + u) / i, t.z = .25 * i) }, t.Zero = function() { return new t(0, 0, 0, 0) }, t.Inverse = function(e) { return new t(-e.x, -e.y, -e.z, e.w) }, t.Identity = function() { return new t(0, 0, 0, 1) }, t.IsIdentity = function(e) { return e && 0 === e.x && 0 === e.y && 0 === e.z && 1 === e.w }, t.RotationAxis = function(e, i) { return t.RotationAxisToRef(e, i, new t) }, t.RotationAxisToRef = function(e, t, i) { var r = Math.sin(t / 2); return e.normalize(), i.w = Math.cos(t / 2), i.x = e.x * r, i.y = e.y * r, i.z = e.z * r, i }, t.FromArray = function(e, i) { return i || (i = 0), new t(e[i], e[i + 1], e[i + 2], e[i + 3]) }, t.RotationYawPitchRoll = function(e, i, r) { var n = new t; return t.RotationYawPitchRollToRef(e, i, r, n), n }, t.RotationYawPitchRollToRef = function(e, t, i, r) { var n = .5 * i,
                o = .5 * t,
                s = .5 * e,
                a = Math.sin(n),
                h = Math.cos(n),
                l = Math.sin(o),
                c = Math.cos(o),
                u = Math.sin(s),
                d = Math.cos(s);
            r.x = d * l * h + u * c * a, r.y = u * c * h - d * l * a, r.z = d * c * a - u * l * h, r.w = d * c * h + u * l * a }, t.RotationAlphaBetaGamma = function(e, i, r) { var n = new t; return t.RotationAlphaBetaGammaToRef(e, i, r, n), n }, t.RotationAlphaBetaGammaToRef = function(e, t, i, r) { var n = .5 * (i + e),
                o = .5 * (i - e),
                s = .5 * t;
            r.x = Math.cos(o) * Math.sin(s), r.y = Math.sin(o) * Math.sin(s), r.z = Math.sin(n) * Math.cos(s), r.w = Math.cos(n) * Math.cos(s) }, t.RotationQuaternionFromAxis = function(e, i, r, n) { var o = new t(0, 0, 0, 0); return t.RotationQuaternionFromAxisToRef(e, i, r, o), o }, t.RotationQuaternionFromAxisToRef = function(t, i, r, n) { var o = M.Matrix[0];
            e.Matrix.FromXYZAxesToRef(t.normalize(), i.normalize(), r.normalize(), o), e.Quaternion.FromRotationMatrixToRef(o, n) }, t.Slerp = function(e, i, r) { var n = t.Identity(); return t.SlerpToRef(e, i, r, n), n }, t.SlerpToRef = function(e, t, i, r) { var n, o, s = i,
                a = e.x * t.x + e.y * t.y + e.z * t.z + e.w * t.w,
                h = !1; if (a < 0 && (h = !0, a = -a), a > .999999) o = 1 - s, n = h ? -s : s;
            else { var l = Math.acos(a),
                    c = 1 / Math.sin(l);
                o = Math.sin((1 - s) * l) * c, n = h ? -Math.sin(s * l) * c : Math.sin(s * l) * c }
            r.x = o * e.x + n * t.x, r.y = o * e.y + n * t.y, r.z = o * e.z + n * t.z, r.w = o * e.w + n * t.w }, t })();
    e.Quaternion = h;
    var l = (function() {
        function i() { this.m = new Float32Array(16), this._markAsUpdated() }
        return i.prototype._markAsUpdated = function() { this.updateFlag = i._updateFlagSeed++ }, i.prototype.isIdentity = function() { return 1 === this.m[0] && 1 === this.m[5] && 1 === this.m[10] && 1 === this.m[15] && (0 === this.m[1] && 0 === this.m[2] && 0 === this.m[3] && 0 === this.m[4] && 0 === this.m[6] && 0 === this.m[7] && 0 === this.m[8] && 0 === this.m[9] && 0 === this.m[11] && 0 === this.m[12] && 0 === this.m[13] && 0 === this.m[14]) }, i.prototype.determinant = function() { var e = this.m[10] * this.m[15] - this.m[11] * this.m[14],
                    t = this.m[9] * this.m[15] - this.m[11] * this.m[13],
                    i = this.m[9] * this.m[14] - this.m[10] * this.m[13],
                    r = this.m[8] * this.m[15] - this.m[11] * this.m[12],
                    n = this.m[8] * this.m[14] - this.m[10] * this.m[12],
                    o = this.m[8] * this.m[13] - this.m[9] * this.m[12]; return this.m[0] * (this.m[5] * e - this.m[6] * t + this.m[7] * i) - this.m[1] * (this.m[4] * e - this.m[6] * r + this.m[7] * n) + this.m[2] * (this.m[4] * t - this.m[5] * r + this.m[7] * o) - this.m[3] * (this.m[4] * i - this.m[5] * n + this.m[6] * o) }, i.prototype.toArray = function() { return this.m }, i.prototype.asArray = function() { return this.toArray() }, i.prototype.invert = function() { return this.invertToRef(this), this }, i.prototype.reset = function() { for (var e = 0; e < 16; e++) this.m[e] = 0; return this._markAsUpdated(), this }, i.prototype.add = function(e) { var t = new i; return this.addToRef(e, t), t },
            i.prototype.addToRef = function(e, t) { for (var i = 0; i < 16; i++) t.m[i] = this.m[i] + e.m[i]; return t._markAsUpdated(), this }, i.prototype.addToSelf = function(e) { for (var t = 0; t < 16; t++) this.m[t] += e.m[t]; return this._markAsUpdated(), this }, i.prototype.invertToRef = function(e) { var t = this.m[0],
                    i = this.m[1],
                    r = this.m[2],
                    n = this.m[3],
                    o = this.m[4],
                    s = this.m[5],
                    a = this.m[6],
                    h = this.m[7],
                    l = this.m[8],
                    c = this.m[9],
                    u = this.m[10],
                    d = this.m[11],
                    f = this.m[12],
                    p = this.m[13],
                    _ = this.m[14],
                    m = this.m[15],
                    g = u * m - d * _,
                    v = c * m - d * p,
                    y = c * _ - u * p,
                    x = l * m - d * f,
                    b = l * _ - u * f,
                    A = l * p - c * f,
                    E = s * g - a * v + h * y,
                    T = -(o * g - a * x + h * b),
                    P = o * v - s * x + h * A,
                    M = -(o * y - s * b + a * A),
                    S = 1 / (t * E + i * T + r * P + n * M),
                    C = a * m - h * _,
                    R = s * m - h * p,
                    O = s * _ - a * p,
                    D = o * m - h * f,
                    I = o * _ - a * f,
                    L = o * p - s * f,
                    w = a * d - h * u,
                    B = s * d - h * c,
                    F = s * u - a * c,
                    N = o * d - h * l,
                    V = o * u - a * l,
                    U = o * c - s * l; return e.m[0] = E * S, e.m[4] = T * S, e.m[8] = P * S, e.m[12] = M * S, e.m[1] = -(i * g - r * v + n * y) * S, e.m[5] = (t * g - r * x + n * b) * S, e.m[9] = -(t * v - i * x + n * A) * S, e.m[13] = (t * y - i * b + r * A) * S, e.m[2] = (i * C - r * R + n * O) * S, e.m[6] = -(t * C - r * D + n * I) * S, e.m[10] = (t * R - i * D + n * L) * S, e.m[14] = -(t * O - i * I + r * L) * S, e.m[3] = -(i * w - r * B + n * F) * S, e.m[7] = (t * w - r * N + n * V) * S, e.m[11] = -(t * B - i * N + n * U) * S, e.m[15] = (t * F - i * V + r * U) * S, e._markAsUpdated(), this }, i.prototype.setTranslationFromFloats = function(e, t, i) { return this.m[12] = e, this.m[13] = t, this.m[14] = i, this._markAsUpdated(), this }, i.prototype.setTranslation = function(e) { return this.m[12] = e.x, this.m[13] = e.y, this.m[14] = e.z, this._markAsUpdated(), this }, i.prototype.getTranslation = function() { return new o(this.m[12], this.m[13], this.m[14]) }, i.prototype.getTranslationToRef = function(e) { return e.x = this.m[12], e.y = this.m[13], e.z = this.m[14], this }, i.prototype.removeRotationAndScaling = function() { return this.setRowFromFloats(0, 1, 0, 0, 0), this.setRowFromFloats(1, 0, 1, 0, 0), this.setRowFromFloats(2, 0, 0, 1, 0), this }, i.prototype.multiply = function(e) { var t = new i; return this.multiplyToRef(e, t), t }, i.prototype.copyFrom = function(e) { for (var t = 0; t < 16; t++) this.m[t] = e.m[t]; return this._markAsUpdated(), this }, i.prototype.copyToArray = function(e, t) { void 0 === t && (t = 0); for (var i = 0; i < 16; i++) e[t + i] = this.m[i]; return this }, i.prototype.multiplyToRef = function(e, t) { return this.multiplyToArray(e, t.m, 0), t._markAsUpdated(), this }, i.prototype.multiplyToArray = function(e, t, i) { var r = this.m[0],
                    n = this.m[1],
                    o = this.m[2],
                    s = this.m[3],
                    a = this.m[4],
                    h = this.m[5],
                    l = this.m[6],
                    c = this.m[7],
                    u = this.m[8],
                    d = this.m[9],
                    f = this.m[10],
                    p = this.m[11],
                    _ = this.m[12],
                    m = this.m[13],
                    g = this.m[14],
                    v = this.m[15],
                    y = e.m[0],
                    x = e.m[1],
                    b = e.m[2],
                    A = e.m[3],
                    E = e.m[4],
                    T = e.m[5],
                    P = e.m[6],
                    M = e.m[7],
                    S = e.m[8],
                    C = e.m[9],
                    R = e.m[10],
                    O = e.m[11],
                    D = e.m[12],
                    I = e.m[13],
                    L = e.m[14],
                    w = e.m[15]; return t[i] = r * y + n * E + o * S + s * D, t[i + 1] = r * x + n * T + o * C + s * I, t[i + 2] = r * b + n * P + o * R + s * L, t[i + 3] = r * A + n * M + o * O + s * w, t[i + 4] = a * y + h * E + l * S + c * D, t[i + 5] = a * x + h * T + l * C + c * I, t[i + 6] = a * b + h * P + l * R + c * L, t[i + 7] = a * A + h * M + l * O + c * w, t[i + 8] = u * y + d * E + f * S + p * D, t[i + 9] = u * x + d * T + f * C + p * I, t[i + 10] = u * b + d * P + f * R + p * L, t[i + 11] = u * A + d * M + f * O + p * w, t[i + 12] = _ * y + m * E + g * S + v * D, t[i + 13] = _ * x + m * T + g * C + v * I, t[i + 14] = _ * b + m * P + g * R + v * L, t[i + 15] = _ * A + m * M + g * O + v * w, this }, i.prototype.equals = function(e) { return e && this.m[0] === e.m[0] && this.m[1] === e.m[1] && this.m[2] === e.m[2] && this.m[3] === e.m[3] && this.m[4] === e.m[4] && this.m[5] === e.m[5] && this.m[6] === e.m[6] && this.m[7] === e.m[7] && this.m[8] === e.m[8] && this.m[9] === e.m[9] && this.m[10] === e.m[10] && this.m[11] === e.m[11] && this.m[12] === e.m[12] && this.m[13] === e.m[13] && this.m[14] === e.m[14] && this.m[15] === e.m[15] }, i.prototype.clone = function() { return i.FromValues(this.m[0], this.m[1], this.m[2], this.m[3], this.m[4], this.m[5], this.m[6], this.m[7], this.m[8], this.m[9], this.m[10], this.m[11], this.m[12], this.m[13], this.m[14], this.m[15]) }, i.prototype.getClassName = function() { return "Matrix" }, i.prototype.getHashCode = function() { for (var e = this.m[0] || 0, t = 1; t < 16; t++) e = 397 * e ^ (this.m[t] || 0); return e }, i.prototype.decompose = function(e, r, n) { n.x = this.m[12], n.y = this.m[13], n.z = this.m[14]; var o = t.Sign(this.m[0] * this.m[1] * this.m[2] * this.m[3]) < 0 ? -1 : 1,
                    s = t.Sign(this.m[4] * this.m[5] * this.m[6] * this.m[7]) < 0 ? -1 : 1,
                    a = t.Sign(this.m[8] * this.m[9] * this.m[10] * this.m[11]) < 0 ? -1 : 1; return e.x = o * Math.sqrt(this.m[0] * this.m[0] + this.m[1] * this.m[1] + this.m[2] * this.m[2]), e.y = s * Math.sqrt(this.m[4] * this.m[4] + this.m[5] * this.m[5] + this.m[6] * this.m[6]), e.z = a * Math.sqrt(this.m[8] * this.m[8] + this.m[9] * this.m[9] + this.m[10] * this.m[10]), 0 === e.x || 0 === e.y || 0 === e.z ? (r.x = 0, r.y = 0, r.z = 0, r.w = 1, !1) : (i.FromValuesToRef(this.m[0] / e.x, this.m[1] / e.x, this.m[2] / e.x, 0, this.m[4] / e.y, this.m[5] / e.y, this.m[6] / e.y, 0, this.m[8] / e.z, this.m[9] / e.z, this.m[10] / e.z, 0, 0, 0, 0, 1, M.Matrix[0]), h.FromRotationMatrixToRef(M.Matrix[0], r), !0) }, i.prototype.getRotationMatrix = function() { var e = i.Identity(); return this.getRotationMatrixToRef(e), e }, i.prototype.getRotationMatrixToRef = function(e) { var t = this.m,
                    r = t[0] * t[1] * t[2] * t[3] < 0 ? -1 : 1,
                    n = t[4] * t[5] * t[6] * t[7] < 0 ? -1 : 1,
                    o = t[8] * t[9] * t[10] * t[11] < 0 ? -1 : 1,
                    s = r * Math.sqrt(t[0] * t[0] + t[1] * t[1] + t[2] * t[2]),
                    a = n * Math.sqrt(t[4] * t[4] + t[5] * t[5] + t[6] * t[6]),
                    h = o * Math.sqrt(t[8] * t[8] + t[9] * t[9] + t[10] * t[10]); return i.FromValuesToRef(t[0] / s, t[1] / s, t[2] / s, 0, t[4] / a, t[5] / a, t[6] / a, 0, t[8] / h, t[9] / h, t[10] / h, 0, 0, 0, 0, 1, e), this }, i.FromArray = function(e, t) { var r = new i; return t || (t = 0), i.FromArrayToRef(e, t, r), r }, i.FromArrayToRef = function(e, t, i) { for (var r = 0; r < 16; r++) i.m[r] = e[r + t];
                i._markAsUpdated() }, i.FromFloat32ArrayToRefScaled = function(e, t, i, r) { for (var n = 0; n < 16; n++) r.m[n] = e[n + t] * i;
                r._markAsUpdated() }, i.FromValuesToRef = function(e, t, i, r, n, o, s, a, h, l, c, u, d, f, p, _, m) { m.m[0] = e, m.m[1] = t, m.m[2] = i, m.m[3] = r, m.m[4] = n, m.m[5] = o, m.m[6] = s, m.m[7] = a, m.m[8] = h, m.m[9] = l, m.m[10] = c, m.m[11] = u, m.m[12] = d, m.m[13] = f, m.m[14] = p, m.m[15] = _, m._markAsUpdated() }, i.prototype.getRow = function(e) { if (e < 0 || e > 3) return null; var t = 4 * e; return new s(this.m[t + 0], this.m[t + 1], this.m[t + 2], this.m[t + 3]) }, i.prototype.setRow = function(e, t) { if (e < 0 || e > 3) return this; var i = 4 * e; return this.m[i + 0] = t.x, this.m[i + 1] = t.y, this.m[i + 2] = t.z, this.m[i + 3] = t.w, this._markAsUpdated(), this }, i.prototype.setRowFromFloats = function(e, t, i, r, n) { if (e < 0 || e > 3) return this; var o = 4 * e; return this.m[o + 0] = t, this.m[o + 1] = i, this.m[o + 2] = r, this.m[o + 3] = n, this._markAsUpdated(), this }, i.FromValues = function(e, t, r, n, o, s, a, h, l, c, u, d, f, p, _, m) { var g = new i; return g.m[0] = e, g.m[1] = t, g.m[2] = r, g.m[3] = n, g.m[4] = o, g.m[5] = s, g.m[6] = a, g.m[7] = h, g.m[8] = l, g.m[9] = c, g.m[10] = u, g.m[11] = d, g.m[12] = f, g.m[13] = p, g.m[14] = _, g.m[15] = m, g }, i.Compose = function(e, t, r) { var n = i.Identity(); return i.ComposeToRef(e, t, r, n), n }, i.ComposeToRef = function(e, t, r, n) { i.FromValuesToRef(e.x, 0, 0, 0, 0, e.y, 0, 0, 0, 0, e.z, 0, 0, 0, 0, 1, M.Matrix[1]), t.toRotationMatrix(M.Matrix[0]), M.Matrix[1].multiplyToRef(M.Matrix[0], n), n.setTranslation(r) }, i.Identity = function() { return i.FromValues(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1) }, i.IdentityToRef = function(e) { i.FromValuesToRef(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, e) }, i.Zero = function() { return i.FromValues(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0) }, i.RotationX = function(e) { var t = new i; return i.RotationXToRef(e, t), t }, i.Invert = function(e) { var t = new i; return e.invertToRef(t), t }, i.RotationXToRef = function(e, t) { var i = Math.sin(e),
                    r = Math.cos(e);
                t.m[0] = 1, t.m[15] = 1, t.m[5] = r, t.m[10] = r, t.m[9] = -i, t.m[6] = i, t.m[1] = 0, t.m[2] = 0, t.m[3] = 0, t.m[4] = 0, t.m[7] = 0, t.m[8] = 0, t.m[11] = 0, t.m[12] = 0, t.m[13] = 0, t.m[14] = 0, t._markAsUpdated() }, i.RotationY = function(e) { var t = new i; return i.RotationYToRef(e, t), t }, i.RotationYToRef = function(e, t) { var i = Math.sin(e),
                    r = Math.cos(e);
                t.m[5] = 1, t.m[15] = 1, t.m[0] = r, t.m[2] = -i, t.m[8] = i, t.m[10] = r, t.m[1] = 0, t.m[3] = 0, t.m[4] = 0, t.m[6] = 0, t.m[7] = 0, t.m[9] = 0, t.m[11] = 0, t.m[12] = 0, t.m[13] = 0, t.m[14] = 0, t._markAsUpdated() }, i.RotationZ = function(e) { var t = new i; return i.RotationZToRef(e, t), t }, i.RotationZToRef = function(e, t) { var i = Math.sin(e),
                    r = Math.cos(e);
                t.m[10] = 1, t.m[15] = 1, t.m[0] = r, t.m[1] = i, t.m[4] = -i, t.m[5] = r, t.m[2] = 0, t.m[3] = 0, t.m[6] = 0, t.m[7] = 0, t.m[8] = 0, t.m[9] = 0, t.m[11] = 0, t.m[12] = 0, t.m[13] = 0, t.m[14] = 0, t._markAsUpdated() }, i.RotationAxis = function(e, t) { var r = i.Zero(); return i.RotationAxisToRef(e, t, r), r }, i.RotationAxisToRef = function(e, t, i) { var r = Math.sin(-t),
                    n = Math.cos(-t),
                    o = 1 - n;
                e.normalize(), i.m[0] = e.x * e.x * o + n, i.m[1] = e.x * e.y * o - e.z * r, i.m[2] = e.x * e.z * o + e.y * r, i.m[3] = 0, i.m[4] = e.y * e.x * o + e.z * r, i.m[5] = e.y * e.y * o + n, i.m[6] = e.y * e.z * o - e.x * r, i.m[7] = 0, i.m[8] = e.z * e.x * o - e.y * r, i.m[9] = e.z * e.y * o + e.x * r, i.m[10] = e.z * e.z * o + n, i.m[11] = 0, i.m[15] = 1, i._markAsUpdated() }, i.RotationYawPitchRoll = function(e, t, r) { var n = new i; return i.RotationYawPitchRollToRef(e, t, r, n), n }, i.RotationYawPitchRollToRef = function(e, t, i, r) { h.RotationYawPitchRollToRef(e, t, i, this._tempQuaternion), this._tempQuaternion.toRotationMatrix(r) }, i.Scaling = function(e, t, r) { var n = i.Zero(); return i.ScalingToRef(e, t, r, n), n }, i.ScalingToRef = function(e, t, i, r) { r.m[0] = e, r.m[1] = 0, r.m[2] = 0, r.m[3] = 0, r.m[4] = 0, r.m[5] = t, r.m[6] = 0, r.m[7] = 0, r.m[8] = 0, r.m[9] = 0, r.m[10] = i, r.m[11] = 0, r.m[12] = 0, r.m[13] = 0, r.m[14] = 0, r.m[15] = 1, r._markAsUpdated() }, i.Translation = function(e, t, r) { var n = i.Identity(); return i.TranslationToRef(e, t, r, n), n }, i.TranslationToRef = function(e, t, r, n) { i.FromValuesToRef(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, e, t, r, 1, n) }, i.Lerp = function(e, t, r) { for (var n = i.Zero(), o = 0; o < 16; o++) n.m[o] = e.m[o] * (1 - r) + t.m[o] * r; return n._markAsUpdated(), n }, i.DecomposeLerp = function(e, t, r) { var n = new o(0, 0, 0),
                    s = new h,
                    a = new o(0, 0, 0);
                e.decompose(n, s, a); var l = new o(0, 0, 0),
                    c = new h,
                    u = new o(0, 0, 0);
                t.decompose(l, c, u); var d = o.Lerp(n, l, r),
                    f = h.Slerp(s, c, r),
                    p = o.Lerp(a, u, r); return i.Compose(d, f, p) }, i.LookAtLH = function(e, t, r) { var n = i.Zero(); return i.LookAtLHToRef(e, t, r, n), n }, i.LookAtLHToRef = function(e, t, r, n) { t.subtractToRef(e, this._zAxis), this._zAxis.normalize(), o.CrossToRef(r, this._zAxis, this._xAxis), 0 === this._xAxis.lengthSquared() ? this._xAxis.x = 1 : this._xAxis.normalize(), o.CrossToRef(this._zAxis, this._xAxis, this._yAxis), this._yAxis.normalize(); var s = -o.Dot(this._xAxis, e),
                    a = -o.Dot(this._yAxis, e),
                    h = -o.Dot(this._zAxis, e); return i.FromValuesToRef(this._xAxis.x, this._yAxis.x, this._zAxis.x, 0, this._xAxis.y, this._yAxis.y, this._zAxis.y, 0, this._xAxis.z, this._yAxis.z, this._zAxis.z, 0, s, a, h, 1, n) }, i.LookAtRH = function(e, t, r) { var n = i.Zero(); return i.LookAtRHToRef(e, t, r, n), n }, i.LookAtRHToRef = function(e, t, r, n) { e.subtractToRef(t, this._zAxis), this._zAxis.normalize(), o.CrossToRef(r, this._zAxis, this._xAxis), 0 === this._xAxis.lengthSquared() ? this._xAxis.x = 1 : this._xAxis.normalize(), o.CrossToRef(this._zAxis, this._xAxis, this._yAxis), this._yAxis.normalize(); var s = -o.Dot(this._xAxis, e),
                    a = -o.Dot(this._yAxis, e),
                    h = -o.Dot(this._zAxis, e); return i.FromValuesToRef(this._xAxis.x, this._yAxis.x, this._zAxis.x, 0, this._xAxis.y, this._yAxis.y, this._zAxis.y, 0, this._xAxis.z, this._yAxis.z, this._zAxis.z, 0, s, a, h, 1, n) }, i.OrthoLH = function(e, t, r, n) { var o = i.Zero(); return i.OrthoLHToRef(e, t, r, n, o), o }, i.OrthoLHToRef = function(t, i, r, n, o) { var s = r,
                    a = n,
                    h = 2 / t,
                    l = 2 / i,
                    c = 2 / (a - s),
                    u = -(a + s) / (a - s);
                e.Matrix.FromValuesToRef(h, 0, 0, 0, 0, l, 0, 0, 0, 0, c, 0, 0, 0, u, 1, o) }, i.OrthoOffCenterLH = function(e, t, r, n, o, s) { var a = i.Zero(); return i.OrthoOffCenterLHToRef(e, t, r, n, o, s, a), a }, i.OrthoOffCenterLHToRef = function(t, i, r, n, o, s, a) { var h = o,
                    l = s,
                    c = 2 / (i - t),
                    u = 2 / (n - r),
                    d = 2 / (l - h),
                    f = -(l + h) / (l - h),
                    p = (t + i) / (t - i),
                    _ = (n + r) / (r - n);
                e.Matrix.FromValuesToRef(c, 0, 0, 0, 0, u, 0, 0, 0, 0, d, 0, p, _, f, 1, a) }, i.OrthoOffCenterRH = function(e, t, r, n, o, s) { var a = i.Zero(); return i.OrthoOffCenterRHToRef(e, t, r, n, o, s, a), a }, i.OrthoOffCenterRHToRef = function(e, t, r, n, o, s, a) { i.OrthoOffCenterLHToRef(e, t, r, n, o, s, a), a.m[10] *= -1 }, i.PerspectiveLH = function(t, r, n, o) { var s = i.Zero(),
                    a = n,
                    h = o,
                    l = 2 * a / t,
                    c = 2 * a / r,
                    u = (h + a) / (h - a),
                    d = -2 * h * a / (h - a); return e.Matrix.FromValuesToRef(l, 0, 0, 0, 0, c, 0, 0, 0, 0, u, 1, 0, 0, d, 0, s), s }, i.PerspectiveFovLH = function(e, t, r, n) { var o = i.Zero(); return i.PerspectiveFovLHToRef(e, t, r, n, o), o }, i.PerspectiveFovLHToRef = function(t, i, r, n, o, s) { void 0 === s && (s = !0); var a = r,
                    h = n,
                    l = 1 / Math.tan(.5 * t),
                    c = s ? l / i : l,
                    u = s ? l : l * i,
                    d = (h + a) / (h - a),
                    f = -2 * h * a / (h - a);
                e.Matrix.FromValuesToRef(c, 0, 0, 0, 0, u, 0, 0, 0, 0, d, 1, 0, 0, f, 0, o) }, i.PerspectiveFovRH = function(e, t, r, n) { var o = i.Zero(); return i.PerspectiveFovRHToRef(e, t, r, n, o), o }, i.PerspectiveFovRHToRef = function(t, i, r, n, o, s) { void 0 === s && (s = !0); var a = r,
                    h = n,
                    l = 1 / Math.tan(.5 * t),
                    c = s ? l / i : l,
                    u = s ? l : l * i,
                    d = -(h + a) / (h - a),
                    f = -2 * h * a / (h - a);
                e.Matrix.FromValuesToRef(c, 0, 0, 0, 0, u, 0, 0, 0, 0, d, -1, 0, 0, f, 0, o) }, i.PerspectiveFovWebVRToRef = function(e, t, i, r, n) { void 0 === n && (n = !1); var o = n ? -1 : 1,
                    s = Math.tan(e.upDegrees * Math.PI / 180),
                    a = Math.tan(e.downDegrees * Math.PI / 180),
                    h = Math.tan(e.leftDegrees * Math.PI / 180),
                    l = Math.tan(e.rightDegrees * Math.PI / 180),
                    c = 2 / (h + l),
                    u = 2 / (s + a);
                r.m[0] = c, r.m[1] = r.m[2] = r.m[3] = r.m[4] = 0, r.m[5] = u, r.m[6] = r.m[7] = 0, r.m[8] = (h - l) * c * .5, r.m[9] = -((s - a) * u * .5), r.m[10] = -i / (t - i), r.m[11] = 1 * o, r.m[12] = r.m[13] = r.m[15] = 0, r.m[14] = -(2 * i * t) / (i - t), r._markAsUpdated() }, i.GetFinalMatrix = function(e, t, r, n, o, s) { var a = e.width,
                    h = e.height,
                    l = e.x,
                    c = e.y,
                    u = i.FromValues(a / 2, 0, 0, 0, 0, -h / 2, 0, 0, 0, 0, s - o, 0, l + a / 2, h / 2 + c, o, 1); return t.multiply(r).multiply(n).multiply(u) }, i.GetAsMatrix2x2 = function(e) { return new Float32Array([e.m[0], e.m[1], e.m[4], e.m[5]]) }, i.GetAsMatrix3x3 = function(e) { return new Float32Array([e.m[0], e.m[1], e.m[2], e.m[4], e.m[5], e.m[6], e.m[8], e.m[9], e.m[10]]) }, i.Transpose = function(e) { var t = new i; return t.m[0] = e.m[0], t.m[1] = e.m[4], t.m[2] = e.m[8], t.m[3] = e.m[12], t.m[4] = e.m[1], t.m[5] = e.m[5], t.m[6] = e.m[9], t.m[7] = e.m[13], t.m[8] = e.m[2], t.m[9] = e.m[6], t.m[10] = e.m[10], t.m[11] = e.m[14], t.m[12] = e.m[3], t.m[13] = e.m[7], t.m[14] = e.m[11], t.m[15] = e.m[15], t }, i.Reflection = function(e) { var t = new i; return i.ReflectionToRef(e, t), t }, i.ReflectionToRef = function(e, t) { e.normalize(); var i = e.normal.x,
                    r = e.normal.y,
                    n = e.normal.z,
                    o = -2 * i,
                    s = -2 * r,
                    a = -2 * n;
                t.m[0] = o * i + 1, t.m[1] = s * i, t.m[2] = a * i, t.m[3] = 0, t.m[4] = o * r, t.m[5] = s * r + 1, t.m[6] = a * r, t.m[7] = 0, t.m[8] = o * n, t.m[9] = s * n, t.m[10] = a * n + 1, t.m[11] = 0, t.m[12] = o * e.d, t.m[13] = s * e.d, t.m[14] = a * e.d, t.m[15] = 1, t._markAsUpdated() }, i.FromXYZAxesToRef = function(e, t, i, r) { r.m[0] = e.x, r.m[1] = e.y, r.m[2] = e.z, r.m[3] = 0, r.m[4] = t.x, r.m[5] = t.y, r.m[6] = t.z, r.m[7] = 0, r.m[8] = i.x, r.m[9] = i.y, r.m[10] = i.z, r.m[11] = 0, r.m[12] = 0, r.m[13] = 0, r.m[14] = 0, r.m[15] = 1, r._markAsUpdated() }, i.FromQuaternionToRef = function(e, t) { var i = e.x * e.x,
                    r = e.y * e.y,
                    n = e.z * e.z,
                    o = e.x * e.y,
                    s = e.z * e.w,
                    a = e.z * e.x,
                    h = e.y * e.w,
                    l = e.y * e.z,
                    c = e.x * e.w;
                t.m[0] = 1 - 2 * (r + n), t.m[1] = 2 * (o + s), t.m[2] = 2 * (a - h), t.m[3] = 0, t.m[4] = 2 * (o - s), t.m[5] = 1 - 2 * (n + i), t.m[6] = 2 * (l + c), t.m[7] = 0, t.m[8] = 2 * (a + h), t.m[9] = 2 * (l - c), t.m[10] = 1 - 2 * (r + i), t.m[11] = 0, t.m[12] = 0, t.m[13] = 0, t.m[14] = 0, t.m[15] = 1, t._markAsUpdated() }, i
    })();
    l._tempQuaternion = new h, l._xAxis = o.Zero(), l._yAxis = o.Zero(), l._zAxis = o.Zero(), l._updateFlagSeed = 0, e.Matrix = l;
    var c = (function() {
        function e(e, t, i, r) { this.normal = new o(e, t, i), this.d = r } return e.prototype.asArray = function() { return [this.normal.x, this.normal.y, this.normal.z, this.d] }, e.prototype.clone = function() { return new e(this.normal.x, this.normal.y, this.normal.z, this.d) }, e.prototype.getClassName = function() { return "Plane" }, e.prototype.getHashCode = function() { var e = this.normal.getHashCode(); return e = 397 * e ^ (this.d || 0) }, e.prototype.normalize = function() { var e = Math.sqrt(this.normal.x * this.normal.x + this.normal.y * this.normal.y + this.normal.z * this.normal.z),
                t = 0; return 0 !== e && (t = 1 / e), this.normal.x *= t, this.normal.y *= t, this.normal.z *= t, this.d *= t, this }, e.prototype.transform = function(t) { var i = l.Transpose(t),
                r = this.normal.x,
                n = this.normal.y,
                o = this.normal.z,
                s = this.d; return new e(r * i.m[0] + n * i.m[1] + o * i.m[2] + s * i.m[3], r * i.m[4] + n * i.m[5] + o * i.m[6] + s * i.m[7], r * i.m[8] + n * i.m[9] + o * i.m[10] + s * i.m[11], r * i.m[12] + n * i.m[13] + o * i.m[14] + s * i.m[15]) }, e.prototype.dotCoordinate = function(e) { return this.normal.x * e.x + this.normal.y * e.y + this.normal.z * e.z + this.d }, e.prototype.copyFromPoints = function(e, t, i) { var r, n = t.x - e.x,
                o = t.y - e.y,
                s = t.z - e.z,
                a = i.x - e.x,
                h = i.y - e.y,
                l = i.z - e.z,
                c = o * l - s * h,
                u = s * a - n * l,
                d = n * h - o * a,
                f = Math.sqrt(c * c + u * u + d * d); return r = 0 !== f ? 1 / f : 0, this.normal.x = c * r, this.normal.y = u * r, this.normal.z = d * r, this.d = -(this.normal.x * e.x + this.normal.y * e.y + this.normal.z * e.z), this }, e.prototype.isFrontFacingTo = function(e, t) { return o.Dot(this.normal, e) <= t }, e.prototype.signedDistanceTo = function(e) { return o.Dot(e, this.normal) + this.d }, e.FromArray = function(t) { return new e(t[0], t[1], t[2], t[3]) }, e.FromPoints = function(t, i, r) { var n = new e(0, 0, 0, 0); return n.copyFromPoints(t, i, r), n }, e.FromPositionAndNormal = function(t, i) { var r = new e(0, 0, 0, 0); return i.normalize(), r.normal = i, r.d = -(i.x * t.x + i.y * t.y + i.z * t.z), r }, e.SignedDistanceToPlaneFromPositionAndNormal = function(e, t, i) { var r = -(t.x * e.x + t.y * e.y + t.z * e.z); return o.Dot(i, t) + r }, e })();
    e.Plane = c;
    var u = (function() {
        function e(e, t, i, r) { this.x = e, this.y = t, this.width = i, this.height = r } return e.prototype.toGlobal = function(t, i) { return new e(this.x * t, this.y * i, this.width * t, this.height * i) }, e.prototype.clone = function() { return new e(this.x, this.y, this.width, this.height) }, e })();
    e.Viewport = u;
    var d = (function() {
        function e() {} return e.GetPlanes = function(t) { for (var i = [], r = 0; r < 6; r++) i.push(new c(0, 0, 0, 0)); return e.GetPlanesToRef(t, i), i }, e.GetPlanesToRef = function(e, t) { t[0].normal.x = e.m[3] + e.m[2], t[0].normal.y = e.m[7] + e.m[6], t[0].normal.z = e.m[11] + e.m[10], t[0].d = e.m[15] + e.m[14], t[0].normalize(), t[1].normal.x = e.m[3] - e.m[2], t[1].normal.y = e.m[7] - e.m[6], t[1].normal.z = e.m[11] - e.m[10], t[1].d = e.m[15] - e.m[14], t[1].normalize(), t[2].normal.x = e.m[3] + e.m[0], t[2].normal.y = e.m[7] + e.m[4], t[2].normal.z = e.m[11] + e.m[8], t[2].d = e.m[15] + e.m[12], t[2].normalize(), t[3].normal.x = e.m[3] - e.m[0], t[3].normal.y = e.m[7] - e.m[4], t[3].normal.z = e.m[11] - e.m[8], t[3].d = e.m[15] - e.m[12], t[3].normalize(), t[4].normal.x = e.m[3] - e.m[1], t[4].normal.y = e.m[7] - e.m[5], t[4].normal.z = e.m[11] - e.m[9], t[4].d = e.m[15] - e.m[13], t[4].normalize(), t[5].normal.x = e.m[3] + e.m[1], t[5].normal.y = e.m[7] + e.m[5], t[5].normal.z = e.m[11] + e.m[9], t[5].d = e.m[15] + e.m[13], t[5].normalize() }, e })();
    e.Frustum = d;
    !(function(e) { e[e.LOCAL = 0] = "LOCAL", e[e.WORLD = 1] = "WORLD", e[e.BONE = 2] = "BONE" })(e.Space || (e.Space = {}));
    var f = (function() {
        function e() {} return e })();
    f.X = new o(1, 0, 0), f.Y = new o(0, 1, 0), f.Z = new o(0, 0, 1), e.Axis = f;
    var p = (function() {
        function e() {} return e.interpolate = function(e, t, i, r, n) { for (var o = 1 - 3 * r + 3 * t, s = 3 * r - 6 * t, a = 3 * t, h = e, l = 0; l < 5; l++) { var c = h * h;
                h -= (o * (c * h) + s * c + a * h - e) * (1 / (3 * o * c + 2 * s * h + a)), h = Math.min(1, Math.max(0, h)) } return 3 * Math.pow(1 - h, 2) * h * i + 3 * (1 - h) * Math.pow(h, 2) * n + Math.pow(h, 3) }, e })();
    e.BezierCurve = p;
    var _;
    !(function(e) { e[e.CW = 0] = "CW", e[e.CCW = 1] = "CCW" })(_ = e.Orientation || (e.Orientation = {}));
    var m = (function() {
        function e(e) { var t = this;
            this.degrees = function() { return 180 * t._radians / Math.PI }, this.radians = function() { return t._radians }, this._radians = e, this._radians < 0 && (this._radians += 2 * Math.PI) } return e.BetweenTwoPoints = function(t, i) { var r = i.subtract(t); return new e(Math.atan2(r.y, r.x)) }, e.FromRadians = function(t) { return new e(t) }, e.FromDegrees = function(t) { return new e(t * Math.PI / 180) }, e })();
    e.Angle = m;
    var g = (function() {
        function e(e, t, i) { this.startPoint = e, this.midPoint = t, this.endPoint = i; var r = Math.pow(t.x, 2) + Math.pow(t.y, 2),
                o = (Math.pow(e.x, 2) + Math.pow(e.y, 2) - r) / 2,
                s = (r - Math.pow(i.x, 2) - Math.pow(i.y, 2)) / 2,
                a = (e.x - t.x) * (t.y - i.y) - (t.x - i.x) * (e.y - t.y);
            this.centerPoint = new n((o * (t.y - i.y) - s * (e.y - t.y)) / a, ((e.x - t.x) * s - (t.x - i.x) * o) / a), this.radius = this.centerPoint.subtract(this.startPoint).length(), this.startAngle = m.BetweenTwoPoints(this.centerPoint, this.startPoint); var h = this.startAngle.degrees(),
                l = m.BetweenTwoPoints(this.centerPoint, this.midPoint).degrees(),
                c = m.BetweenTwoPoints(this.centerPoint, this.endPoint).degrees();
            l - h > 180 && (l -= 360), l - h < -180 && (l += 360), c - l > 180 && (c -= 360), c - l < -180 && (c += 360), this.orientation = l - h < 0 ? _.CW : _.CCW, this.angle = m.FromDegrees(this.orientation === _.CW ? h - c : c - h) } return e })();
    e.Arc2 = g;
    var v = (function() {
        function e(e, t) { this._points = new Array, this._length = 0, this.closed = !1, this._points.push(new n(e, t)) } return e.prototype.addLineTo = function(e, t) { if (closed) return this; var i = new n(e, t),
                r = this._points[this._points.length - 1]; return this._points.push(i), this._length += i.subtract(r).length(), this }, e.prototype.addArcTo = function(e, t, i, r, o) { if (void 0 === o && (o = 36), closed) return this; var s = this._points[this._points.length - 1],
                a = new n(e, t),
                h = new n(i, r),
                l = new g(s, a, h),
                c = l.angle.radians() / o;
            l.orientation === _.CW && (c *= -1); for (var u = l.startAngle.radians() + c, d = 0; d < o; d++) { var f = Math.cos(u) * l.radius + l.centerPoint.x,
                    p = Math.sin(u) * l.radius + l.centerPoint.y;
                this.addLineTo(f, p), u += c } return this }, e.prototype.close = function() { return this.closed = !0, this }, e.prototype.length = function() { var e = this._length; if (!this.closed) { var t = this._points[this._points.length - 1];
                e += this._points[0].subtract(t).length() } return e }, e.prototype.getPoints = function() { return this._points }, e.prototype.getPointAtLengthPosition = function(e) { if (e < 0 || e > 1) return n.Zero(); for (var t = e * this.length(), i = 0, r = 0; r < this._points.length; r++) { var o = (r + 1) % this._points.length,
                    s = this._points[r],
                    a = this._points[o],
                    h = a.subtract(s),
                    l = h.length() + i; if (t >= i && t <= l) { var c = h.normalize(),
                        u = t - i; return new n(s.x + c.x * u, s.y + c.y * u) }
                i = l } return n.Zero() }, e.StartingAt = function(t, i) { return new e(t, i) }, e })();
    e.Path2 = v;
    var y = (function() {
        function i(e, t, i) { this.path = e, this._curve = new Array, this._distances = new Array, this._tangents = new Array, this._normals = new Array, this._binormals = new Array; for (var r = 0; r < e.length; r++) this._curve[r] = e[r].clone();
            this._raw = i || !1, this._compute(t) } return i.prototype.getCurve = function() { return this._curve }, i.prototype.getTangents = function() { return this._tangents }, i.prototype.getNormals = function() { return this._normals }, i.prototype.getBinormals = function() { return this._binormals }, i.prototype.getDistances = function() { return this._distances }, i.prototype.update = function(e, t) { for (var i = 0; i < e.length; i++) this._curve[i].x = e[i].x, this._curve[i].y = e[i].y, this._curve[i].z = e[i].z; return this._compute(t), this }, i.prototype._compute = function(e) { var t = this._curve.length;
            this._tangents[0] = this._getFirstNonNullVector(0), this._raw || this._tangents[0].normalize(), this._tangents[t - 1] = this._curve[t - 1].subtract(this._curve[t - 2]), this._raw || this._tangents[t - 1].normalize(); var i = this._tangents[0],
                r = this._normalVector(this._curve[0], i, e);
            this._normals[0] = r, this._raw || this._normals[0].normalize(), this._binormals[0] = o.Cross(i, this._normals[0]), this._raw || this._binormals[0].normalize(), this._distances[0] = 0; for (var n, s, a, h, l = 1; l < t; l++) n = this._getLastNonNullVector(l), l < t - 1 && (s = this._getFirstNonNullVector(l), this._tangents[l] = n.add(s), this._tangents[l].normalize()), this._distances[l] = this._distances[l - 1] + n.length(), a = this._tangents[l], h = this._binormals[l - 1], this._normals[l] = o.Cross(h, a), this._raw || this._normals[l].normalize(), this._binormals[l] = o.Cross(a, this._normals[l]), this._raw || this._binormals[l].normalize() }, i.prototype._getFirstNonNullVector = function(e) { for (var t = 1, i = this._curve[e + t].subtract(this._curve[e]); 0 === i.length() && e + t + 1 < this._curve.length;) t++, i = this._curve[e + t].subtract(this._curve[e]); return i }, i.prototype._getLastNonNullVector = function(e) { for (var t = 1, i = this._curve[e].subtract(this._curve[e - t]); 0 === i.length() && e > t + 1;) t++, i = this._curve[e].subtract(this._curve[e - t]); return i }, i.prototype._normalVector = function(i, r, n) { var s, a = r.length(); if (0 === a && (a = 1), void 0 === n || null === n) { var h;
                t.WithinEpsilon(Math.abs(r.y) / a, 1, e.Epsilon) ? t.WithinEpsilon(Math.abs(r.x) / a, 1, e.Epsilon) ? t.WithinEpsilon(Math.abs(r.z) / a, 1, e.Epsilon) || (h = new o(0, 0, 1)) : h = new o(1, 0, 0) : h = new o(0, -1, 0), s = o.Cross(r, h) } else s = o.Cross(r, n), o.CrossToRef(s, r, s); return s.normalize(), s }, i })();
    e.Path3D = y;
    var x = (function() {
        function e(e) { this._length = 0, this._points = e, this._length = this._computeLength(e) } return e.CreateQuadraticBezier = function(t, i, r, n) { n = n > 2 ? n : 3; for (var s = new Array, a = function(e, t, i, r) { return (1 - e) * (1 - e) * t + 2 * e * (1 - e) * i + e * e * r }, h = 0; h <= n; h++) s.push(new o(a(h / n, t.x, i.x, r.x), a(h / n, t.y, i.y, r.y), a(h / n, t.z, i.z, r.z))); return new e(s) }, e.CreateCubicBezier = function(t, i, r, n, s) { s = s > 3 ? s : 4; for (var a = new Array, h = function(e, t, i, r, n) { return (1 - e) * (1 - e) * (1 - e) * t + 3 * e * (1 - e) * (1 - e) * i + 3 * e * e * (1 - e) * r + e * e * e * n }, l = 0; l <= s; l++) a.push(new o(h(l / s, t.x, i.x, r.x, n.x), h(l / s, t.y, i.y, r.y, n.y), h(l / s, t.z, i.z, r.z, n.z))); return new e(a) }, e.CreateHermiteSpline = function(t, i, r, n, s) { for (var a = new Array, h = 1 / s, l = 0; l <= s; l++) a.push(o.Hermite(t, i, r, n, l * h)); return new e(a) }, e.CreateCatmullRomSpline = function(t, i) { var r = new Array;
            r.push(t[0].clone()), Array.prototype.push.apply(r, t), r.push(t[t.length - 1].clone()); for (var n = new Array, s = 1 / i, a = 0; a < r.length - 3; a++)
                for (var h = 0, l = 0; l < i; l++) n.push(o.CatmullRom(r[a], r[a + 1], r[a + 2], r[a + 3], h)), h += s; return a--, n.push(o.CatmullRom(r[a], r[a + 1], r[a + 2], r[a + 3], h)), new e(n) }, e.prototype.getPoints = function() { return this._points }, e.prototype.length = function() { return this._length }, e.prototype.continue = function(t) { for (var i = this._points[this._points.length - 1], r = this._points.slice(), n = t.getPoints(), o = 1; o < n.length; o++) r.push(n[o].subtract(n[0]).add(i)); return new e(r) }, e.prototype._computeLength = function(e) { for (var t = 0, i = 1; i < e.length; i++) t += e[i].subtract(e[i - 1]).length(); return t }, e })();
    e.Curve3 = x;
    var b = (function() {
        function e() { this.L00 = o.Zero(), this.L1_1 = o.Zero(), this.L10 = o.Zero(), this.L11 = o.Zero(), this.L2_2 = o.Zero(), this.L2_1 = o.Zero(), this.L20 = o.Zero(), this.L21 = o.Zero(), this.L22 = o.Zero() } return e.prototype.addLight = function(e, t, i) { var r = new o(t.r, t.g, t.b),
                n = r.scale(i);
            this.L00 = this.L00.add(n.scale(.282095)), this.L1_1 = this.L1_1.add(n.scale(.488603 * e.y)), this.L10 = this.L10.add(n.scale(.488603 * e.z)), this.L11 = this.L11.add(n.scale(.488603 * e.x)), this.L2_2 = this.L2_2.add(n.scale(1.092548 * e.x * e.y)), this.L2_1 = this.L2_1.add(n.scale(1.092548 * e.y * e.z)), this.L21 = this.L21.add(n.scale(1.092548 * e.x * e.z)), this.L20 = this.L20.add(n.scale(.315392 * (3 * e.z * e.z - 1))), this.L22 = this.L22.add(n.scale(.546274 * (e.x * e.x - e.y * e.y))) }, e.prototype.scale = function(e) { this.L00 = this.L00.scale(e), this.L1_1 = this.L1_1.scale(e), this.L10 = this.L10.scale(e), this.L11 = this.L11.scale(e), this.L2_2 = this.L2_2.scale(e), this.L2_1 = this.L2_1.scale(e), this.L20 = this.L20.scale(e), this.L21 = this.L21.scale(e), this.L22 = this.L22.scale(e) }, e })();
    e.SphericalHarmonics = b;
    var A = (function() {
        function e() { this.x = o.Zero(), this.y = o.Zero(), this.z = o.Zero(), this.xx = o.Zero(), this.yy = o.Zero(), this.zz = o.Zero(), this.xy = o.Zero(), this.yz = o.Zero(), this.zx = o.Zero() } return e.prototype.addAmbient = function(e) { var t = new o(e.r, e.g, e.b);
            this.xx = this.xx.add(t), this.yy = this.yy.add(t), this.zz = this.zz.add(t) }, e.getSphericalPolynomialFromHarmonics = function(t) { var i = new e; return i.x = t.L11.scale(1.02333), i.y = t.L1_1.scale(1.02333), i.z = t.L10.scale(1.02333), i.xx = t.L00.scale(.886277).subtract(t.L20.scale(.247708)).add(t.L22.scale(.429043)), i.yy = t.L00.scale(.886277).subtract(t.L20.scale(.247708)).subtract(t.L22.scale(.429043)), i.zz = t.L00.scale(.886277).add(t.L20.scale(.495417)), i.yz = t.L2_1.scale(.858086), i.zx = t.L21.scale(.858086), i.xy = t.L2_2.scale(.858086), i }, e })();
    e.SphericalPolynomial = A;
    var E = (function() {
        function e(e, t) { void 0 === e && (e = o.Zero()), void 0 === t && (t = o.Up()), this.position = e, this.normal = t } return e.prototype.clone = function() { return new e(this.position.clone(), this.normal.clone()) }, e })();
    e.PositionNormalVertex = E;
    var T = (function() {
        function e(e, t, i) { void 0 === e && (e = o.Zero()), void 0 === t && (t = o.Up()), void 0 === i && (i = n.Zero()), this.position = e, this.normal = t, this.uv = i } return e.prototype.clone = function() { return new e(this.position.clone(), this.normal.clone(), this.uv.clone()) }, e })();
    e.PositionNormalTextureVertex = T;
    var P = (function() {
        function e() {} return e })();
    P.Color3 = [i.Black(), i.Black(), i.Black()], P.Vector2 = [n.Zero(), n.Zero(), n.Zero()], P.Vector3 = [o.Zero(), o.Zero(), o.Zero(), o.Zero(), o.Zero(), o.Zero(), o.Zero(), o.Zero(), o.Zero()], P.Vector4 = [s.Zero(), s.Zero(), s.Zero()], P.Quaternion = [h.Zero(), h.Zero()], P.Matrix = [l.Zero(), l.Zero(), l.Zero(), l.Zero(), l.Zero(), l.Zero(), l.Zero(), l.Zero()], e.Tmp = P;
    var M = (function() {
        function e() {} return e })();
    M.Vector3 = [o.Zero()], M.Matrix = [l.Zero(), l.Zero()], M.Quaternion = [h.Zero()]
})(BABYLON || (BABYLON = {}));
var BABYLON;
!(function(e) {
    function t(e, t) { return function(i, r) { i.__serializableMembers || (i.__serializableMembers = {}), i.__serializableMembers[r] || (i.__serializableMembers[r] = { type: e, sourceName: t }) } }

    function i(e) { return function(t, i) { if (e) { var r = "_" + i;
                Object.defineProperty(t, i, { get: function() { return this[r] }, set: function(i) { this[r] !== i && (this[r] = i, t[e].apply(this)) }, enumerable: !0, configurable: !0 }) } } }

    function r(e) { return i(e) }

    function n(e) { return t(0, e) }

    function o(e) { return t(1, e) }

    function s(e) { return t(2, e) }

    function a(e) { return t(3, e) }

    function h(e) { return t(4, e) }

    function l(e) { return t(5, e) }

    function c(e) { return t(6, e) }

    function u(e) { return t(7, e) }
    e.expandToProperty = r, e.serialize = n, e.serializeAsTexture = o, e.serializeAsColor3 = s, e.serializeAsFresnelParameters = a, e.serializeAsVector2 = h, e.serializeAsVector3 = l, e.serializeAsMeshReference = c, e.serializeAsColorCurves = u; var d = (function() {
        function t() {} return t.Serialize = function(t, i) { i || (i = {}), i.tags = e.Tags.GetTags(t); for (var r in t.__serializableMembers) { var n = t.__serializableMembers[r],
                    o = n.sourceName || r,
                    s = n.type,
                    a = t[r]; if (void 0 !== a && null !== a) switch (s) {
                    case 0:
                        i[o] = a; break;
                    case 1:
                        i[o] = a.serialize(); break;
                    case 2:
                        i[o] = a.asArray(); break;
                    case 3:
                        i[o] = a.serialize(); break;
                    case 4:
                    case 5:
                        i[o] = a.asArray(); break;
                    case 6:
                        i[o] = a.id; break;
                    case 7:
                        i[o] = a.serialize() } } return i }, t.Parse = function(t, i, r, n) { var o = t();
            e.Tags.AddTagsTo(o, i.tags); for (var s in o.__serializableMembers) { var a = o.__serializableMembers[s],
                    h = i[a.sourceName || s],
                    l = a.type; if (void 0 !== h && null !== h) switch (l) {
                    case 0:
                        o[s] = h; break;
                    case 1:
                        o[s] = e.Texture.Parse(h, r, n); break;
                    case 2:
                        o[s] = e.Color3.FromArray(h); break;
                    case 3:
                        o[s] = e.FresnelParameters.Parse(h); break;
                    case 4:
                        o[s] = e.Vector2.FromArray(h); break;
                    case 5:
                        o[s] = e.Vector3.FromArray(h); break;
                    case 6:
                        o[s] = r.getLastMeshByID(h); break;
                    case 7:
                        o[s] = e.ColorCurves.Parse(h) } } return o }, t.Clone = function(t, i) { var r = t();
            e.Tags.AddTagsTo(r, i.tags); for (var n in r.__serializableMembers) { var o = r.__serializableMembers[n],
                    s = i[n],
                    a = o.type; if (void 0 !== s && null !== s) switch (a) {
                    case 0:
                    case 6:
                        r[n] = s; break;
                    case 1:
                    case 2:
                    case 3:
                    case 4:
                    case 5:
                    case 7:
                        r[n] = s.clone() } } return r }, t })();
    e.SerializationHelper = d })(BABYLON || (BABYLON = {}));
var BABYLON;
!(function(e) { var t = (function() {
        function e(e, t) { void 0 === t && (t = !1), this.initalize(e, t) } return e.prototype.initalize = function(e, t) { return void 0 === t && (t = !1), this.mask = e, this.skipNextObservers = t, this }, e })();
    e.EventState = t; var i = (function() {
        function e(e, t) { this.callback = e, this.mask = t } return e })();
    e.Observer = i; var r = (function() {
        function e() { this._observers = new Array, this._eventState = new t(0) } return e.prototype.add = function(e, t, r) { if (void 0 === t && (t = -1), void 0 === r && (r = !1), !e) return null; var n = new i(e, t); return r ? this._observers.unshift(n) : this._observers.push(n), n }, e.prototype.remove = function(e) { var t = this._observers.indexOf(e); return t !== -1 && (this._observers.splice(t, 1), !0) }, e.prototype.removeCallback = function(e) { for (var t = 0; t < this._observers.length; t++)
                if (this._observers[t].callback === e) return this._observers.splice(t, 1), !0;
            return !1 }, e.prototype.notifyObservers = function(e, t) { void 0 === t && (t = -1); var i = this._eventState;
            i.mask = t, i.skipNextObservers = !1; for (var r = 0, n = this._observers; r < n.length; r++) { var o = n[r]; if (o.mask & t && o.callback(e, i), i.skipNextObservers) return !1 } return !0 }, e.prototype.hasObservers = function() { return this._observers.length > 0 }, e.prototype.clear = function() { this._observers = new Array }, e.prototype.clone = function() { var t = new e; return t._observers = this._observers.slice(0), t }, e.prototype.hasSpecificMask = function(e) { void 0 === e && (e = -1); for (var t = 0, i = this._observers; t < i.length; t++) { var r = i[t]; if (r.mask & e && r.mask === e) return !0 } return !1 }, e })();
    e.Observable = r })(BABYLON || (BABYLON = {}));
var BABYLON;
!(function(e) { var t = (function() {
        function e(t) { this.length = 0, this._duplicateId = 0, this.data = new Array(t), this._id = e._GlobalId++ } return e.prototype.push = function(e) { this.data[this.length++] = e, this.length > this.data.length && (this.data.length *= 2), e.__smartArrayFlags || (e.__smartArrayFlags = {}), e.__smartArrayFlags[this._id] = this._duplicateId }, e.prototype.forEach = function(e) { for (var t = 0; t < this.length; t++) e(this.data[t]) }, e.prototype.pushNoDuplicate = function(e) { return (!e.__smartArrayFlags || e.__smartArrayFlags[this._id] !== this._duplicateId) && (this.push(e), !0) }, e.prototype.sort = function(e) { this.data.sort(e) }, e.prototype.reset = function() { this.length = 0, this._duplicateId++ }, e.prototype.dispose = function() { this.reset(), this.data.length = 0 }, e.prototype.concat = function(e) { if (0 !== e.length) { this.length + e.length > this.data.length && (this.data.length = 2 * (this.length + e.length)); for (var t = 0; t < e.length; t++) this.data[this.length++] = (e.data || e)[t] } }, e.prototype.concatWithNoDuplicate = function(e) { if (0 !== e.length) { this.length + e.length > this.data.length && (this.data.length = 2 * (this.length + e.length)); for (var t = 0; t < e.length; t++) { var i = (e.data || e)[t];
                    this.pushNoDuplicate(i) } } }, e.prototype.indexOf = function(e) { var t = this.data.indexOf(e); return t >= this.length ? -1 : t }, e.prototype.contains = function(e) { return this.data.indexOf(e) !== -1 }, e })();
    t._GlobalId = 0, e.SmartArray = t })(BABYLON || (BABYLON = {}));
var BABYLON;
!(function(e) {
    function t(e, t) { return function(i) { i.__bjsclassName__ = e, i.__bjsmoduleName__ = null != t ? t : null } }
    var i, r = function(t, i) { return t ? t instanceof e.Mesh ? null : t instanceof e.SubMesh ? t.clone(i) : t.clone ? t.clone() : null : null },
        n = (function() {
            function t() {} return t.Instantiate = function(e) { for (var t = e.split("."), i = window || this, r = 0, n = t.length; r < n; r++) i = i[t[r]]; return "function" != typeof i ? null : i }, t.SetImmediate = function(e) { window.setImmediate ? window.setImmediate(e) : setTimeout(e, 1) }, t.IsExponentOfTwo = function(e) { var t = 1;
                do { t *= 2 } while (t < e); return t === e }, t.GetExponentOfTwo = function(e, t) { var i = 1;
                do { i *= 2 } while (i < e); return i > t && (i = t), i }, t.GetFilename = function(e) { var t = e.lastIndexOf("/"); return t < 0 ? e : e.substring(t + 1) }, t.GetDOMTextContent = function(e) { for (var t = "", i = e.firstChild; i;) 3 === i.nodeType && (t += i.textContent), i = i.nextSibling; return t }, t.ToDegrees = function(e) { return 180 * e / Math.PI }, t.ToRadians = function(e) { return e * Math.PI / 180 }, t.EncodeArrayBufferTobase64 = function(e) { for (var t, i, r, n, o, s, a, h = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=", l = "", c = 0, u = new Uint8Array(e); c < u.length;) t = u[c++], i = c < u.length ? u[c++] : Number.NaN, r = c < u.length ? u[c++] : Number.NaN, n = t >> 2, o = (3 & t) << 4 | i >> 4, s = (15 & i) << 2 | r >> 6, a = 63 & r, isNaN(i) ? s = a = 64 : isNaN(r) && (a = 64), l += h.charAt(n) + h.charAt(o) + h.charAt(s) + h.charAt(a); return "data:image/png;base64," + l }, t.ExtractMinAndMaxIndexed = function(t, i, r, n, o) { void 0 === o && (o = null); for (var s = new e.Vector3(Number.MAX_VALUE, Number.MAX_VALUE, Number.MAX_VALUE), a = new e.Vector3(-Number.MAX_VALUE, -Number.MAX_VALUE, -Number.MAX_VALUE), h = r; h < r + n; h++) { var l = new e.Vector3(t[3 * i[h]], t[3 * i[h] + 1], t[3 * i[h] + 2]);
                    s = e.Vector3.Minimize(l, s), a = e.Vector3.Maximize(l, a) } return o && (s.x -= s.x * o.x + o.y, s.y -= s.y * o.x + o.y, s.z -= s.z * o.x + o.y, a.x += a.x * o.x + o.y, a.y += a.y * o.x + o.y, a.z += a.z * o.x + o.y), { minimum: s, maximum: a } }, t.ExtractMinAndMax = function(t, i, r, n, o) { void 0 === n && (n = null); var s = new e.Vector3(Number.MAX_VALUE, Number.MAX_VALUE, Number.MAX_VALUE),
                    a = new e.Vector3(-Number.MAX_VALUE, -Number.MAX_VALUE, -Number.MAX_VALUE);
                o || (o = 3); for (var h = i; h < i + r; h++) { var l = new e.Vector3(t[h * o], t[h * o + 1], t[h * o + 2]);
                    s = e.Vector3.Minimize(l, s), a = e.Vector3.Maximize(l, a) } return n && (s.x -= s.x * n.x + n.y, s.y -= s.y * n.x + n.y, s.z -= s.z * n.x + n.y, a.x += a.x * n.x + n.y, a.y += a.y * n.x + n.y, a.z += a.z * n.x + n.y), { minimum: s, maximum: a } }, t.Vector2ArrayFeeder = function(t) { return function(i) { var r = void 0 !== t.BYTES_PER_ELEMENT; if (i >= (r ? t.length / 2 : t.length)) return null; if (r) { var n = t; return new e.Vector2(n[2 * i + 0], n[2 * i + 1]) } return t[i] } }, t.ExtractMinAndMaxVector2 = function(t, i) { void 0 === i && (i = null); for (var r = new e.Vector2(Number.MAX_VALUE, Number.MAX_VALUE), n = new e.Vector2(-Number.MAX_VALUE, -Number.MAX_VALUE), o = 0, s = t(o++); s;) r = e.Vector2.Minimize(s, r), n = e.Vector2.Maximize(s, n), s = t(o++); return i && (r.x -= r.x * i.x + i.y, r.y -= r.y * i.x + i.y, n.x += n.x * i.x + i.y, n.y += n.y * i.x + i.y), { minimum: r, maximum: n } }, t.MakeArray = function(e, t) { if (t === !0 || void 0 !== e && null != e) return Array.isArray(e) ? e : [e] }, t.GetPointerPrefix = function() { var e = "pointer"; return window.PointerEvent || navigator.pointerEnabled || (e = "mouse"), e }, t.QueueNewFrame = function(e, t) { void 0 === t && (t = window), t.requestAnimationFrame ? t.requestAnimationFrame(e) : t.msRequestAnimationFrame ? t.msRequestAnimationFrame(e) : t.webkitRequestAnimationFrame ? t.webkitRequestAnimationFrame(e) : t.mozRequestAnimationFrame ? t.mozRequestAnimationFrame(e) : t.oRequestAnimationFrame ? t.oRequestAnimationFrame(e) : window.setTimeout(e, 16) }, t.RequestFullscreen = function(e) { var t = e.requestFullscreen || e.msRequestFullscreen || e.webkitRequestFullscreen || e.mozRequestFullScreen;
                t && t.call(e) }, t.ExitFullscreen = function() { document.exitFullscreen ? document.exitFullscreen() : document.mozCancelFullScreen ? document.mozCancelFullScreen() : document.webkitCancelFullScreen ? document.webkitCancelFullScreen() : document.msCancelFullScreen && document.msCancelFullScreen() }, t.SetCorsBehavior = function(e, i) { if (t.CorsBehavior) switch (typeof t.CorsBehavior) {
                    case "function":
                        var r = t.CorsBehavior(e);
                        r && (i.crossOrigin = r); break;
                    case "string":
                    default:
                        i.crossOrigin = t.CorsBehavior } }, t.CleanUrl = function(e) { return e = e.replace(/#/gm, "%23") }, t.LoadImage = function(i, r, n, o) { i instanceof ArrayBuffer && (i = t.EncodeArrayBufferTobase64(i)), i = t.CleanUrl(i); var s = new Image; "data:" !== i.substr(0, 5) && t.SetCorsBehavior(i, s), s.onload = function() { r(s) }, s.onerror = function(e) { t.Error("Error while trying to load image: " + i), t.UseFallbackTexture ? (s.src = t.fallbackTexture, r(s)) : n() }; var a = function() { s.src = i },
                    h = function() { o.loadImageFromDB(i, s) }; if ("data:" !== i.substr(0, 5) && o && o.enableTexturesOffline && e.Database.IsUASupportingBlobStorage) o.openAsync(h, a);
                else if (i.indexOf("file:") === -1) a();
                else { var l = i.substring(5).toLowerCase(); if (e.FilesInput.FilesToLoad[l]) try { var c; try { c = URL.createObjectURL(e.FilesInput.FilesToLoad[l], { oneTimeOnly: !0 }) } catch (t) { c = URL.createObjectURL(e.FilesInput.FilesToLoad[l]) }
                        s.src = c } catch (e) { s.src = null } else t.Error("Image: " + l + " not found. Did you forget to provide it?"), s.src = t.fallbackTexture } return s }, t.LoadFile = function(i, r, n, o, s, a) { i = t.CleanUrl(i); var h = function() { var e = new XMLHttpRequest,
                            o = t.BaseUrl + i;
                        e.open("GET", o, !0), s && (e.responseType = "arraybuffer"), e.onprogress = n, e.onreadystatechange = function() { if (4 === e.readyState)
                                if (e.onreadystatechange = null, e.status >= 200 && e.status < 300 || navigator.isCocoonJS && 0 === e.status) r(s ? e.response : e.responseText);
                                else { if (!a) throw new Error("Error status: " + e.status + " - Unable to load " + o);
                                    a() } }, e.send(null) },
                    l = function() { o.loadFileFromDB(i, r, n, h, s) }; if (i.indexOf("file:") !== -1) { var c = i.substring(5).toLowerCase();
                    e.FilesInput.FilesToLoad[c] ? t.ReadFile(e.FilesInput.FilesToLoad[c], r, n, s) : t.Error("File: " + c + " not found. Did you forget to provide it?") } else o && o.enableSceneOffline ? o.openAsync(l, h) : h() }, t.LoadScript = function(e, t, i) { var r = document.getElementsByTagName("head")[0],
                    n = document.createElement("script");
                n.type = "text/javascript", n.src = e;
                n.onload = function() { t && t() }, n.onerror = function() { i && i() }, r.appendChild(n) }, t.ReadFileAsDataURL = function(e, t, i) { var r = new FileReader;
                r.onload = function(e) { t(e.target.result) }, r.onprogress = i, r.readAsDataURL(e) }, t.ReadFile = function(e, i, r, n) { var o = new FileReader;
                o.onerror = function(r) { t.Log("Error while reading file: " + e.name), i(JSON.stringify({ autoClear: !0, clearColor: [1, 0, 0], ambientColor: [0, 0, 0], gravity: [0, -9.807, 0], meshes: [], cameras: [], lights: [] })) }, o.onload = function(e) { i(e.target.result) }, o.onprogress = r, n ? o.readAsArrayBuffer(e) : o.readAsText(e) }, t.FileAsURL = function(e) { var t = new Blob([e]); return (window.URL || window.webkitURL).createObjectURL(t) }, t.Format = function(e, t) { return void 0 === t && (t = 2), e.toFixed(t) }, t.CheckExtends = function(e, t, i) { e.x < t.x && (t.x = e.x), e.y < t.y && (t.y = e.y), e.z < t.z && (t.z = e.z), e.x > i.x && (i.x = e.x), e.y > i.y && (i.y = e.y), e.z > i.z && (i.z = e.z) }, t.DeepCopy = function(e, t, i, n) { for (var o in e)
                    if (("_" !== o[0] || n && n.indexOf(o) !== -1) && (!i || i.indexOf(o) === -1)) { var s = e[o],
                            a = typeof s; if ("function" !== a)
                            if ("object" === a)
                                if (s instanceof Array) { if (t[o] = [], s.length > 0)
                                        if ("object" == typeof s[0])
                                            for (var h = 0; h < s.length; h++) { var l = r(s[h], t);
                                                t[o].indexOf(l) === -1 && t[o].push(l) } else t[o] = s.slice(0) } else t[o] = r(s, t);
                        else t[o] = s } }, t.IsEmpty = function(e) { for (var t in e) return !1; return !0 }, t.RegisterTopRootEvents = function(e) { for (var t = 0; t < e.length; t++) { var i = e[t];
                    window.addEventListener(i.name, i.handler, !1); try { window.parent && window.parent.addEventListener(i.name, i.handler, !1) } catch (e) {} } }, t.UnregisterTopRootEvents = function(e) { for (var t = 0; t < e.length; t++) { var i = e[t];
                    window.removeEventListener(i.name, i.handler); try { window.parent && window.parent.removeEventListener(i.name, i.handler) } catch (e) {} } }, t.DumpFramebuffer = function(e, r, n, o, s) { void 0 === s && (s = "image/png"); for (var a = 4 * e, h = r / 2, l = n.readPixels(0, 0, e, r), c = 0; c < h; c++)
                    for (var u = 0; u < a; u++) { var d = u + c * a,
                            f = r - c - 1,
                            p = u + f * a,
                            _ = l[d];
                        l[d] = l[p], l[p] = _ }
                i || (i = document.createElement("canvas")), i.width = e, i.height = r; var m = i.getContext("2d"),
                    g = m.createImageData(e, r);
                g.data.set(l), m.putImageData(g, 0, 0), t.EncodeScreenshotCanvasData(o, s) }, t.EncodeScreenshotCanvasData = function(e, t) { void 0 === t && (t = "image/png"); var r = i.toDataURL(t); if (e) e(r);
                else if ("download" in document.createElement("a")) { var n = window.document.createElement("a");
                    n.href = r; var o = new Date,
                        s = (o.getFullYear() + "-" + (o.getMonth() + 1)).slice(-2) + "-" + o.getDate() + "_" + o.getHours() + "-" + ("0" + o.getMinutes()).slice(-2);
                    n.setAttribute("download", "screenshot_" + s + ".png"), window.document.body.appendChild(n), n.addEventListener("click", (function() { n.parentElement.removeChild(n) })), n.click() } else { var a = window.open(""),
                        h = a.document.createElement("img");
                    h.src = r, a.document.body.appendChild(h) } }, t.CreateScreenshot = function(e, r, n, o, s) { void 0 === s && (s = "image/png"); var a, h; if (n.precision) a = Math.round(e.getRenderWidth() * n.precision), h = Math.round(a / e.getAspectRatio(r));
                else if (n.width && n.height) a = n.width, h = n.height;
                else if (n.width && !n.height) a = n.width, h = Math.round(a / e.getAspectRatio(r));
                else if (n.height && !n.width) h = n.height, a = Math.round(h * e.getAspectRatio(r));
                else { if (isNaN(n)) return void t.Error("Invalid 'size' parameter !");
                    h = n, a = n }
                i || (i = document.createElement("canvas")), i.width = a, i.height = h; var l = i.getContext("2d"),
                    c = e.getRenderWidth() / e.getRenderHeight(),
                    u = a,
                    d = u / c;
                d > h && (d = h, u = d * c); var f = Math.max(0, a - u) / 2,
                    p = Math.max(0, h - d) / 2;
                l.drawImage(e.getRenderingCanvas(), f, p, u, d), t.EncodeScreenshotCanvasData(o, s) }, t.CreateScreenshotUsingRenderTarget = function(i, r, n, o, s, a) { void 0 === s && (s = "image/png"), void 0 === a && (a = 1); var h, l; if (n.precision) h = Math.round(i.getRenderWidth() * n.precision), l = Math.round(h / i.getAspectRatio(r)), n = { width: h, height: l };
                else if (n.width && n.height) h = n.width, l = n.height;
                else if (n.width && !n.height) h = n.width, l = Math.round(h / i.getAspectRatio(r)), n = { width: h, height: l };
                else if (n.height && !n.width) l = n.height, h = Math.round(l * i.getAspectRatio(r)), n = { width: h, height: l };
                else { if (isNaN(n)) return void t.Error("Invalid 'size' parameter !");
                    l = n, h = n } var c = r.getScene(),
                    u = null;
                c.activeCamera !== r && (u = c.activeCamera, c.activeCamera = r); var d = new e.RenderTargetTexture("screenShot", n, c, !1, !1, e.Engine.TEXTURETYPE_UNSIGNED_INT, !1, e.Texture.NEAREST_SAMPLINGMODE);
                d.renderList = c.meshes, d.samples = a, d.onAfterRenderObservable.add((function() { t.DumpFramebuffer(h, l, i, o, s) })), c.incrementRenderId(), c.resetCachedMaterial(), d.render(!0), d.dispose(), u && (c.activeCamera = u), r.getProjectionMatrix(!0) }, t.ValidateXHRData = function(t, i) { void 0 === i && (i = 7); try { if (1 & i) { if (t.responseText && t.responseText.length > 0) return !0; if (1 === i) return !1 } if (2 & i) { var r = e.Internals.TGATools.GetTGAHeader(t.response); if (r.width && r.height && r.width > 0 && r.height > 0) return !0; if (2 === i) return !1 } if (4 & i) { var n = new Uint8Array(t.response, 0, 3); return 68 === n[0] && 68 === n[1] && 83 === n[2] } } catch (e) {} return !1 }, t.RandomId = function() { return "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g, (function(e) { var t = 16 * Math.random() | 0; return ("x" === e ? t : 3 & t | 8).toString(16) })) }, Object.defineProperty(t, "NoneLogLevel", { get: function() { return t._NoneLogLevel }, enumerable: !0, configurable: !0 }), Object.defineProperty(t, "MessageLogLevel", { get: function() { return t._MessageLogLevel }, enumerable: !0, configurable: !0 }), Object.defineProperty(t, "WarningLogLevel", { get: function() { return t._WarningLogLevel }, enumerable: !0, configurable: !0 }), Object.defineProperty(t, "ErrorLogLevel", { get: function() { return t._ErrorLogLevel }, enumerable: !0, configurable: !0 }), Object.defineProperty(t, "AllLogLevel", { get: function() { return t._MessageLogLevel | t._WarningLogLevel | t._ErrorLogLevel }, enumerable: !0, configurable: !0 }), t._AddLogEntry = function(e) { t._LogCache = e + t._LogCache, t.OnNewCacheEntry && t.OnNewCacheEntry(e) }, t._FormatMessage = function(e) { var t = function(e) { return e < 10 ? "0" + e : "" + e },
                    i = new Date; return "[" + t(i.getHours()) + ":" + t(i.getMinutes()) + ":" + t(i.getSeconds()) + "]: " + e }, t._LogDisabled = function(e) {}, t._LogEnabled = function(e) { var i = t._FormatMessage(e);
                console.log("BJS - " + i); var r = "<div style='color:white'>" + i + "</div><br>";
                t._AddLogEntry(r) }, t._WarnDisabled = function(e) {}, t._WarnEnabled = function(e) { var i = t._FormatMessage(e);
                console.warn("BJS - " + i); var r = "<div style='color:orange'>" + i + "</div><br>";
                t._AddLogEntry(r) }, t._ErrorDisabled = function(e) {}, t._ErrorEnabled = function(e) { t.errorsCount++; var i = t._FormatMessage(e);
                console.error("BJS - " + i); var r = "<div style='color:red'>" + i + "</div><br>";
                t._AddLogEntry(r) }, Object.defineProperty(t, "LogCache", { get: function() { return t._LogCache }, enumerable: !0, configurable: !0 }), t.ClearLogCache = function() { t._LogCache = "", t.errorsCount = 0 }, Object.defineProperty(t, "LogLevels", { set: function(e) {
                    (e & t.MessageLogLevel) === t.MessageLogLevel ? t.Log = t._LogEnabled : t.Log = t._LogDisabled, (e & t.WarningLogLevel) === t.WarningLogLevel ? t.Warn = t._WarnEnabled : t.Warn = t._WarnDisabled, (e & t.ErrorLogLevel) === t.ErrorLogLevel ? t.Error = t._ErrorEnabled : t.Error = t._ErrorDisabled }, enumerable: !0, configurable: !0 }), Object.defineProperty(t, "PerformanceNoneLogLevel", { get: function() { return t._PerformanceNoneLogLevel }, enumerable: !0, configurable: !0 }), Object.defineProperty(t, "PerformanceUserMarkLogLevel", { get: function() { return t._PerformanceUserMarkLogLevel }, enumerable: !0, configurable: !0 }), Object.defineProperty(t, "PerformanceConsoleLogLevel", { get: function() { return t._PerformanceConsoleLogLevel }, enumerable: !0, configurable: !0 }), Object.defineProperty(t, "PerformanceLogLevel", { set: function(e) { return (e & t.PerformanceUserMarkLogLevel) === t.PerformanceUserMarkLogLevel ? (t.StartPerformanceCounter = t._StartUserMark, void(t.EndPerformanceCounter = t._EndUserMark)) : (e & t.PerformanceConsoleLogLevel) === t.PerformanceConsoleLogLevel ? (t.StartPerformanceCounter = t._StartPerformanceConsole, void(t.EndPerformanceCounter = t._EndPerformanceConsole)) : (t.StartPerformanceCounter = t._StartPerformanceCounterDisabled, void(t.EndPerformanceCounter = t._EndPerformanceCounterDisabled)) }, enumerable: !0, configurable: !0 }), t._StartPerformanceCounterDisabled = function(e, t) {}, t._EndPerformanceCounterDisabled = function(e, t) {}, t._StartUserMark = function(e, i) { void 0 === i && (i = !0), i && t._performance.mark && t._performance.mark(e + "-Begin") }, t._EndUserMark = function(e, i) { void 0 === i && (i = !0), i && t._performance.mark && (t._performance.mark(e + "-End"), t._performance.measure(e, e + "-Begin", e + "-End")) }, t._StartPerformanceConsole = function(e, i) { void 0 === i && (i = !0), i && (t._StartUserMark(e, i), console.time && console.time(e)) }, t._EndPerformanceConsole = function(e, i) { void 0 === i && (i = !0), i && (t._EndUserMark(e, i), console.time && console.timeEnd(e)) }, Object.defineProperty(t, "Now", { get: function() { return window.performance && window.performance.now ? window.performance.now() : (new Date).getTime() }, enumerable: !0, configurable: !0 }), t.getClassName = function(e, t) { void 0 === t && (t = !1); var i = null; if (!t && e.getClassName) i = e.getClassName();
                else { if (e instanceof Object) { i = (t ? e : Object.getPrototypeOf(e)).constructor.__bjsclassName__ }
                    i || (i = typeof e) } return i }, t.first = function(e, t) { for (var i = 0, r = e; i < r.length; i++) { var n = r[i]; if (t(n)) return n } }, t.getFullClassName = function(e, t) { void 0 === t && (t = !1); var i = null,
                    r = null; if (!t && e.getClassName) i = e.getClassName();
                else { if (e instanceof Object) { var n = t ? e : Object.getPrototypeOf(e);
                        i = n.constructor.__bjsclassName__, r = n.constructor.__bjsmoduleName__ }
                    i || (i = typeof e) } return i ? (null != r ? r + "." : "") + i : null }, t.arrayOrStringFeeder = function(e) { return function(i) { if (i >= e.length) return null; var r = e.charCodeAt ? e.charCodeAt(i) : e[i]; return r && r.getHashCode && (r = r.getHashCode()), "string" == typeof r ? t.hashCodeFromStream(t.arrayOrStringFeeder(r)) : r } }, t.hashCodeFromStream = function(e) { for (var t = 0, i = 0, r = e(i++); null != r;) t = (t << 5) - t + r, t |= 0, r = e(i++); return t }, t })();
    n.BaseUrl = "", n.CorsBehavior = "anonymous", n.UseFallbackTexture = !0, n.fallbackTexture = "data:image/jpg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/4QBmRXhpZgAATU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAAExAAIAAAAQAAAATgAAAAAAAABgAAAAAQAAAGAAAAABcGFpbnQubmV0IDQuMC41AP/bAEMABAIDAwMCBAMDAwQEBAQFCQYFBQUFCwgIBgkNCw0NDQsMDA4QFBEODxMPDAwSGBITFRYXFxcOERkbGRYaFBYXFv/bAEMBBAQEBQUFCgYGChYPDA8WFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFv/AABEIAQABAAMBIgACEQEDEQH/xAAfAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgv/xAC1EAACAQMDAgQDBQUEBAAAAX0BAgMABBEFEiExQQYTUWEHInEUMoGRoQgjQrHBFVLR8CQzYnKCCQoWFxgZGiUmJygpKjQ1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4eLj5OXm5+jp6vHy8/T19vf4+fr/xAAfAQADAQEBAQEBAQEBAAAAAAAAAQIDBAUGBwgJCgv/xAC1EQACAQIEBAMEBwUEBAABAncAAQIDEQQFITEGEkFRB2FxEyIygQgUQpGhscEJIzNS8BVictEKFiQ04SXxFxgZGiYnKCkqNTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqCg4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2dri4+Tl5ufo6ery8/T19vf4+fr/2gAMAwEAAhEDEQA/APH6KKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76CiiigD5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BQooooA+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/voKKKKAPl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76CiiigD5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BQooooA+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/voKKKKAPl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76P//Z", n._NoneLogLevel = 0, n._MessageLogLevel = 1, n._WarningLogLevel = 2, n._ErrorLogLevel = 4, n._LogCache = "", n.errorsCount = 0, n.Log = n._LogEnabled, n.Warn = n._WarnEnabled, n.Error = n._ErrorEnabled, n._PerformanceNoneLogLevel = 0, n._PerformanceUserMarkLogLevel = 1, n._PerformanceConsoleLogLevel = 2, n._performance = window.performance, n.StartPerformanceCounter = n._StartPerformanceCounterDisabled, n.EndPerformanceCounter = n._EndPerformanceCounterDisabled, e.Tools = n;
    var o = (function() {
        function e() { this._startMonitoringTime = 0, this._min = 0, this._max = 0, this._average = 0, this._lastSecAverage = 0, this._current = 0, this._totalValueCount = 0, this._totalAccumulated = 0, this._lastSecAccumulated = 0, this._lastSecTime = 0, this._lastSecValueCount = 0 } return Object.defineProperty(e.prototype, "min", { get: function() { return this._min }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "max", { get: function() { return this._max }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "average", { get: function() { return this._average }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "lastSecAverage", { get: function() { return this._lastSecAverage }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "current", { get: function() { return this._current }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "total", { get: function() { return this._totalAccumulated }, enumerable: !0, configurable: !0 }), e.prototype.fetchNewFrame = function() { this._totalValueCount++, this._current = 0, this._lastSecValueCount++ }, e.prototype.addCount = function(t, i) { e.Enabled && (this._current += t, i && this._fetchResult()) }, e.prototype.beginMonitoring = function() { e.Enabled && (this._startMonitoringTime = n.Now) }, e.prototype.endMonitoring = function(t) { if (void 0 === t && (t = !0), e.Enabled) { t && this.fetchNewFrame(); var i = n.Now;
                this._current = i - this._startMonitoringTime, t && this._fetchResult() } }, e.prototype._fetchResult = function() { this._totalAccumulated += this._current, this._lastSecAccumulated += this._current, this._min = Math.min(this._min, this._current), this._max = Math.max(this._max, this._current), this._average = this._totalAccumulated / this._totalValueCount; var e = n.Now;
            e - this._lastSecTime > 1e3 && (this._lastSecAverage = this._lastSecAccumulated / this._lastSecValueCount, this._lastSecTime = e, this._lastSecAccumulated = 0, this._lastSecValueCount = 0) }, e })();
    o.Enabled = !0, e.PerfCounter = o, e.className = t;
    var s = (function() {
        function e(e, t, i, r) { void 0 === r && (r = 0), this.iterations = e, this._fn = t, this._successCallback = i, this.index = r - 1, this._done = !1 } return e.prototype.executeNext = function() { this._done || (this.index + 1 < this.iterations ? (++this.index, this._fn(this)) : this.breakLoop()) }, e.prototype.breakLoop = function() { this._done = !0, this._successCallback() }, e.Run = function(t, i, r, n) { void 0 === n && (n = 0); var o = new e(t, i, r, n); return o.executeNext(), o }, e.SyncAsyncForLoop = function(t, i, r, n, o, s) { void 0 === s && (s = 0), e.Run(Math.ceil(t / i), (function(e) { o && o() ? e.breakLoop() : setTimeout((function() { for (var n = 0; n < i; ++n) { var s = e.index * i + n; if (s >= t) break; if (r(s), o && o()) { e.breakLoop(); break } }
                    e.executeNext() }), s) }), n) }, e })();
    e.AsyncLoop = s
})(BABYLON || (BABYLON = {}));
var BABYLON;
!(function(e) {!(function(e) { var t = (function() {
            function e() { this._isAlphaBlendDirty = !1, this._isBlendFunctionParametersDirty = !1, this._alphaBlend = !1, this._blendFunctionParameters = new Array(4), this.reset() } return Object.defineProperty(e.prototype, "isDirty", { get: function() { return this._isAlphaBlendDirty || this._isBlendFunctionParametersDirty }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "alphaBlend", { get: function() { return this._alphaBlend }, set: function(e) { this._alphaBlend !== e && (this._alphaBlend = e, this._isAlphaBlendDirty = !0) }, enumerable: !0, configurable: !0 }), e.prototype.setAlphaBlendFunctionParameters = function(e, t, i, r) { this._blendFunctionParameters[0] === e && this._blendFunctionParameters[1] === t && this._blendFunctionParameters[2] === i && this._blendFunctionParameters[3] === r || (this._blendFunctionParameters[0] = e, this._blendFunctionParameters[1] = t, this._blendFunctionParameters[2] = i, this._blendFunctionParameters[3] = r, this._isBlendFunctionParametersDirty = !0) }, e.prototype.reset = function() { this._alphaBlend = !1, this._blendFunctionParameters[0] = null, this._blendFunctionParameters[1] = null, this._blendFunctionParameters[2] = null, this._blendFunctionParameters[3] = null, this._isAlphaBlendDirty = !0, this._isBlendFunctionParametersDirty = !1 }, e.prototype.apply = function(e) { this.isDirty && (this._isAlphaBlendDirty && (this._alphaBlend ? e.enable(e.BLEND) : e.disable(e.BLEND), this._isAlphaBlendDirty = !1), this._isBlendFunctionParametersDirty && (e.blendFuncSeparate(this._blendFunctionParameters[0], this._blendFunctionParameters[1], this._blendFunctionParameters[2], this._blendFunctionParameters[3]), this._isBlendFunctionParametersDirty = !1)) }, e })();
        e._AlphaState = t })(e.Internals || (e.Internals = {})) })(BABYLON || (BABYLON = {}));
var BABYLON;
!(function(e) {!(function(e) { var t = (function() {
            function e() { this._isDepthTestDirty = !1, this._isDepthMaskDirty = !1, this._isDepthFuncDirty = !1, this._isCullFaceDirty = !1, this._isCullDirty = !1, this._isZOffsetDirty = !1, this.reset() } return Object.defineProperty(e.prototype, "isDirty", { get: function() { return this._isDepthFuncDirty || this._isDepthTestDirty || this._isDepthMaskDirty || this._isCullFaceDirty || this._isCullDirty || this._isZOffsetDirty }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "zOffset", { get: function() { return this._zOffset }, set: function(e) { this._zOffset !== e && (this._zOffset = e, this._isZOffsetDirty = !0) }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "cullFace", { get: function() { return this._cullFace }, set: function(e) { this._cullFace !== e && (this._cullFace = e, this._isCullFaceDirty = !0) }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "cull", { get: function() { return this._cull }, set: function(e) { this._cull !== e && (this._cull = e, this._isCullDirty = !0) }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "depthFunc", { get: function() { return this._depthFunc }, set: function(e) { this._depthFunc !== e && (this._depthFunc = e, this._isDepthFuncDirty = !0) }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "depthMask", { get: function() { return this._depthMask }, set: function(e) { this._depthMask !== e && (this._depthMask = e, this._isDepthMaskDirty = !0) }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "depthTest", { get: function() { return this._depthTest }, set: function(e) { this._depthTest !== e && (this._depthTest = e, this._isDepthTestDirty = !0) }, enumerable: !0, configurable: !0 }), e.prototype.reset = function() { this._depthMask = !0, this._depthTest = !0, this._depthFunc = null, this._cullFace = null, this._cull = null, this._zOffset = 0, this._isDepthTestDirty = !0, this._isDepthMaskDirty = !0, this._isDepthFuncDirty = !1, this._isCullFaceDirty = !1, this._isCullDirty = !1, this._isZOffsetDirty = !1 }, e.prototype.apply = function(e) { this.isDirty && (this._isCullDirty && (this.cull ? e.enable(e.CULL_FACE) : e.disable(e.CULL_FACE), this._isCullDirty = !1), this._isCullFaceDirty && (e.cullFace(this.cullFace), this._isCullFaceDirty = !1), this._isDepthMaskDirty && (e.depthMask(this.depthMask), this._isDepthMaskDirty = !1), this._isDepthTestDirty && (this.depthTest ? e.enable(e.DEPTH_TEST) : e.disable(e.DEPTH_TEST), this._isDepthTestDirty = !1), this._isDepthFuncDirty && (e.depthFunc(this.depthFunc), this._isDepthFuncDirty = !1), this._isZOffsetDirty && (this.zOffset ? (e.enable(e.POLYGON_OFFSET_FILL), e.polygonOffset(this.zOffset, 0)) : e.disable(e.POLYGON_OFFSET_FILL), this._isZOffsetDirty = !1)) }, e })();
        e._DepthCullingState = t })(e.Internals || (e.Internals = {})) })(BABYLON || (BABYLON = {}));
var BABYLON;
!(function(e) {!(function(t) { var i = (function() {
            function t() { this._isStencilTestDirty = !1, this._isStencilMaskDirty = !1, this._isStencilFuncDirty = !1, this._isStencilOpDirty = !1, this.reset() } return Object.defineProperty(t.prototype, "isDirty", { get: function() { return this._isStencilTestDirty || this._isStencilMaskDirty || this._isStencilFuncDirty || this._isStencilOpDirty }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "stencilFunc", { get: function() { return this._stencilFunc }, set: function(e) { this._stencilFunc !== e && (this._stencilFunc = e, this._isStencilFuncDirty = !0) }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "stencilFuncRef", { get: function() { return this._stencilFuncRef }, set: function(e) { this._stencilFuncRef !== e && (this._stencilFuncRef = e, this._isStencilFuncDirty = !0) }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "stencilFuncMask", { get: function() { return this._stencilFuncMask }, set: function(e) { this._stencilFuncMask !== e && (this._stencilFuncMask = e, this._isStencilFuncDirty = !0) }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "stencilOpStencilFail", { get: function() { return this._stencilOpStencilFail }, set: function(e) { this._stencilOpStencilFail !== e && (this._stencilOpStencilFail = e, this._isStencilOpDirty = !0) }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "stencilOpDepthFail", { get: function() { return this._stencilOpDepthFail }, set: function(e) { this._stencilOpDepthFail !== e && (this._stencilOpDepthFail = e, this._isStencilOpDirty = !0) }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "stencilOpStencilDepthPass", { get: function() { return this._stencilOpStencilDepthPass }, set: function(e) { this._stencilOpStencilDepthPass !== e && (this._stencilOpStencilDepthPass = e, this._isStencilOpDirty = !0) }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "stencilMask", { get: function() { return this._stencilMask }, set: function(e) { this._stencilMask !== e && (this._stencilMask = e, this._isStencilMaskDirty = !0) }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "stencilTest", { get: function() { return this._stencilTest }, set: function(e) { this._stencilTest !== e && (this._stencilTest = e, this._isStencilTestDirty = !0) }, enumerable: !0, configurable: !0 }), t.prototype.reset = function() { this._stencilTest = !1, this._stencilMask = 255, this._stencilFunc = e.Engine.ALWAYS, this._stencilFuncRef = 1, this._stencilFuncMask = 255, this._stencilOpStencilFail = e.Engine.KEEP, this._stencilOpDepthFail = e.Engine.KEEP, this._stencilOpStencilDepthPass = e.Engine.REPLACE, this._isStencilTestDirty = !0, this._isStencilMaskDirty = !0, this._isStencilFuncDirty = !0, this._isStencilOpDirty = !0 }, t.prototype.apply = function(e) { this.isDirty && (this._isStencilTestDirty && (this.stencilTest ? e.enable(e.STENCIL_TEST) : e.disable(e.STENCIL_TEST), this._isStencilTestDirty = !1), this._isStencilMaskDirty && (e.stencilMask(this.stencilMask), this._isStencilMaskDirty = !1), this._isStencilFuncDirty && (e.stencilFunc(this.stencilFunc, this.stencilFuncRef, this.stencilFuncMask), this._isStencilFuncDirty = !1), this._isStencilOpDirty && (e.stencilOp(this.stencilOpStencilFail, this.stencilOpDepthFail, this.stencilOpStencilDepthPass), this._isStencilOpDirty = !1)) }, t })();
        t._StencilState = i })(e.Internals || (e.Internals = {})) })(BABYLON || (BABYLON = {}));
var BABYLON;
!(function(e) {
    var t = function(e, t, i, r, n) { var o = e.createShader("vertex" === i ? e.VERTEX_SHADER : e.FRAGMENT_SHADER); if (e.shaderSource(o, n + (r ? r + "\n" : "") + t), e.compileShader(o), !e.getShaderParameter(o, e.COMPILE_STATUS)) throw new Error(e.getShaderInfoLog(o)); return o },
        i = function(t, i, r) { var n = r.NEAREST,
                o = r.NEAREST; return t === e.Texture.BILINEAR_SAMPLINGMODE ? (n = r.LINEAR, o = i ? r.LINEAR_MIPMAP_NEAREST : r.LINEAR) : t === e.Texture.TRILINEAR_SAMPLINGMODE ? (n = r.LINEAR, o = i ? r.LINEAR_MIPMAP_LINEAR : r.LINEAR) : t === e.Texture.NEAREST_SAMPLINGMODE && (n = r.NEAREST, o = i ? r.NEAREST_MIPMAP_LINEAR : r.NEAREST), { min: o, mag: n } },
        r = function(t, r, n, o, s, a, h, l, c, u) { void 0 === u && (u = e.Texture.TRILINEAR_SAMPLINGMODE); var d = n.getEngine(); if (d) { var f = e.Tools.GetExponentOfTwo(o, d.getCaps().maxTextureSize),
                    p = e.Tools.GetExponentOfTwo(s, d.getCaps().maxTextureSize);
                d._bindTextureDirectly(r.TEXTURE_2D, t), r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL, void 0 === a ? 1 : a ? 1 : 0), t._baseWidth = o, t._baseHeight = s, t._width = f, t._height = p, t.isReady = !0, c(f, p); var _ = i(u, !h, r);
                r.texParameteri(r.TEXTURE_2D, r.TEXTURE_MAG_FILTER, _.mag), r.texParameteri(r.TEXTURE_2D, r.TEXTURE_MIN_FILTER, _.min), h || l || r.generateMipmap(r.TEXTURE_2D), d._bindTextureDirectly(r.TEXTURE_2D, null), d.resetTextureCache(), n._removePendingData(t), t.onLoadedCallbacks.forEach((function(e) { e() })), t.onLoadedCallbacks = [] } },
        n = function(t, i, r, n, o, s) { void 0 === s && (s = null); var a, h = function() { r[i] = a, r._internalCount++, n._removePendingData(a), 6 === r._internalCount && o(r) },
                l = function() { n._removePendingData(a), s && s() };
            a = e.Tools.LoadImage(t, h, l, n.database), n._addPendingData(a) },
        o = function(e, t, i, r, o) { void 0 === o && (o = null); var s = [];
            s._internalCount = 0; for (var a = 0; a < 6; a++) n(r[a], a, s, t, i, o) },
        s = (function() {
            function e() {} return e })();
    e.InstancingAttributeInfo = s;
    var a = (function() {
        function e() {} return e })();
    e.EngineCapabilities = a;
    var h = (function() {
        function n(t, i, r, o) {
            void 0 === o && (o = !1);
            var s = this;
            if (this.isFullscreen = !1, this.isPointerLock = !1, this.cullBackFaces = !0, this.renderEvenInBackground = !0, this.preventCacheWipeBetweenFrames = !1, this.enableOfflineSupport = e.Database, this.scenes = new Array, this._windowIsBackground = !1, this._webGLVersion = 1, this._badOS = !1,
                this._drawCalls = new e.PerfCounter, this._renderingQueueLaunched = !1, this._activeRenderLoops = [], this.fpsRange = 60, this.previousFramesDuration = [], this.fps = 60, this.deltaTime = 0, this._depthCullingState = new e.Internals._DepthCullingState, this._stencilState = new e.Internals._StencilState, this._alphaState = new e.Internals._AlphaState, this._alphaMode = n.ALPHA_DISABLE, this._loadedTexturesCache = new Array, this._maxTextureChannels = 16, this._activeTexturesCache = new Array(this._maxTextureChannels), this._compiledEffects = {}, this._vertexAttribArraysEnabled = [], this._uintIndicesCurrentlySet = !1, this._currentBoundBuffer = new Array, this._currentBufferPointers = [], this._currentInstanceLocations = new Array, this._currentInstanceBuffers = new Array, this._vaoRecordInProgress = !1, this._mustWipeVertexAttributes = !1, this._texturesSupported = new Array, this._onVRFullScreenTriggered = function() { if (s._vrDisplayEnabled && s._vrDisplayEnabled.isPresenting) { s._oldSize = new e.Size(s.getRenderWidth(), s.getRenderHeight()), s._oldHardwareScaleFactor = s.getHardwareScalingLevel(); var t = s._vrDisplayEnabled.getEyeParameters("left");
                        s.setHardwareScalingLevel(1), s.setSize(2 * t.renderWidth, t.renderHeight) } else s.setHardwareScalingLevel(s._oldHardwareScaleFactor), s.setSize(s._oldSize.width, s._oldSize.height), s._vrDisplayEnabled = void 0 }, this._renderingCanvas = t, n.Instances.push(this), r = r || {}, null != i && (r.antialias = i), void 0 === r.preserveDrawingBuffer && (r.preserveDrawingBuffer = !1), void 0 === r.audioEngine && (r.audioEngine = !0), void 0 === r.stencil && (r.stencil = !0), !r.disableWebGL2Support) try { this._gl = t.getContext("webgl2", r) || t.getContext("experimental-webgl2", r), this._gl && (this._webGLVersion = 2) } catch (e) {}
            if (!this._gl) { if (!t) throw new Error("The provided canvas is null or undefined."); try { this._gl = t.getContext("webgl", r) || t.getContext("experimental-webgl", r) } catch (e) { throw new Error("WebGL not supported") } }
            if (!this._gl) throw new Error("WebGL not supported");
            this._onBlur = function() { s._windowIsBackground = !0 }, this._onFocus = function() { s._windowIsBackground = !1 }, window.addEventListener("blur", this._onBlur), window.addEventListener("focus", this._onFocus);
            var h = r.limitDeviceRatio || window.devicePixelRatio || 1;
            this._hardwareScalingLevel = o ? 1 / Math.min(h, window.devicePixelRatio || 1) : 1, this.resize(), this._isStencilEnable = r.stencil, this._caps = new a, this._caps.maxTexturesImageUnits = this._gl.getParameter(this._gl.MAX_TEXTURE_IMAGE_UNITS), this._caps.maxVertexTextureImageUnits = this._gl.getParameter(this._gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS), this._caps.maxTextureSize = this._gl.getParameter(this._gl.MAX_TEXTURE_SIZE), this._caps.maxCubemapTextureSize = this._gl.getParameter(this._gl.MAX_CUBE_MAP_TEXTURE_SIZE), this._caps.maxRenderTextureSize = this._gl.getParameter(this._gl.MAX_RENDERBUFFER_SIZE), this._caps.maxVertexAttribs = this._gl.getParameter(this._gl.MAX_VERTEX_ATTRIBS), this._caps.maxVaryingVectors = this._gl.getParameter(this._gl.MAX_VARYING_VECTORS), this._caps.maxFragmentUniformVectors = this._gl.getParameter(this._gl.MAX_FRAGMENT_UNIFORM_VECTORS), this._caps.maxVertexUniformVectors = this._gl.getParameter(this._gl.MAX_VERTEX_UNIFORM_VECTORS), this._glVersion = this._gl.getParameter(this._gl.VERSION);
            var l = this._gl.getExtension("WEBGL_debug_renderer_info");
            if (null != l && (this._glRenderer = this._gl.getParameter(l.UNMASKED_RENDERER_WEBGL), this._glVendor = this._gl.getParameter(l.UNMASKED_VENDOR_WEBGL)), this._glVendor || (this._glVendor = "Unknown vendor"), this._glRenderer || (this._glRenderer = "Unknown renderer"), this._caps.standardDerivatives = this._webGLVersion > 1 || null !== this._gl.getExtension("OES_standard_derivatives"), this._caps.astc = this._gl.getExtension("WEBGL_compressed_texture_astc") || this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_astc"), this._caps.s3tc = this._gl.getExtension("WEBGL_compressed_texture_s3tc") || this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc"), this._caps.pvrtc = this._gl.getExtension("WEBGL_compressed_texture_pvrtc") || this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"), this._caps.etc1 = this._gl.getExtension("WEBGL_compressed_texture_etc1") || this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_etc1"), this._caps.etc2 = this._gl.getExtension("WEBGL_compressed_texture_etc") || this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_etc") || this._gl.getExtension("WEBGL_compressed_texture_es3_0"), this._caps.textureAnisotropicFilterExtension = this._gl.getExtension("EXT_texture_filter_anisotropic") || this._gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic") || this._gl.getExtension("MOZ_EXT_texture_filter_anisotropic"), this._caps.maxAnisotropy = this._caps.textureAnisotropicFilterExtension ? this._gl.getParameter(this._caps.textureAnisotropicFilterExtension.MAX_TEXTURE_MAX_ANISOTROPY_EXT) : 0, this._caps.uintIndices = this._webGLVersion > 1 || null !== this._gl.getExtension("OES_element_index_uint"), this._caps.fragmentDepthSupported = this._webGLVersion > 1 || null !== this._gl.getExtension("EXT_frag_depth"), this._caps.highPrecisionShaderSupported = !0, this._caps.drawBuffersExtension = this._webGLVersion > 1 || this._gl.getExtension("WEBGL_draw_buffers"), this._caps.colorBufferFloat = this._webGLVersion > 1 && this._gl.getExtension("EXT_color_buffer_float"), this._caps.textureFloat = this._webGLVersion > 1 || this._gl.getExtension("OES_texture_float"), this._caps.textureFloatLinearFiltering = this._caps.textureFloat && this._gl.getExtension("OES_texture_float_linear"), this._caps.textureFloatRender = this._caps.textureFloat && this._canRenderToFloatFramebuffer(), this._caps.textureHalfFloat = this._webGLVersion > 1 || this._gl.getExtension("OES_texture_half_float"), this._caps.textureHalfFloatLinearFiltering = this._webGLVersion > 1 || this._caps.textureHalfFloat && this._gl.getExtension("OES_texture_half_float_linear"), this._caps.textureHalfFloatRender = this._caps.textureHalfFloat && this._canRenderToHalfFloatFramebuffer(), this._caps.textureLOD = this._webGLVersion > 1 || this._gl.getExtension("EXT_shader_texture_lod"), this._webGLVersion > 1) this._caps.vertexArrayObject = !0;
            else { var c = this._gl.getExtension("OES_vertex_array_object");
                null != c ? (this._caps.vertexArrayObject = !0, this._gl.createVertexArray = c.createVertexArrayOES.bind(c), this._gl.bindVertexArray = c.bindVertexArrayOES.bind(c), this._gl.deleteVertexArray = c.deleteVertexArrayOES.bind(c)) : this._caps.vertexArrayObject = !1 }
            if (this._webGLVersion > 1) this._caps.instancedArrays = !0;
            else { var u = this._gl.getExtension("ANGLE_instanced_arrays");
                null != u ? (this._caps.instancedArrays = !0, this._gl.drawArraysInstanced = u.drawArraysInstancedANGLE.bind(u), this._gl.drawElementsInstanced = u.drawElementsInstancedANGLE.bind(u), this._gl.vertexAttribDivisor = u.vertexAttribDivisorANGLE.bind(u)) : this._caps.instancedArrays = !1 }
            if (this._caps.astc && this.texturesSupported.push("-astc.ktx"), this._caps.s3tc && this.texturesSupported.push("-dxt.ktx"), this._caps.pvrtc && this.texturesSupported.push("-pvrtc.ktx"), this._caps.etc2 && this.texturesSupported.push("-etc2.ktx"), this._caps.etc1 && this.texturesSupported.push("-etc1.ktx"), this._gl.getShaderPrecisionFormat) { var d = this._gl.getShaderPrecisionFormat(this._gl.FRAGMENT_SHADER, this._gl.HIGH_FLOAT);
                this._caps.highPrecisionShaderSupported = 0 !== d.precision }
            this.setDepthBuffer(!0), this.setDepthFunctionToLessOrEqual(), this.setDepthWrite(!0), this._onFullscreenChange = function() { void 0 !== document.fullscreen ? s.isFullscreen = document.fullscreen : void 0 !== document.mozFullScreen ? s.isFullscreen = document.mozFullScreen : void 0 !== document.webkitIsFullScreen ? s.isFullscreen = document.webkitIsFullScreen : void 0 !== document.msIsFullScreen && (s.isFullscreen = document.msIsFullScreen), s.isFullscreen && s._pointerLockRequested && (t.requestPointerLock = t.requestPointerLock || t.msRequestPointerLock || t.mozRequestPointerLock || t.webkitRequestPointerLock, t.requestPointerLock && t.requestPointerLock()) }, document.addEventListener("fullscreenchange", this._onFullscreenChange, !1), document.addEventListener("mozfullscreenchange", this._onFullscreenChange, !1), document.addEventListener("webkitfullscreenchange", this._onFullscreenChange, !1), document.addEventListener("msfullscreenchange", this._onFullscreenChange, !1), this._onPointerLockChange = function() { s.isPointerLock = document.mozPointerLockElement === t || document.webkitPointerLockElement === t || document.msPointerLockElement === t || document.pointerLockElement === t }, document.addEventListener("pointerlockchange", this._onPointerLockChange, !1), document.addEventListener("mspointerlockchange", this._onPointerLockChange, !1), document.addEventListener("mozpointerlockchange", this._onPointerLockChange, !1), document.addEventListener("webkitpointerlockchange", this._onPointerLockChange, !1), r.audioEngine && e.AudioEngine && !n.audioEngine && (n.audioEngine = new e.AudioEngine), r.autoEnableWebVR && this.initWebVR();
            var f = /AppleWebKit.*10.[\d] Mobile/;
            this._badOS = f.test(navigator.userAgent), e.Tools.Log("Babylon.js engine (v" + n.Version + ") launched")
        }
        return Object.defineProperty(n, "LastCreatedEngine", { get: function() { return 0 === n.Instances.length ? null : n.Instances[n.Instances.length - 1] }, enumerable: !0, configurable: !0 }), Object.defineProperty(n, "LastCreatedScene", { get: function() { var e = n.LastCreatedEngine; return e ? 0 === e.scenes.length ? null : e.scenes[e.scenes.length - 1] : null }, enumerable: !0, configurable: !0 }), n.MarkAllMaterialsAsDirty = function(e, t) { for (var i = 0; i < n.Instances.length; i++)
                for (var r = n.Instances[i], o = 0; o < r.scenes.length; o++) r.scenes[o].markAllMaterialsAsDirty(e, t) }, Object.defineProperty(n, "NEVER", { get: function() { return n._NEVER }, enumerable: !0, configurable: !0 }), Object.defineProperty(n, "ALWAYS", { get: function() { return n._ALWAYS }, enumerable: !0, configurable: !0 }), Object.defineProperty(n, "LESS", { get: function() { return n._LESS }, enumerable: !0, configurable: !0 }), Object.defineProperty(n, "EQUAL", { get: function() { return n._EQUAL }, enumerable: !0, configurable: !0 }), Object.defineProperty(n, "LEQUAL", { get: function() { return n._LEQUAL }, enumerable: !0, configurable: !0 }), Object.defineProperty(n, "GREATER", { get: function() { return n._GREATER }, enumerable: !0, configurable: !0 }), Object.defineProperty(n, "GEQUAL", { get: function() { return n._GEQUAL }, enumerable: !0, configurable: !0 }), Object.defineProperty(n, "NOTEQUAL", { get: function() { return n._NOTEQUAL }, enumerable: !0, configurable: !0 }), Object.defineProperty(n, "KEEP", { get: function() { return n._KEEP }, enumerable: !0, configurable: !0 }), Object.defineProperty(n, "REPLACE", { get: function() { return n._REPLACE }, enumerable: !0, configurable: !0 }), Object.defineProperty(n, "INCR", { get: function() { return n._INCR }, enumerable: !0, configurable: !0 }), Object.defineProperty(n, "DECR", { get: function() { return n._DECR }, enumerable: !0, configurable: !0 }), Object.defineProperty(n, "INVERT", { get: function() { return n._INVERT }, enumerable: !0, configurable: !0 }), Object.defineProperty(n, "INCR_WRAP", { get: function() { return n._INCR_WRAP }, enumerable: !0, configurable: !0 }), Object.defineProperty(n, "DECR_WRAP", { get: function() { return n._DECR_WRAP }, enumerable: !0, configurable: !0 }), Object.defineProperty(n, "ALPHA_DISABLE", { get: function() { return n._ALPHA_DISABLE }, enumerable: !0, configurable: !0 }), Object.defineProperty(n, "ALPHA_ONEONE", { get: function() { return n._ALPHA_ONEONE }, enumerable: !0, configurable: !0 }), Object.defineProperty(n, "ALPHA_ADD", { get: function() { return n._ALPHA_ADD }, enumerable: !0, configurable: !0 }), Object.defineProperty(n, "ALPHA_COMBINE", { get: function() { return n._ALPHA_COMBINE }, enumerable: !0, configurable: !0 }), Object.defineProperty(n, "ALPHA_SUBTRACT", { get: function() { return n._ALPHA_SUBTRACT }, enumerable: !0, configurable: !0 }), Object.defineProperty(n, "ALPHA_MULTIPLY", { get: function() { return n._ALPHA_MULTIPLY }, enumerable: !0, configurable: !0 }), Object.defineProperty(n, "ALPHA_MAXIMIZED", { get: function() { return n._ALPHA_MAXIMIZED }, enumerable: !0, configurable: !0 }), Object.defineProperty(n, "ALPHA_PREMULTIPLIED", { get: function() { return n._ALPHA_PREMULTIPLIED }, enumerable: !0, configurable: !0 }), Object.defineProperty(n, "DELAYLOADSTATE_NONE", { get: function() { return n._DELAYLOADSTATE_NONE }, enumerable: !0, configurable: !0 }), Object.defineProperty(n, "DELAYLOADSTATE_LOADED", { get: function() { return n._DELAYLOADSTATE_LOADED }, enumerable: !0, configurable: !0 }), Object.defineProperty(n, "DELAYLOADSTATE_LOADING", { get: function() { return n._DELAYLOADSTATE_LOADING }, enumerable: !0, configurable: !0 }), Object.defineProperty(n, "DELAYLOADSTATE_NOTLOADED", { get: function() { return n._DELAYLOADSTATE_NOTLOADED }, enumerable: !0, configurable: !0 }), Object.defineProperty(n, "TEXTUREFORMAT_ALPHA", { get: function() { return n._TEXTUREFORMAT_ALPHA }, enumerable: !0, configurable: !0 }), Object.defineProperty(n, "TEXTUREFORMAT_LUMINANCE", { get: function() { return n._TEXTUREFORMAT_LUMINANCE }, enumerable: !0, configurable: !0 }), Object.defineProperty(n, "TEXTUREFORMAT_LUMINANCE_ALPHA", { get: function() { return n._TEXTUREFORMAT_LUMINANCE_ALPHA }, enumerable: !0, configurable: !0 }), Object.defineProperty(n, "TEXTUREFORMAT_RGB", { get: function() { return n._TEXTUREFORMAT_RGB }, enumerable: !0, configurable: !0 }), Object.defineProperty(n, "TEXTUREFORMAT_RGBA", { get: function() { return n._TEXTUREFORMAT_RGBA }, enumerable: !0, configurable: !0 }), Object.defineProperty(n, "TEXTURETYPE_UNSIGNED_INT", { get: function() { return n._TEXTURETYPE_UNSIGNED_INT }, enumerable: !0, configurable: !0 }), Object.defineProperty(n, "TEXTURETYPE_FLOAT", { get: function() { return n._TEXTURETYPE_FLOAT }, enumerable: !0, configurable: !0 }), Object.defineProperty(n, "TEXTURETYPE_HALF_FLOAT", { get: function() { return n._TEXTURETYPE_HALF_FLOAT }, enumerable: !0, configurable: !0 }), Object.defineProperty(n, "Version", { get: function() { return "3.0-alpha" }, enumerable: !0, configurable: !0 }), Object.defineProperty(n.prototype, "texturesSupported", { get: function() { return this._texturesSupported }, enumerable: !0, configurable: !0 }), Object.defineProperty(n.prototype, "textureFormatInUse", { get: function() { return this._textureFormatInUse }, enumerable: !0, configurable: !0 }), Object.defineProperty(n.prototype, "webGLVersion", { get: function() { return this._webGLVersion }, enumerable: !0, configurable: !0 }), Object.defineProperty(n.prototype, "isStencilEnable", { get: function() { return this._isStencilEnable }, enumerable: !0, configurable: !0 }), n.prototype._prepareWorkingCanvas = function() { this._workingCanvas || (this._workingCanvas = document.createElement("canvas"), this._workingContext = this._workingCanvas.getContext("2d")) }, n.prototype.resetTextureCache = function() { for (var e = 0; e < this._maxTextureChannels; e++) this._activeTexturesCache[e] = null }, n.prototype.getGlInfo = function() { return { vendor: this._glVendor, renderer: this._glRenderer, version: this._glVersion } }, n.prototype.getAspectRatio = function(e, t) { void 0 === t && (t = !1); var i = e.viewport; return this.getRenderWidth(t) * i.width / (this.getRenderHeight(t) * i.height) }, n.prototype.getRenderWidth = function(e) { return void 0 === e && (e = !1), !e && this._currentRenderTarget ? this._currentRenderTarget._width : this._renderingCanvas.width }, n.prototype.getRenderHeight = function(e) { return void 0 === e && (e = !1), !e && this._currentRenderTarget ? this._currentRenderTarget._height : this._renderingCanvas.height }, n.prototype.getRenderingCanvas = function() { return this._renderingCanvas }, n.prototype.getRenderingCanvasClientRect = function() { return this._renderingCanvas.getBoundingClientRect() }, n.prototype.setHardwareScalingLevel = function(e) { this._hardwareScalingLevel = e, this.resize() }, n.prototype.getHardwareScalingLevel = function() { return this._hardwareScalingLevel }, n.prototype.getLoadedTexturesCache = function() { return this._loadedTexturesCache }, n.prototype.getCaps = function() { return this._caps }, Object.defineProperty(n.prototype, "drawCalls", { get: function() { return this._drawCalls.current }, enumerable: !0, configurable: !0 }), Object.defineProperty(n.prototype, "drawCallsPerfCounter", { get: function() { return this._drawCalls }, enumerable: !0, configurable: !0 }), n.prototype.getDepthFunction = function() { return this._depthCullingState.depthFunc }, n.prototype.setDepthFunction = function(e) { this._depthCullingState.depthFunc = e }, n.prototype.setDepthFunctionToGreater = function() { this._depthCullingState.depthFunc = this._gl.GREATER }, n.prototype.setDepthFunctionToGreaterOrEqual = function() { this._depthCullingState.depthFunc = this._gl.GEQUAL }, n.prototype.setDepthFunctionToLess = function() { this._depthCullingState.depthFunc = this._gl.LESS }, n.prototype.setDepthFunctionToLessOrEqual = function() { this._depthCullingState.depthFunc = this._gl.LEQUAL }, n.prototype.getStencilBuffer = function() { return this._stencilState.stencilTest }, n.prototype.setStencilBuffer = function(e) { this._stencilState.stencilTest = e }, n.prototype.getStencilMask = function() { return this._stencilState.stencilMask }, n.prototype.setStencilMask = function(e) { this._stencilState.stencilMask = e }, n.prototype.getStencilFunction = function() { return this._stencilState.stencilFunc }, n.prototype.getStencilFunctionReference = function() { return this._stencilState.stencilFuncRef }, n.prototype.getStencilFunctionMask = function() { return this._stencilState.stencilFuncMask }, n.prototype.setStencilFunction = function(e) { this._stencilState.stencilFunc = e }, n.prototype.setStencilFunctionReference = function(e) { this._stencilState.stencilFuncRef = e }, n.prototype.setStencilFunctionMask = function(e) { this._stencilState.stencilFuncMask = e }, n.prototype.getStencilOperationFail = function() { return this._stencilState.stencilOpStencilFail }, n.prototype.getStencilOperationDepthFail = function() { return this._stencilState.stencilOpDepthFail }, n.prototype.getStencilOperationPass = function() { return this._stencilState.stencilOpStencilDepthPass }, n.prototype.setStencilOperationFail = function(e) { this._stencilState.stencilOpStencilFail = e }, n.prototype.setStencilOperationDepthFail = function(e) { this._stencilState.stencilOpDepthFail = e }, n.prototype.setStencilOperationPass = function(e) { this._stencilState.stencilOpStencilDepthPass = e }, n.prototype.stopRenderLoop = function(e) { if (!e) return void(this._activeRenderLoops = []); var t = this._activeRenderLoops.indexOf(e);
            t >= 0 && this._activeRenderLoops.splice(t, 1) }, n.prototype._renderLoop = function() { var t = !0; if (!this.renderEvenInBackground && this._windowIsBackground && (t = !1), t) { this.beginFrame(); for (var i = 0; i < this._activeRenderLoops.length; i++) {
                    (0, this._activeRenderLoops[i])() }
                this.endFrame() }
            this._activeRenderLoops.length > 0 ? e.Tools.QueueNewFrame(this._bindedRenderFunction, this._vrDisplayEnabled) : this._renderingQueueLaunched = !1 }, n.prototype.runRenderLoop = function(t) { this._activeRenderLoops.indexOf(t) === -1 && (this._activeRenderLoops.push(t), this._renderingQueueLaunched || (this._renderingQueueLaunched = !0, this._bindedRenderFunction = this._renderLoop.bind(this), e.Tools.QueueNewFrame(this._bindedRenderFunction))) }, n.prototype.switchFullscreen = function(t) { this.isFullscreen ? e.Tools.ExitFullscreen() : (this._pointerLockRequested = t, e.Tools.RequestFullscreen(this._renderingCanvas)) }, n.prototype.clear = function(e, t, i, r) { void 0 === r && (r = !1), this.applyStates(); var n = 0;
            t && e && (this._gl.clearColor(e.r, e.g, e.b, void 0 !== e.a ? e.a : 1), n |= this._gl.COLOR_BUFFER_BIT), i && (this._gl.clearDepth(1), n |= this._gl.DEPTH_BUFFER_BIT), r && (this._gl.clearStencil(0), n |= this._gl.STENCIL_BUFFER_BIT), this._gl.clear(n) }, n.prototype.scissorClear = function(e, t, i, r, n) { var o = this._gl,
                s = o.getParameter(o.SCISSOR_TEST),
                a = o.getParameter(o.SCISSOR_BOX);
            o.enable(o.SCISSOR_TEST), o.scissor(e, t, i, r), this.clear(n, !0, !0, !0), o.scissor(a[0], a[1], a[2], a[3]), s === !0 ? o.enable(o.SCISSOR_TEST) : o.disable(o.SCISSOR_TEST) }, n.prototype.setViewport = function(e, t, i) { var r = t || (navigator.isCocoonJS ? window.innerWidth : this.getRenderWidth()),
                n = i || (navigator.isCocoonJS ? window.innerHeight : this.getRenderHeight()),
                o = e.x || 0,
                s = e.y || 0;
            this._cachedViewport = e, this._gl.viewport(o * r, s * n, r * e.width, n * e.height) }, n.prototype.setDirectViewport = function(e, t, i, r) { var n = this._cachedViewport; return this._cachedViewport = null, this._gl.viewport(e, t, i, r), n }, n.prototype.beginFrame = function() { this._measureFps() }, n.prototype.endFrame = function() { this._badOS && this.flushFramebuffer(), this._vrDisplayEnabled && this._vrDisplayEnabled.isPresenting && this._vrDisplayEnabled.submitFrame() }, n.prototype.resize = function() { if (!this._vrDisplayEnabled || !this._vrDisplayEnabled.isPresenting) { var e = navigator.isCocoonJS ? window.innerWidth : this._renderingCanvas.clientWidth,
                    t = navigator.isCocoonJS ? window.innerHeight : this._renderingCanvas.clientHeight;
                this.setSize(e / this._hardwareScalingLevel, t / this._hardwareScalingLevel) } }, n.prototype.setSize = function(e, t) { this._renderingCanvas.width = e, this._renderingCanvas.height = t; for (var i = 0; i < this.scenes.length; i++)
                for (var r = this.scenes[i], n = 0; n < r.cameras.length; n++) { var o = r.cameras[n];
                    o._currentRenderId = 0 } }, n.prototype.initWebVR = function() { this.vrDisplaysPromise || this._getVRDisplays() }, n.prototype.enableVR = function(e) { this._vrDisplayEnabled = e, this._vrDisplayEnabled.requestPresent([{ source: this.getRenderingCanvas() }]).then(this._onVRFullScreenTriggered) }, n.prototype.disableVR = function() { this._vrDisplayEnabled && this._vrDisplayEnabled.exitPresent().then(this._onVRFullScreenTriggered) }, n.prototype._getVRDisplays = function() { var e = this,
                t = function(t) { t.length; return e._vrDisplays = t.filter((function(e) { return t[0] instanceof VRDisplay })), e._vrDisplays };
            navigator.getVRDisplays && (this.vrDisplaysPromise = navigator.getVRDisplays().then(t)) }, n.prototype.bindFramebuffer = function(e, t, i, r) { this._currentRenderTarget = e, this.bindUnboundFramebuffer(e._MSAAFramebuffer ? e._MSAAFramebuffer : e._framebuffer); var n = this._gl;
            e.isCube && n.framebufferTexture2D(n.FRAMEBUFFER, n.COLOR_ATTACHMENT0, n.TEXTURE_CUBE_MAP_POSITIVE_X + t, e, 0), n.viewport(0, 0, i || e._width, r || e._height), this.wipeCaches() }, n.prototype.bindUnboundFramebuffer = function(e) { this._currentFramebuffer !== e && (this._gl.bindFramebuffer(this._gl.FRAMEBUFFER, e), this._currentFramebuffer = e) }, n.prototype.unBindFramebuffer = function(e, t, i) { void 0 === t && (t = !1), this._currentRenderTarget = null; var r = this._gl;
            e._MSAAFramebuffer && (r.bindFramebuffer(r.READ_FRAMEBUFFER, e._MSAAFramebuffer), r.bindFramebuffer(r.DRAW_FRAMEBUFFER, e._framebuffer), r.blitFramebuffer(0, 0, e._width, e._height, 0, 0, e._width, e._height, r.COLOR_BUFFER_BIT, r.NEAREST)), e.generateMipMaps && !t && (this._bindTextureDirectly(r.TEXTURE_2D, e), r.generateMipmap(r.TEXTURE_2D), this._bindTextureDirectly(r.TEXTURE_2D, null)), i && (e._MSAAFramebuffer && this.bindUnboundFramebuffer(e._framebuffer), i()), this.bindUnboundFramebuffer(null) }, n.prototype.generateMipMapsForCubemap = function(e) { if (e.generateMipMaps) { var t = this._gl;
                this._bindTextureDirectly(t.TEXTURE_CUBE_MAP, e), t.generateMipmap(t.TEXTURE_CUBE_MAP), this._bindTextureDirectly(t.TEXTURE_CUBE_MAP, null) } }, n.prototype.flushFramebuffer = function() { this._gl.flush() }, n.prototype.restoreDefaultFramebuffer = function() { this._currentRenderTarget = null, this.bindUnboundFramebuffer(null), this.setViewport(this._cachedViewport), this.wipeCaches() }, n.prototype._resetVertexBufferBinding = function() { this.bindArrayBuffer(null), this._cachedVertexBuffers = null }, n.prototype.createVertexBuffer = function(e) { var t = this._gl.createBuffer(); return this.bindArrayBuffer(t), e instanceof Float32Array ? this._gl.bufferData(this._gl.ARRAY_BUFFER, e, this._gl.STATIC_DRAW) : this._gl.bufferData(this._gl.ARRAY_BUFFER, new Float32Array(e), this._gl.STATIC_DRAW), this._resetVertexBufferBinding(), t.references = 1, t }, n.prototype.createDynamicVertexBuffer = function(e) { var t = this._gl.createBuffer(); return this.bindArrayBuffer(t), e instanceof Float32Array ? this._gl.bufferData(this._gl.ARRAY_BUFFER, e, this._gl.DYNAMIC_DRAW) : this._gl.bufferData(this._gl.ARRAY_BUFFER, new Float32Array(e), this._gl.DYNAMIC_DRAW), this._resetVertexBufferBinding(), t.references = 1, t }, n.prototype.updateDynamicVertexBuffer = function(e, t, i, r) { this.bindArrayBuffer(e), void 0 === i && (i = 0), void 0 === r ? t instanceof Float32Array ? this._gl.bufferSubData(this._gl.ARRAY_BUFFER, i, t) : this._gl.bufferSubData(this._gl.ARRAY_BUFFER, i, new Float32Array(t)) : t instanceof Float32Array ? this._gl.bufferSubData(this._gl.ARRAY_BUFFER, 0, t.subarray(i, i + r)) : this._gl.bufferSubData(this._gl.ARRAY_BUFFER, 0, new Float32Array(t).subarray(i, i + r)), this._resetVertexBufferBinding() }, n.prototype._resetIndexBufferBinding = function() { this.bindIndexBuffer(null), this._cachedIndexBuffer = null }, n.prototype.createIndexBuffer = function(e) { var t = this._gl.createBuffer();
            this.bindIndexBuffer(t); var i, r = !1; if (e instanceof Uint16Array) i = e;
            else if (this._caps.uintIndices)
                if (e instanceof Uint32Array) i = e, r = !0;
                else { for (var n = 0; n < e.length; n++)
                        if (e[n] > 65535) { r = !0; break }
                    i = r ? new Uint32Array(e) : new Uint16Array(e) }
            else i = new Uint16Array(e); return this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER, i, this._gl.STATIC_DRAW), this._resetIndexBufferBinding(), t.references = 1, t.is32Bits = r, t }, n.prototype.bindArrayBuffer = function(e) { this._vaoRecordInProgress || this._unBindVertexArrayObject(), this.bindBuffer(e, this._gl.ARRAY_BUFFER) }, n.prototype.bindIndexBuffer = function(e) { this._vaoRecordInProgress || this._unBindVertexArrayObject(), this.bindBuffer(e, this._gl.ELEMENT_ARRAY_BUFFER) }, n.prototype.bindBuffer = function(e, t) {
            (this._vaoRecordInProgress || this._currentBoundBuffer[t] !== e) && (this._gl.bindBuffer(t, e), this._currentBoundBuffer[t] = e) }, n.prototype.updateArrayBuffer = function(e) { this._gl.bufferSubData(this._gl.ARRAY_BUFFER, 0, e) }, n.prototype.vertexAttribPointer = function(e, t, i, r, n, o, s) { var a = this._currentBufferPointers[t],
                h = !1;
            a ? (a.buffer !== e && (a.buffer = e, h = !0), a.size !== i && (a.size = i, h = !0), a.type !== r && (a.type = r, h = !0), a.normalized !== n && (a.normalized = n, h = !0), a.stride !== o && (a.stride = o, h = !0), a.offset !== s && (a.offset = s, h = !0)) : (h = !0, this._currentBufferPointers[t] = { indx: t, size: i, type: r, normalized: n, stride: o, offset: s, buffer: e }), (h || this._vaoRecordInProgress) && (this.bindArrayBuffer(e), this._gl.vertexAttribPointer(t, i, r, n, o, s)) }, n.prototype._bindIndexBufferWithCache = function(e) { null != e && this._cachedIndexBuffer !== e && (this._cachedIndexBuffer = e, this.bindIndexBuffer(e), this._uintIndicesCurrentlySet = e.is32Bits) }, n.prototype._bindVertexBuffersAttributes = function(e, t) { var i = t.getAttributesNames();
            this._vaoRecordInProgress || this._unBindVertexArrayObject(), this.unbindAllAttributes(); for (var r = 0; r < i.length; r++) { var n = t.getAttributeLocation(r); if (n >= 0) { var o = e[i[r]]; if (!o) continue;
                    this._gl.enableVertexAttribArray(n), this._vaoRecordInProgress || (this._vertexAttribArraysEnabled[n] = !0); var s = o.getBuffer();
                    this.vertexAttribPointer(s, n, o.getSize(), this._gl.FLOAT, !1, 4 * o.getStrideSize(), 4 * o.getOffset()), o.getIsInstanced() && (this._gl.vertexAttribDivisor(n, 1), this._vaoRecordInProgress || (this._currentInstanceLocations.push(n), this._currentInstanceBuffers.push(s))) } } }, n.prototype.recordVertexArrayObject = function(e, t, i) { var r = this._gl.createVertexArray(); return this._vaoRecordInProgress = !0, this._gl.bindVertexArray(r), this._mustWipeVertexAttributes = !0, this._bindVertexBuffersAttributes(e, i), this.bindIndexBuffer(t), this._vaoRecordInProgress = !1, this._gl.bindVertexArray(null), r }, n.prototype.bindVertexArrayObject = function(e, t) { this._cachedVertexArrayObject !== e && (this._cachedVertexArrayObject = e, this._gl.bindVertexArray(e), this._cachedVertexBuffers = null, this._cachedIndexBuffer = null, this._uintIndicesCurrentlySet = null != t && t.is32Bits, this._mustWipeVertexAttributes = !0) }, n.prototype.bindBuffersDirectly = function(e, t, i, r, n) { if (this._cachedVertexBuffers !== e || this._cachedEffectForVertexBuffers !== n) { this._cachedVertexBuffers = e, this._cachedEffectForVertexBuffers = n; var o = n.getAttributesCount();
                this._unBindVertexArrayObject(), this.unbindAllAttributes(); for (var s = 0, a = 0; a < o; a++)
                    if (a < i.length) { var h = n.getAttributeLocation(a);
                        h >= 0 && (this._gl.enableVertexAttribArray(h), this._vertexAttribArraysEnabled[h] = !0, this.vertexAttribPointer(e, h, i[a], this._gl.FLOAT, !1, r, s)), s += 4 * i[a] } }
            this._bindIndexBufferWithCache(t) }, n.prototype._unBindVertexArrayObject = function() { this._cachedVertexArrayObject && (this._cachedVertexArrayObject = null, this._gl.bindVertexArray(null)) }, n.prototype.bindBuffers = function(e, t, i) { this._cachedVertexBuffers === e && this._cachedEffectForVertexBuffers === i || (this._cachedVertexBuffers = e, this._cachedEffectForVertexBuffers = i, this._bindVertexBuffersAttributes(e, i)), this._bindIndexBufferWithCache(t) }, n.prototype.unbindInstanceAttributes = function() { for (var e, t = 0, i = this._currentInstanceLocations.length; t < i; t++) { var r = this._currentInstanceBuffers[t];
                e != r && (e = r, this.bindArrayBuffer(r)); var n = this._currentInstanceLocations[t];
                this._gl.vertexAttribDivisor(n, 0) }
            this._currentInstanceBuffers.length = 0, this._currentInstanceLocations.length = 0 }, n.prototype.releaseVertexArrayObject = function(e) { this._gl.deleteVertexArray(e) }, n.prototype._releaseBuffer = function(e) { return 0 === --e.references && (this._gl.deleteBuffer(e), !0) }, n.prototype.createInstancesBuffer = function(e) { var t = this._gl.createBuffer(); return t.capacity = e, this.bindArrayBuffer(t), this._gl.bufferData(this._gl.ARRAY_BUFFER, e, this._gl.DYNAMIC_DRAW), t }, n.prototype.deleteInstancesBuffer = function(e) { this._gl.deleteBuffer(e) }, n.prototype.updateAndBindInstancesBuffer = function(e, t, i) { if (this.bindArrayBuffer(e), t && this._gl.bufferSubData(this._gl.ARRAY_BUFFER, 0, t), void 0 !== i[0].index) { for (var r = 0, n = 0; n < i.length; n++) { var o = i[n];
                    r += 4 * o.attributeSize } for (var n = 0; n < i.length; n++) { var o = i[n];
                    this._vertexAttribArraysEnabled[o.index] || (this._gl.enableVertexAttribArray(o.index), this._vertexAttribArraysEnabled[o.index] = !0), this.vertexAttribPointer(e, o.index, o.attributeSize, o.attribyteType || this._gl.FLOAT, o.normalized || !1, r, o.offset), this._gl.vertexAttribDivisor(o.index, 1), this._currentInstanceLocations.push(o.index), this._currentInstanceBuffers.push(e) } } else
                for (var s = 0; s < 4; s++) { var a = i[s];
                    this._vertexAttribArraysEnabled[a] || (this._gl.enableVertexAttribArray(a), this._vertexAttribArraysEnabled[a] = !0), this.vertexAttribPointer(e, a, 4, this._gl.FLOAT, !1, 64, 16 * s), this._gl.vertexAttribDivisor(a, 1), this._currentInstanceLocations.push(a), this._currentInstanceBuffers.push(e) } }, n.prototype.applyStates = function() { this._depthCullingState.apply(this._gl), this._stencilState.apply(this._gl), this._alphaState.apply(this._gl) }, n.prototype.draw = function(e, t, i, r) { this.applyStates(), this._drawCalls.addCount(1, !1); var n = this._uintIndicesCurrentlySet ? this._gl.UNSIGNED_INT : this._gl.UNSIGNED_SHORT,
                o = this._uintIndicesCurrentlySet ? 4 : 2; if (r) return void this._gl.drawElementsInstanced(e ? this._gl.TRIANGLES : this._gl.LINES, i, n, t * o, r);
            this._gl.drawElements(e ? this._gl.TRIANGLES : this._gl.LINES, i, n, t * o) }, n.prototype.drawPointClouds = function(e, t, i) { if (this.applyStates(), this._drawCalls.addCount(1, !1), i) return void this._gl.drawArraysInstanced(this._gl.POINTS, e, t, i);
            this._gl.drawArrays(this._gl.POINTS, e, t) }, n.prototype.drawUnIndexed = function(e, t, i, r) { if (this.applyStates(), this._drawCalls.addCount(1, !1), r) return void this._gl.drawArraysInstanced(e ? this._gl.TRIANGLES : this._gl.LINES, t, i, r);
            this._gl.drawArrays(e ? this._gl.TRIANGLES : this._gl.LINES, t, i) }, n.prototype._releaseEffect = function(e) { this._compiledEffects[e._key] && (delete this._compiledEffects[e._key], e.getProgram() && this._gl.deleteProgram(e.getProgram())) }, n.prototype.createEffect = function(t, i, r, n, o, s, a, h, l) { var c = t.vertexElement || t.vertex || t,
                u = t.fragmentElement || t.fragment || t,
                d = c + "+" + u + "@" + (o || i.defines); if (this._compiledEffects[d]) return this._compiledEffects[d]; var f = new e.Effect(t, i, r, n, this, o, s, a, h, l); return f._key = d, this._compiledEffects[d] = f, f }, n.prototype.createEffectForParticles = function(e, t, i, r, n, o, s) { return void 0 === t && (t = []), void 0 === i && (i = []), void 0 === r && (r = ""), this.createEffect({ vertex: "particles", fragmentElement: e }, ["position", "color", "options"], ["view", "projection"].concat(t), ["diffuseSampler"].concat(i), r, n, o, s) }, n.prototype.createShaderProgram = function(e, i, r, n) { n = n || this._gl; var o = this._webGLVersion > 1 ? "#version 300 es\n" : "",
                s = t(n, e, "vertex", r, o),
                a = t(n, i, "fragment", r, o),
                h = n.createProgram(); if (n.attachShader(h, s), n.attachShader(h, a), n.linkProgram(h), !n.getProgramParameter(h, n.LINK_STATUS)) { var l = n.getProgramInfoLog(h); if (l) throw new Error(l) } return n.deleteShader(s), n.deleteShader(a), h }, n.prototype.getUniforms = function(e, t) { for (var i = [], r = 0; r < t.length; r++) i.push(this._gl.getUniformLocation(e, t[r])); return i }, n.prototype.getAttributes = function(e, t) { for (var i = [], r = 0; r < t.length; r++) try { i.push(this._gl.getAttribLocation(e, t[r])) } catch (e) { i.push(-1) }
            return i }, n.prototype.enableEffect = function(e) { this.setProgram(e.getProgram()), this._currentEffect = e, e.onBind && e.onBind(e) }, n.prototype.setIntArray = function(e, t) { e && this._gl.uniform1iv(e, t) }, n.prototype.setIntArray2 = function(e, t) { e && t.length % 2 == 0 && this._gl.uniform2iv(e, t) }, n.prototype.setIntArray3 = function(e, t) {
            e && t.length % 3 == 0 && this._gl.uniform3iv(e, t)
        }, n.prototype.setIntArray4 = function(e, t) { e && t.length % 4 == 0 && this._gl.uniform4iv(e, t) }, n.prototype.setFloatArray = function(e, t) { e && this._gl.uniform1fv(e, t) }, n.prototype.setFloatArray2 = function(e, t) { e && t.length % 2 == 0 && this._gl.uniform2fv(e, t) }, n.prototype.setFloatArray3 = function(e, t) { e && t.length % 3 == 0 && this._gl.uniform3fv(e, t) }, n.prototype.setFloatArray4 = function(e, t) { e && t.length % 4 == 0 && this._gl.uniform4fv(e, t) }, n.prototype.setArray = function(e, t) { e && this._gl.uniform1fv(e, t) }, n.prototype.setArray2 = function(e, t) { e && t.length % 2 == 0 && this._gl.uniform2fv(e, t) }, n.prototype.setArray3 = function(e, t) { e && t.length % 3 == 0 && this._gl.uniform3fv(e, t) }, n.prototype.setArray4 = function(e, t) { e && t.length % 4 == 0 && this._gl.uniform4fv(e, t) }, n.prototype.setMatrices = function(e, t) { e && this._gl.uniformMatrix4fv(e, !1, t) }, n.prototype.setMatrix = function(e, t) { e && this._gl.uniformMatrix4fv(e, !1, t.toArray()) }, n.prototype.setMatrix3x3 = function(e, t) { e && this._gl.uniformMatrix3fv(e, !1, t) }, n.prototype.setMatrix2x2 = function(e, t) { e && this._gl.uniformMatrix2fv(e, !1, t) }, n.prototype.setFloat = function(e, t) { e && this._gl.uniform1f(e, t) }, n.prototype.setFloat2 = function(e, t, i) { e && this._gl.uniform2f(e, t, i) }, n.prototype.setFloat3 = function(e, t, i, r) { e && this._gl.uniform3f(e, t, i, r) }, n.prototype.setBool = function(e, t) { e && this._gl.uniform1i(e, t) }, n.prototype.setFloat4 = function(e, t, i, r, n) { e && this._gl.uniform4f(e, t, i, r, n) }, n.prototype.setColor3 = function(e, t) { e && this._gl.uniform3f(e, t.r, t.g, t.b) }, n.prototype.setColor4 = function(e, t, i) { e && this._gl.uniform4f(e, t.r, t.g, t.b, i) }, n.prototype.setState = function(e, t, i, r) { void 0 === t && (t = 0), void 0 === r && (r = !1); var n = r ? this._gl.FRONT : this._gl.BACK,
                o = r ? this._gl.BACK : this._gl.FRONT,
                s = this.cullBackFaces ? n : o;
            (this._depthCullingState.cull !== e || i || this._depthCullingState.cullFace !== s) && (e ? (this._depthCullingState.cullFace = s, this._depthCullingState.cull = !0) : this._depthCullingState.cull = !1), this._depthCullingState.zOffset = t }, n.prototype.setDepthBuffer = function(e) { this._depthCullingState.depthTest = e }, n.prototype.getDepthWrite = function() { return this._depthCullingState.depthMask }, n.prototype.setDepthWrite = function(e) { this._depthCullingState.depthMask = e }, n.prototype.setColorWrite = function(e) { this._gl.colorMask(e, e, e, e) }, n.prototype.setAlphaMode = function(e, t) { if (void 0 === t && (t = !1), this._alphaMode !== e) { switch (e) {
                    case n.ALPHA_DISABLE:
                        this._alphaState.alphaBlend = !1; break;
                    case n.ALPHA_PREMULTIPLIED:
                        this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE, this._gl.ONE_MINUS_SRC_ALPHA, this._gl.ONE, this._gl.ONE), this._alphaState.alphaBlend = !0; break;
                    case n.ALPHA_COMBINE:
                        this._alphaState.setAlphaBlendFunctionParameters(this._gl.SRC_ALPHA, this._gl.ONE_MINUS_SRC_ALPHA, this._gl.ONE, this._gl.ONE), this._alphaState.alphaBlend = !0; break;
                    case n.ALPHA_ONEONE:
                        this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE, this._gl.ONE, this._gl.ZERO, this._gl.ONE), this._alphaState.alphaBlend = !0; break;
                    case n.ALPHA_ADD:
                        this._alphaState.setAlphaBlendFunctionParameters(this._gl.SRC_ALPHA, this._gl.ONE, this._gl.ZERO, this._gl.ONE), this._alphaState.alphaBlend = !0; break;
                    case n.ALPHA_SUBTRACT:
                        this._alphaState.setAlphaBlendFunctionParameters(this._gl.ZERO, this._gl.ONE_MINUS_SRC_COLOR, this._gl.ONE, this._gl.ONE), this._alphaState.alphaBlend = !0; break;
                    case n.ALPHA_MULTIPLY:
                        this._alphaState.setAlphaBlendFunctionParameters(this._gl.DST_COLOR, this._gl.ZERO, this._gl.ONE, this._gl.ONE), this._alphaState.alphaBlend = !0; break;
                    case n.ALPHA_MAXIMIZED:
                        this._alphaState.setAlphaBlendFunctionParameters(this._gl.SRC_ALPHA, this._gl.ONE_MINUS_SRC_COLOR, this._gl.ONE, this._gl.ONE), this._alphaState.alphaBlend = !0 }
                t || this.setDepthWrite(e === n.ALPHA_DISABLE), this._alphaMode = e } }, n.prototype.getAlphaMode = function() { return this._alphaMode }, n.prototype.setAlphaTesting = function(e) { this._alphaTest = e }, n.prototype.getAlphaTesting = function() { return !!this._alphaTest }, n.prototype.wipeCaches = function() { this.preventCacheWipeBetweenFrames || (this.resetTextureCache(), this._currentEffect = null, this._stencilState.reset(), this._depthCullingState.reset(), this.setDepthFunctionToLessOrEqual(), this._alphaState.reset(), this._cachedVertexBuffers = null, this._cachedIndexBuffer = null, this._cachedEffectForVertexBuffers = null, this._unBindVertexArrayObject(), this.bindIndexBuffer(null), this.bindArrayBuffer(null)) }, n.prototype.setTextureFormatToUse = function(e) { for (var t = 0, i = this.texturesSupported.length; t < i; t++)
                for (var r = 0, n = e.length; r < n; r++)
                    if (this._texturesSupported[t] === e[r].toLowerCase()) return this._textureFormatInUse = this._texturesSupported[t];
            return this._textureFormatInUse = null }, n.prototype.createTexture = function(t, i, n, o, s, a, h, l, c, u) { var d = this;
            void 0 === s && (s = e.Texture.TRILINEAR_SAMPLINGMODE), void 0 === a && (a = null), void 0 === h && (h = null), void 0 === l && (l = null); var f = c || this._gl.createTexture(),
                p = String(t),
                _ = "data:" === p.substr(0, 5),
                m = _ && p.indexOf("base64") !== -1,
                g = p.lastIndexOf("."),
                v = g > 0 ? p.substring(g).toLowerCase() : "",
                y = this.getCaps().s3tc && ".dds" === v;
            y && e.Tools.Warn("DDS files deprecated since 3.0, use KTX files"); var x = ".tga" === v,
                b = !1;!this._textureFormatInUse || m || c || (p = p.substring(0, g) + this._textureFormatInUse, b = !0), o._addPendingData(f), f.url = p, f.noMipmap = i, f.references = 1, f.samplingMode = s, f.onLoadedCallbacks = [], a && f.onLoadedCallbacks.push(a), c || this._loadedTexturesCache.push(f); var A, E = function() { o._removePendingData(f), b ? d.createTexture(t, i, n, o, s, null, h, l, f) : h && h() }; if (b || x || y) b ? A = function(t) { var a = new e.Internals.KhronosTextureContainer(t, 1);
                r(f, d._gl, o, a.pixelWidth, a.pixelHeight, n, !1, !0, (function() { a.uploadLevels(d._gl, !i) }), s) } : x ? A = function(t) { var a = new Uint8Array(t),
                    h = e.Internals.TGATools.GetTGAHeader(a);
                r(f, d._gl, o, h.width, h.height, n, i, !1, (function() { e.Internals.TGATools.UploadContent(d._gl, a) }), s) } : y && (A = function(t) { var a = e.Internals.DDSTools.GetDDSInfo(t),
                    h = (a.isRGB || a.isLuminance || a.mipmapCount > 1) && !i && a.width >> a.mipmapCount - 1 == 1;
                r(f, d._gl, o, a.width, a.height, n, !h, a.isFourCC, (function() { e.Internals.DDSTools.UploadDDSLevels(d._gl, d.getCaps().s3tc, t, a, h, 1) }), s) }), l ? A(l) : e.Tools.LoadFile(p, (function(e) { A(e) }), null, o.database, !0, E);
            else { var T = function(t) { r(f, d._gl, o, t.width, t.height, n, i, !1, (function(i, r) { var n = t.width === i && t.height === r;
                        n || (d._prepareWorkingCanvas(), d._workingCanvas.width = i, d._workingCanvas.height = r, s === e.Texture.NEAREST_SAMPLINGMODE && (d._workingContext.imageSmoothingEnabled = !1, d._workingContext.mozImageSmoothingEnabled = !1, d._workingContext.oImageSmoothingEnabled = !1, d._workingContext.webkitImageSmoothingEnabled = !1, d._workingContext.msImageSmoothingEnabled = !1), d._workingContext.drawImage(t, 0, 0, t.width, t.height, 0, 0, i, r), s === e.Texture.NEAREST_SAMPLINGMODE && (d._workingContext.imageSmoothingEnabled = !0, d._workingContext.mozImageSmoothingEnabled = !0, d._workingContext.oImageSmoothingEnabled = !0, d._workingContext.webkitImageSmoothingEnabled = !0, d._workingContext.msImageSmoothingEnabled = !0)); var o = u ? d._getInternalFormat(u) : ".jpg" === v ? d._gl.RGB : d._gl.RGBA;
                        d._gl.texImage2D(d._gl.TEXTURE_2D, 0, o, o, d._gl.UNSIGNED_BYTE, n ? t : d._workingCanvas) }), s) };!_ || m ? e.Tools.LoadImage(p, T, E, o.database) : l instanceof Array || "string" == typeof l ? e.Tools.LoadImage(l, T, E, o.database) : T(l) } return f }, n.prototype._getInternalFormat = function(e) { var t = this._gl.RGBA; switch (e) {
                case n.TEXTUREFORMAT_ALPHA:
                    t = this._gl.ALPHA; break;
                case n.TEXTUREFORMAT_LUMINANCE:
                    t = this._gl.LUMINANCE; break;
                case n.TEXTUREFORMAT_LUMINANCE_ALPHA:
                    t = this._gl.LUMINANCE_ALPHA; break;
                case n.TEXTUREFORMAT_RGB:
                    t = this._gl.RGB; break;
                case n.TEXTUREFORMAT_RGBA:
                    t = this._gl.RGBA } return t }, n.prototype.updateRawTexture = function(e, t, i, r, n) { void 0 === n && (n = null); var o = this._getInternalFormat(i);
            this._bindTextureDirectly(this._gl.TEXTURE_2D, e), this._gl.pixelStorei(this._gl.UNPACK_FLIP_Y_WEBGL, void 0 === r ? 1 : r ? 1 : 0), e._width % 4 != 0 && this._gl.pixelStorei(this._gl.UNPACK_ALIGNMENT, 1), n ? this._gl.compressedTexImage2D(this._gl.TEXTURE_2D, 0, this.getCaps().s3tc[n], e._width, e._height, 0, t) : this._gl.texImage2D(this._gl.TEXTURE_2D, 0, o, e._width, e._height, 0, o, this._gl.UNSIGNED_BYTE, t), e.generateMipMaps && this._gl.generateMipmap(this._gl.TEXTURE_2D), this._bindTextureDirectly(this._gl.TEXTURE_2D, null), this.resetTextureCache(), e.isReady = !0 }, n.prototype.createRawTexture = function(e, t, r, n, o, s, a, h) { void 0 === h && (h = null); var l = this._gl.createTexture();
            l._baseWidth = t, l._baseHeight = r, l._width = t, l._height = r, l.references = 1, this.updateRawTexture(l, e, n, s, h), this._bindTextureDirectly(this._gl.TEXTURE_2D, l); var c = i(a, o, this._gl); return this._gl.texParameteri(this._gl.TEXTURE_2D, this._gl.TEXTURE_MAG_FILTER, c.mag), this._gl.texParameteri(this._gl.TEXTURE_2D, this._gl.TEXTURE_MIN_FILTER, c.min), o && this._gl.generateMipmap(this._gl.TEXTURE_2D), this._bindTextureDirectly(this._gl.TEXTURE_2D, null), l.samplingMode = a, this._loadedTexturesCache.push(l), l }, n.prototype.createDynamicTexture = function(t, i, r, n) { var o = this._gl.createTexture(); return o._baseWidth = t, o._baseHeight = i, r && (t = e.Tools.GetExponentOfTwo(t, this._caps.maxTextureSize), i = e.Tools.GetExponentOfTwo(i, this._caps.maxTextureSize)), this.resetTextureCache(), o._width = t, o._height = i, o.isReady = !1, o.generateMipMaps = r, o.references = 1, o.samplingMode = n, this.updateTextureSamplingMode(n, o), this._loadedTexturesCache.push(o), o }, n.prototype.updateTextureSamplingMode = function(e, t) { var r = i(e, t.generateMipMaps, this._gl);
            t.isCube ? (this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP, t), this._gl.texParameteri(this._gl.TEXTURE_CUBE_MAP, this._gl.TEXTURE_MAG_FILTER, r.mag), this._gl.texParameteri(this._gl.TEXTURE_CUBE_MAP, this._gl.TEXTURE_MIN_FILTER, r.min), this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP, null)) : (this._bindTextureDirectly(this._gl.TEXTURE_2D, t), this._gl.texParameteri(this._gl.TEXTURE_2D, this._gl.TEXTURE_MAG_FILTER, r.mag), this._gl.texParameteri(this._gl.TEXTURE_2D, this._gl.TEXTURE_MIN_FILTER, r.min), this._bindTextureDirectly(this._gl.TEXTURE_2D, null)), t.samplingMode = e }, n.prototype.updateDynamicTexture = function(e, t, i, r, n) { void 0 === r && (r = !1), this._bindTextureDirectly(this._gl.TEXTURE_2D, e), this._gl.pixelStorei(this._gl.UNPACK_FLIP_Y_WEBGL, i ? 1 : 0), r && this._gl.pixelStorei(this._gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, 1); var o = n ? this._getInternalFormat(n) : this._gl.RGBA;
            this._gl.texImage2D(this._gl.TEXTURE_2D, 0, o, o, this._gl.UNSIGNED_BYTE, t), e.generateMipMaps && this._gl.generateMipmap(this._gl.TEXTURE_2D), this._bindTextureDirectly(this._gl.TEXTURE_2D, null), r && this._gl.pixelStorei(this._gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, 0), this.resetTextureCache(), e.isReady = !0 }, n.prototype.updateVideoTexture = function(e, t, i) { if (!e._isDisabled) { this._bindTextureDirectly(this._gl.TEXTURE_2D, e), this._gl.pixelStorei(this._gl.UNPACK_FLIP_Y_WEBGL, i ? 0 : 1); try { void 0 === this._videoTextureSupported && (this._gl.texImage2D(this._gl.TEXTURE_2D, 0, this._gl.RGBA, this._gl.RGBA, this._gl.UNSIGNED_BYTE, t), 0 !== this._gl.getError() ? this._videoTextureSupported = !1 : this._videoTextureSupported = !0), this._videoTextureSupported ? this._gl.texImage2D(this._gl.TEXTURE_2D, 0, this._gl.RGBA, this._gl.RGBA, this._gl.UNSIGNED_BYTE, t) : (e._workingCanvas || (e._workingCanvas = document.createElement("canvas"), e._workingContext = e._workingCanvas.getContext("2d"), e._workingCanvas.width = e._width, e._workingCanvas.height = e._height), e._workingContext.drawImage(t, 0, 0, t.videoWidth, t.videoHeight, 0, 0, e._width, e._height), this._gl.texImage2D(this._gl.TEXTURE_2D, 0, this._gl.RGBA, this._gl.RGBA, this._gl.UNSIGNED_BYTE, e._workingCanvas)), e.generateMipMaps && this._gl.generateMipmap(this._gl.TEXTURE_2D), this._bindTextureDirectly(this._gl.TEXTURE_2D, null), this.resetTextureCache(), e.isReady = !0 } catch (t) { e._isDisabled = !0 } } }, n.prototype.createRenderTargetTexture = function(t, r) { var o = !1,
                s = !0,
                a = !1,
                h = n.TEXTURETYPE_UNSIGNED_INT,
                l = e.Texture.TRILINEAR_SAMPLINGMODE;
            void 0 !== r && (o = void 0 === r.generateMipMaps ? r : r.generateMipMaps, s = void 0 === r.generateDepthBuffer || r.generateDepthBuffer, a = s && r.generateStencilBuffer, h = void 0 === r.type ? h : r.type, void 0 !== r.samplingMode && (l = r.samplingMode), h !== n.TEXTURETYPE_FLOAT || this._caps.textureFloatLinearFiltering ? h !== n.TEXTURETYPE_HALF_FLOAT || this._caps.textureHalfFloatLinearFiltering || (l = e.Texture.NEAREST_SAMPLINGMODE) : l = e.Texture.NEAREST_SAMPLINGMODE); var c = this._gl,
                u = c.createTexture();
            this._bindTextureDirectly(c.TEXTURE_2D, u); var d = t.width || t,
                f = t.height || t,
                p = i(l, o, c);
            h !== n.TEXTURETYPE_FLOAT || this._caps.textureFloat || (h = n.TEXTURETYPE_UNSIGNED_INT, e.Tools.Warn("Float textures are not supported. Render target forced to TEXTURETYPE_UNSIGNED_BYTE type")), c.texParameteri(c.TEXTURE_2D, c.TEXTURE_MAG_FILTER, p.mag), c.texParameteri(c.TEXTURE_2D, c.TEXTURE_MIN_FILTER, p.min), c.texParameteri(c.TEXTURE_2D, c.TEXTURE_WRAP_S, c.CLAMP_TO_EDGE), c.texParameteri(c.TEXTURE_2D, c.TEXTURE_WRAP_T, c.CLAMP_TO_EDGE), c.texImage2D(c.TEXTURE_2D, 0, this._getRGBABufferInternalSizedFormat(h), d, f, 0, c.RGBA, this._getWebGLTextureType(h), null); var _ = c.createFramebuffer(); return this.bindUnboundFramebuffer(_), c.framebufferTexture2D(c.FRAMEBUFFER, c.COLOR_ATTACHMENT0, c.TEXTURE_2D, u, 0), u._depthStencilBuffer = this._setupFramebufferDepthAttachments(a, s, d, f), o && this._gl.generateMipmap(this._gl.TEXTURE_2D), this._bindTextureDirectly(c.TEXTURE_2D, null), c.bindRenderbuffer(c.RENDERBUFFER, null), this.bindUnboundFramebuffer(null), u._framebuffer = _, u._baseWidth = d, u._baseHeight = f, u._width = d, u._height = f, u.isReady = !0, u.samples = 1, u.generateMipMaps = o, u.references = 1, u.samplingMode = l, u.type = h, u._generateDepthBuffer = s, u._generateStencilBuffer = a, this.resetTextureCache(), this._loadedTexturesCache.push(u), u }, n.prototype._setupFramebufferDepthAttachments = function(e, t, i, r, n) { void 0 === n && (n = 1); var o = null,
                s = this._gl; return e ? (o = s.createRenderbuffer(), s.bindRenderbuffer(s.RENDERBUFFER, o), n > 1 ? s.renderbufferStorageMultisample(s.RENDERBUFFER, n, s.DEPTH_STENCIL, i, r) : s.renderbufferStorage(s.RENDERBUFFER, s.DEPTH_STENCIL, i, r), s.framebufferRenderbuffer(s.FRAMEBUFFER, s.DEPTH_STENCIL_ATTACHMENT, s.RENDERBUFFER, o)) : t && (o = s.createRenderbuffer(), s.bindRenderbuffer(s.RENDERBUFFER, o), n > 1 ? s.renderbufferStorageMultisample(s.RENDERBUFFER, n, s.DEPTH_COMPONENT16, i, r) : s.renderbufferStorage(s.RENDERBUFFER, s.DEPTH_COMPONENT16, i, r), s.framebufferRenderbuffer(s.FRAMEBUFFER, s.DEPTH_ATTACHMENT, s.RENDERBUFFER, o)), o }, n.prototype.updateRenderTargetTextureSampleCount = function(e, t) { if (this.webGLVersion < 2) return 1; if (e.samples === t) return t; var i = this._gl; if (t = Math.min(t, i.getParameter(i.MAX_SAMPLES)), e._depthStencilBuffer && i.deleteRenderbuffer(e._depthStencilBuffer), e._MSAAFramebuffer && i.deleteFramebuffer(e._MSAAFramebuffer), e._MSAARenderBuffer && i.deleteRenderbuffer(e._MSAARenderBuffer), t > 1) { e._MSAAFramebuffer = i.createFramebuffer(), this.bindUnboundFramebuffer(e._MSAAFramebuffer); var r = i.createRenderbuffer();
                i.bindRenderbuffer(i.RENDERBUFFER, r), i.renderbufferStorageMultisample(i.RENDERBUFFER, t, i.RGBA8, e._width, e._height), i.framebufferRenderbuffer(i.FRAMEBUFFER, i.COLOR_ATTACHMENT0, i.RENDERBUFFER, r), e._MSAARenderBuffer = r } else this.bindUnboundFramebuffer(e._framebuffer); return e.samples = t, e._depthStencilBuffer = this._setupFramebufferDepthAttachments(e._generateStencilBuffer, e._generateDepthBuffer, e._width, e._height, t), i.bindRenderbuffer(i.RENDERBUFFER, null), this.bindUnboundFramebuffer(null), t }, n.prototype.createRenderTargetCubeTexture = function(t, r) { var n = this._gl,
                o = n.createTexture(),
                s = !0,
                a = !0,
                h = !1,
                l = e.Texture.TRILINEAR_SAMPLINGMODE;
            void 0 !== r && (s = void 0 === r.generateMipMaps ? r : r.generateMipMaps, a = void 0 === r.generateDepthBuffer || r.generateDepthBuffer, h = a && r.generateStencilBuffer, void 0 !== r.samplingMode && (l = r.samplingMode)), o.isCube = !0, o.references = 1, o.generateMipMaps = s, o.references = 1, o.samples = 1, o.samplingMode = l; var c = i(l, s, n);
            this._bindTextureDirectly(n.TEXTURE_CUBE_MAP, o); for (var u = 0; u < 6; u++) n.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X + u, 0, n.RGBA, t, t, 0, n.RGBA, n.UNSIGNED_BYTE, null);
            n.texParameteri(n.TEXTURE_CUBE_MAP, n.TEXTURE_MAG_FILTER, c.mag), n.texParameteri(n.TEXTURE_CUBE_MAP, n.TEXTURE_MIN_FILTER, c.min), n.texParameteri(n.TEXTURE_CUBE_MAP, n.TEXTURE_WRAP_S, n.CLAMP_TO_EDGE), n.texParameteri(n.TEXTURE_CUBE_MAP, n.TEXTURE_WRAP_T, n.CLAMP_TO_EDGE); var d = n.createFramebuffer(); return this.bindUnboundFramebuffer(d), o._depthStencilBuffer = this._setupFramebufferDepthAttachments(h, a, t, t), o.generateMipMaps && (this._bindTextureDirectly(n.TEXTURE_CUBE_MAP, o), n.generateMipmap(n.TEXTURE_CUBE_MAP)), this._bindTextureDirectly(n.TEXTURE_CUBE_MAP, null), n.bindRenderbuffer(n.RENDERBUFFER, null), this.bindUnboundFramebuffer(null), o._framebuffer = d, o._width = t, o._height = t, o.isReady = !0, this.resetTextureCache(), this._loadedTexturesCache.push(o), o }, n.prototype.createCubeTexture = function(t, i, r, n, s, a, h) { var l = this;
            void 0 === s && (s = null), void 0 === a && (a = null); var c = this._gl,
                u = c.createTexture();
            u.isCube = !0, u.url = t, u.references = 1, u.onLoadedCallbacks = []; var d = !1,
                f = t.lastIndexOf("."),
                p = t.substring(f).toLowerCase();
            this._textureFormatInUse && (p = this._textureFormatInUse, t = t.substring(0, f) + this._textureFormatInUse, d = !0); var _ = this.getCaps().s3tc && ".dds" === p; return _ && e.Tools.Warn("DDS files deprecated since 3.0, use KTX files"), d ? e.Tools.LoadFile(t, (function(t) { var i = new e.Internals.KhronosTextureContainer(t, 6),
                    r = i.numberOfMipmapLevels > 1 && !n;
                l._bindTextureDirectly(c.TEXTURE_CUBE_MAP, u), c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL, 1), i.uploadLevels(l._gl, !n), c.texParameteri(c.TEXTURE_CUBE_MAP, c.TEXTURE_MAG_FILTER, c.LINEAR), c.texParameteri(c.TEXTURE_CUBE_MAP, c.TEXTURE_MIN_FILTER, r ? c.LINEAR_MIPMAP_LINEAR : c.LINEAR), c.texParameteri(c.TEXTURE_CUBE_MAP, c.TEXTURE_WRAP_S, c.CLAMP_TO_EDGE), c.texParameteri(c.TEXTURE_CUBE_MAP, c.TEXTURE_WRAP_T, c.CLAMP_TO_EDGE), l._bindTextureDirectly(c.TEXTURE_CUBE_MAP, null), l.resetTextureCache(), u._width = i.pixelWidth, u._height = i.pixelHeight, u.isReady = !0 }), null, null, !0, a) : _ ? e.Tools.LoadFile(t, (function(t) { var i = e.Internals.DDSTools.GetDDSInfo(t),
                    r = (i.isRGB || i.isLuminance || i.mipmapCount > 1) && !n;
                l._bindTextureDirectly(c.TEXTURE_CUBE_MAP, u), c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL, 1), e.Internals.DDSTools.UploadDDSLevels(l._gl, l.getCaps().s3tc, t, i, r, 6), n || i.isFourCC || 1 !== i.mipmapCount || c.generateMipmap(c.TEXTURE_CUBE_MAP), c.texParameteri(c.TEXTURE_CUBE_MAP, c.TEXTURE_MAG_FILTER, c.LINEAR), c.texParameteri(c.TEXTURE_CUBE_MAP, c.TEXTURE_MIN_FILTER, r ? c.LINEAR_MIPMAP_LINEAR : c.LINEAR), c.texParameteri(c.TEXTURE_CUBE_MAP, c.TEXTURE_WRAP_S, c.CLAMP_TO_EDGE), c.texParameteri(c.TEXTURE_CUBE_MAP, c.TEXTURE_WRAP_T, c.CLAMP_TO_EDGE), l._bindTextureDirectly(c.TEXTURE_CUBE_MAP, null), l.resetTextureCache(), u._width = i.width, u._height = i.height, u.isReady = !0 }), null, null, !0, a) : o(0, i, (function(t) { var i = e.Tools.GetExponentOfTwo(t[0].width, l._caps.maxCubemapTextureSize),
                    r = i;
                l._prepareWorkingCanvas(), l._workingCanvas.width = i, l._workingCanvas.height = r; var o = [c.TEXTURE_CUBE_MAP_POSITIVE_X, c.TEXTURE_CUBE_MAP_POSITIVE_Y, c.TEXTURE_CUBE_MAP_POSITIVE_Z, c.TEXTURE_CUBE_MAP_NEGATIVE_X, c.TEXTURE_CUBE_MAP_NEGATIVE_Y, c.TEXTURE_CUBE_MAP_NEGATIVE_Z];
                l._bindTextureDirectly(c.TEXTURE_CUBE_MAP, u), c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL, 0); for (var a = h ? l._getInternalFormat(h) : l._gl.RGBA, d = 0; d < o.length; d++) l._workingContext.drawImage(t[d], 0, 0, t[d].width, t[d].height, 0, 0, i, r), c.texImage2D(o[d], 0, a, a, c.UNSIGNED_BYTE, l._workingCanvas);
                n || c.generateMipmap(c.TEXTURE_CUBE_MAP), c.texParameteri(c.TEXTURE_CUBE_MAP, c.TEXTURE_MAG_FILTER, c.LINEAR), c.texParameteri(c.TEXTURE_CUBE_MAP, c.TEXTURE_MIN_FILTER, n ? c.LINEAR : c.LINEAR_MIPMAP_LINEAR), c.texParameteri(c.TEXTURE_CUBE_MAP, c.TEXTURE_WRAP_S, c.CLAMP_TO_EDGE), c.texParameteri(c.TEXTURE_CUBE_MAP, c.TEXTURE_WRAP_T, c.CLAMP_TO_EDGE), l._bindTextureDirectly(c.TEXTURE_CUBE_MAP, null), l.resetTextureCache(), u._width = i, u._height = r, u.isReady = !0, u.onLoadedCallbacks.forEach((function(e) { e() })), s && s() }), r, a), this._loadedTexturesCache.push(u), u }, n.prototype.updateTextureSize = function(e, t, i) { e._width = t, e._height = i, e._size = t * i, e._baseWidth = t, e._baseHeight = i }, n.prototype.createRawCubeTexture = function(t, i, r, o, s, a, h, l, c, u) { var d = this;
            void 0 === c && (c = null), void 0 === u && (u = null); var f = this._gl,
                p = f.createTexture();
            i._addPendingData(p), p.isCube = !0, p.references = 1, p.url = t; var _ = f.UNSIGNED_BYTE;
            s === n.TEXTURETYPE_FLOAT && (_ = f.FLOAT); var m = this._getInternalFormat(o),
                g = !1;
            m === f.RGB && (m = f.RGBA, g = !0); var v = this._getRGBABufferInternalSizedFormat(s),
                y = r,
                x = y,
                b = e.Tools.IsExponentOfTwo(y) && e.Tools.IsExponentOfTwo(x);
            p._width = y, p._height = x; var A = function() { i._removePendingData(p), u && u() },
                E = function(t) { var r = h(t),
                        o = [f.TEXTURE_CUBE_MAP_POSITIVE_X, f.TEXTURE_CUBE_MAP_POSITIVE_Y, f.TEXTURE_CUBE_MAP_POSITIVE_Z, f.TEXTURE_CUBE_MAP_NEGATIVE_X, f.TEXTURE_CUBE_MAP_NEGATIVE_Y, f.TEXTURE_CUBE_MAP_NEGATIVE_Z]; if (y = p._width, x = p._height, b = e.Tools.IsExponentOfTwo(y) && e.Tools.IsExponentOfTwo(x), d._bindTextureDirectly(f.TEXTURE_CUBE_MAP, p), f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL, 0), l) { var u = [];
                        u.push(r[0]), u.push(r[3]), u.push(r[1]), u.push(r[4]), u.push(r[2]), u.push(r[5]); for (var A = l(u), E = [0, 2, 4, 1, 3, 5], T = 0; T < A.length; T++) { var P = y >> T; for (var M in E) { var S = A[T][E[M]];
                                g && (S = d._convertRGBtoRGBATextureData(S, P, P, s)), f.texImage2D(o[M], T, v, P, P, 0, m, _, S) } } } else { for (var C = 0; C < o.length; C++) { var R = r[C];
                            g && (R = d._convertRGBtoRGBATextureData(R, y, x, s)), f.texImage2D(o[C], 0, v, y, x, 0, m, _, R) }!a && b ? f.generateMipmap(f.TEXTURE_CUBE_MAP) : a = !0 }(_ !== f.FLOAT || d._caps.textureFloatLinearFiltering) && (_ !== n.HALF_FLOAT_OES || d._caps.textureHalfFloatLinearFiltering) ? (f.texParameteri(f.TEXTURE_CUBE_MAP, f.TEXTURE_MAG_FILTER, f.LINEAR), f.texParameteri(f.TEXTURE_CUBE_MAP, f.TEXTURE_MIN_FILTER, a ? f.LINEAR : f.LINEAR_MIPMAP_LINEAR)) : (f.texParameteri(f.TEXTURE_CUBE_MAP, f.TEXTURE_MAG_FILTER, f.NEAREST), f.texParameteri(f.TEXTURE_CUBE_MAP, f.TEXTURE_MIN_FILTER, f.NEAREST)), f.texParameteri(f.TEXTURE_CUBE_MAP, f.TEXTURE_WRAP_S, f.CLAMP_TO_EDGE), f.texParameteri(f.TEXTURE_CUBE_MAP, f.TEXTURE_WRAP_T, f.CLAMP_TO_EDGE), d._bindTextureDirectly(f.TEXTURE_CUBE_MAP, null), p.isReady = !0, d.resetTextureCache(), i._removePendingData(p), c && c() }; return e.Tools.LoadFile(t, (function(e) { E(e) }), A, i.database, !0), p }, n.prototype._convertRGBtoRGBATextureData = function(e, t, i, r) { var o;
            o = r === n.TEXTURETYPE_FLOAT ? new Float32Array(t * i * 4) : new Uint32Array(t * i * 4); for (var s = 0; s < t; s++)
                for (var a = 0; a < i; a++) { var h = 3 * (a * t + s),
                        l = 4 * (a * t + s);
                    o[l + 0] = e[h + 0], o[l + 1] = e[h + 1], o[l + 2] = e[h + 2], o[l + 3] = 1 }
            return o }, n.prototype._releaseTexture = function(e) { var t = this._gl;
            e._framebuffer && t.deleteFramebuffer(e._framebuffer), e._depthStencilBuffer && t.deleteRenderbuffer(e._depthStencilBuffer), e._MSAAFramebuffer && t.deleteFramebuffer(e._MSAAFramebuffer), e._MSAARenderBuffer && t.deleteRenderbuffer(e._MSAARenderBuffer), t.deleteTexture(e), this.unbindAllTextures(); var i = this._loadedTexturesCache.indexOf(e);
            i !== -1 && this._loadedTexturesCache.splice(i, 1) }, n.prototype.setProgram = function(e) { this._currentProgram !== e && (this._gl.useProgram(e), this._currentProgram = e) }, n.prototype.bindSamplers = function(e) { this.setProgram(e.getProgram()); for (var t = e.getSamplers(), i = 0; i < t.length; i++) { var r = e.getUniform(t[i]);
                this._gl.uniform1i(r, i) }
            this._currentEffect = null }, n.prototype.activateTexture = function(e) { this._activeTexture !== e && (this._gl.activeTexture(e), this._activeTexture = e) }, n.prototype._bindTextureDirectly = function(e, t) { this._activeTexturesCache[this._activeTexture] !== t && (this._gl.bindTexture(e, t), this._activeTexturesCache[this._activeTexture] = t) }, n.prototype._bindTexture = function(e, t) { e < 0 || (this.activateTexture(this._gl.TEXTURE0 + e), this._bindTextureDirectly(this._gl.TEXTURE_2D, t)) }, n.prototype.setTextureFromPostProcess = function(e, t) { this._bindTexture(e, t._textures.data[t._currentRenderTextureInd]) }, n.prototype.unbindAllTextures = function() { for (var e = 0; e < this._caps.maxTexturesImageUnits; e++) this.activateTexture(this._gl["TEXTURE" + e]), this._bindTextureDirectly(this._gl.TEXTURE_2D, null), this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP, null) }, n.prototype.setTexture = function(e, t, i) { e < 0 || (this._gl.uniform1i(t, e), this._setTexture(e, i)) }, n.prototype._setTexture = function(t, i) { if (!i || !i.isReady()) return void(null != this._activeTexturesCache[t] && (this.activateTexture(this._gl["TEXTURE" + t]), this._bindTextureDirectly(this._gl.TEXTURE_2D, null), this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP, null))); var r = !1; if (i.video) this.activateTexture(this._gl["TEXTURE" + t]), r = !0, i.update();
            else if (i.delayLoadState === n.DELAYLOADSTATE_NOTLOADED) return void i.delayLoad(); var o = i.getInternalTexture(); if (this._activeTexturesCache[t] !== o)
                if (r || this.activateTexture(this._gl["TEXTURE" + t]), o.isCube) { if (this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP, o), o._cachedCoordinatesMode !== i.coordinatesMode) { o._cachedCoordinatesMode = i.coordinatesMode; var s = i.coordinatesMode !== e.Texture.CUBIC_MODE && i.coordinatesMode !== e.Texture.SKYBOX_MODE ? this._gl.REPEAT : this._gl.CLAMP_TO_EDGE;
                        this._gl.texParameteri(this._gl.TEXTURE_CUBE_MAP, this._gl.TEXTURE_WRAP_S, s), this._gl.texParameteri(this._gl.TEXTURE_CUBE_MAP, this._gl.TEXTURE_WRAP_T, s) }
                    this._setAnisotropicLevel(this._gl.TEXTURE_CUBE_MAP, i) } else { if (this._bindTextureDirectly(this._gl.TEXTURE_2D, o), o._cachedWrapU !== i.wrapU) switch (o._cachedWrapU = i.wrapU, i.wrapU) {
                        case e.Texture.WRAP_ADDRESSMODE:
                            this._gl.texParameteri(this._gl.TEXTURE_2D, this._gl.TEXTURE_WRAP_S, this._gl.REPEAT); break;
                        case e.Texture.CLAMP_ADDRESSMODE:
                            this._gl.texParameteri(this._gl.TEXTURE_2D, this._gl.TEXTURE_WRAP_S, this._gl.CLAMP_TO_EDGE); break;
                        case e.Texture.MIRROR_ADDRESSMODE:
                            this._gl.texParameteri(this._gl.TEXTURE_2D, this._gl.TEXTURE_WRAP_S, this._gl.MIRRORED_REPEAT) }
                    if (o._cachedWrapV !== i.wrapV) switch (o._cachedWrapV = i.wrapV, i.wrapV) {
                        case e.Texture.WRAP_ADDRESSMODE:
                            this._gl.texParameteri(this._gl.TEXTURE_2D, this._gl.TEXTURE_WRAP_T, this._gl.REPEAT); break;
                        case e.Texture.CLAMP_ADDRESSMODE:
                            this._gl.texParameteri(this._gl.TEXTURE_2D, this._gl.TEXTURE_WRAP_T, this._gl.CLAMP_TO_EDGE); break;
                        case e.Texture.MIRROR_ADDRESSMODE:
                            this._gl.texParameteri(this._gl.TEXTURE_2D, this._gl.TEXTURE_WRAP_T, this._gl.MIRRORED_REPEAT) }
                    this._setAnisotropicLevel(this._gl.TEXTURE_2D, i) } }, n.prototype.setTextureArray = function(e, t, i) { if (!(e < 0)) { this._textureUnits && this._textureUnits.length === i.length || (this._textureUnits = new Int32Array(i.length)); for (var r = 0; r < i.length; r++) this._textureUnits[r] = e + r;
                this._gl.uniform1iv(t, this._textureUnits); for (var n = 0; n < i.length; n++) this._setTexture(e + n, i[n]) } }, n.prototype._setAnisotropicLevel = function(t, i) { var r = this._caps.textureAnisotropicFilterExtension,
                n = i.anisotropicFilteringLevel;
            i.getInternalTexture().samplingMode === e.Texture.NEAREST_SAMPLINGMODE && (n = 1), r && i._cachedAnisotropicFilteringLevel !== n && (this._gl.texParameterf(t, r.TEXTURE_MAX_ANISOTROPY_EXT, Math.min(n, this._caps.maxAnisotropy)), i._cachedAnisotropicFilteringLevel = n) }, n.prototype.readPixels = function(e, t, i, r) { var n = new Uint8Array(r * i * 4); return this._gl.readPixels(e, t, i, r, this._gl.RGBA, this._gl.UNSIGNED_BYTE, n), n }, n.prototype.addExternalData = function(t, i) { return this._externalData || (this._externalData = new e.StringDictionary), this._externalData.add(t, i) }, n.prototype.getExternalData = function(t) { return this._externalData || (this._externalData = new e.StringDictionary), this._externalData.get(t) }, n.prototype.getOrAddExternalDataWithFactory = function(t, i) { return this._externalData || (this._externalData = new e.StringDictionary), this._externalData.getOrAddWithFactory(t, i) }, n.prototype.removeExternalData = function(t) { return this._externalData || (this._externalData = new e.StringDictionary), this._externalData.remove(t) }, n.prototype.releaseInternalTexture = function(e) { if (e && 0 === --e.references) { var t = this.getLoadedTexturesCache(),
                    i = t.indexOf(e);
                i > -1 && t.splice(i, 1), this._releaseTexture(e) } }, n.prototype.unbindAllAttributes = function() { if (this._mustWipeVertexAttributes) { this._mustWipeVertexAttributes = !1; for (var e = 0; e < this._caps.maxVertexAttribs; e++) this._gl.disableVertexAttribArray(e), this._vertexAttribArraysEnabled[e] = !1, this._currentBufferPointers[e] = null } else
                for (var e = 0, t = this._vertexAttribArraysEnabled.length; e < t; e++) e >= this._caps.maxVertexAttribs || !this._vertexAttribArraysEnabled[e] || (this._gl.disableVertexAttribArray(e), this._vertexAttribArraysEnabled[e] = !1, this._currentBufferPointers[e] = null) }, n.prototype.releaseEffects = function() { for (var e in this._compiledEffects) this._gl.deleteProgram(this._compiledEffects[e]._program);
            this._compiledEffects = {} }, n.prototype.dispose = function() { for (this.hideLoadingUI(), this.stopRenderLoop(); this.scenes.length;) this.scenes[0].dispose();
            n.audioEngine.dispose(), this.releaseEffects(), this.unbindAllAttributes(), this._gl = null, this.disableVR(), window.removeEventListener("blur", this._onBlur), window.removeEventListener("focus", this._onFocus), document.removeEventListener("fullscreenchange", this._onFullscreenChange), document.removeEventListener("mozfullscreenchange", this._onFullscreenChange), document.removeEventListener("webkitfullscreenchange", this._onFullscreenChange), document.removeEventListener("msfullscreenchange", this._onFullscreenChange), document.removeEventListener("pointerlockchange", this._onPointerLockChange), document.removeEventListener("mspointerlockchange", this._onPointerLockChange), document.removeEventListener("mozpointerlockchange", this._onPointerLockChange), document.removeEventListener("webkitpointerlockchange", this._onPointerLockChange); var e = n.Instances.indexOf(this);
            e >= 0 && n.Instances.splice(e, 1) }, n.prototype.displayLoadingUI = function() { this.loadingScreen.displayLoadingUI() }, n.prototype.hideLoadingUI = function() { this.loadingScreen.hideLoadingUI() }, Object.defineProperty(n.prototype, "loadingScreen", { get: function() { return this._loadingScreen || (this._loadingScreen = new e.DefaultLoadingScreen(this._renderingCanvas)), this._loadingScreen }, set: function(e) { this._loadingScreen = e }, enumerable: !0, configurable: !0 }), Object.defineProperty(n.prototype, "loadingUIText", { set: function(e) { this.loadingScreen.loadingUIText = e }, enumerable: !0, configurable: !0 }), Object.defineProperty(n.prototype, "loadingUIBackgroundColor", { set: function(e) { this.loadingScreen.loadingUIBackgroundColor = e }, enumerable: !0, configurable: !0 }), n.prototype.attachContextLostEvent = function(e) { this._renderingCanvas.addEventListener("webglcontextlost", e, !1) }, n.prototype.attachContextRestoredEvent = function(e) { this._renderingCanvas.addEventListener("webglcontextrestored", e, !1) }, n.prototype.getVertexShaderSource = function(e) { var t = this._gl.getAttachedShaders(e); return this._gl.getShaderSource(t[0]) }, n.prototype.getFragmentShaderSource = function(e) { var t = this._gl.getAttachedShaders(e); return this._gl.getShaderSource(t[1]) }, n.prototype.getFps = function() { return this.fps }, n.prototype.getDeltaTime = function() { return this.deltaTime }, n.prototype._measureFps = function() { this.previousFramesDuration.push(e.Tools.Now); var t = this.previousFramesDuration.length; if (t >= 2 && (this.deltaTime = this.previousFramesDuration[t - 1] - this.previousFramesDuration[t - 2]), t >= this.fpsRange) { t > this.fpsRange && (this.previousFramesDuration.splice(0, 1), t = this.previousFramesDuration.length); for (var i = 0, r = 0; r < t - 1; r++) i += this.previousFramesDuration[r + 1] - this.previousFramesDuration[r];
                this.fps = 1e3 / (i / (t - 1)) } }, n.prototype._canRenderToFloatFramebuffer = function() { return this._webGLVersion > 1 ? this._caps.colorBufferFloat : this._canRenderToFramebuffer(e.Engine.TEXTURETYPE_FLOAT) }, n.prototype._canRenderToHalfFloatFramebuffer = function() { return this._webGLVersion > 1 ? this._caps.colorBufferFloat : this._canRenderToFramebuffer(e.Engine.TEXTURETYPE_HALF_FLOAT) }, n.prototype._canRenderToFramebuffer = function(e) { for (var t = this._gl; t.getError() !== t.NO_ERROR;); var i = !0,
                r = t.createTexture();
            t.bindTexture(t.TEXTURE_2D, r), t.texImage2D(t.TEXTURE_2D, 0, this._getRGBABufferInternalSizedFormat(e), 1, 1, 0, t.RGBA, this._getWebGLTextureType(e), null), t.texParameteri(t.TEXTURE_2D, t.TEXTURE_MIN_FILTER, t.NEAREST), t.texParameteri(t.TEXTURE_2D, t.TEXTURE_MAG_FILTER, t.NEAREST); var n = t.createFramebuffer();
            t.bindFramebuffer(t.FRAMEBUFFER, n), t.framebufferTexture2D(t.FRAMEBUFFER, t.COLOR_ATTACHMENT0, t.TEXTURE_2D, r, 0); var o = t.checkFramebufferStatus(t.FRAMEBUFFER); if (i = i && o === t.FRAMEBUFFER_COMPLETE, i = i && t.getError() === t.NO_ERROR, i && (t.clear(t.COLOR_BUFFER_BIT), i = i && t.getError() === t.NO_ERROR), i) { t.bindFramebuffer(t.FRAMEBUFFER, null); var s = t.RGBA,
                    a = t.UNSIGNED_BYTE,
                    h = new Uint8Array(4);
                t.readPixels(0, 0, 1, 1, s, a, h), i = i && t.getError() === t.NO_ERROR } for (t.deleteTexture(r), t.deleteFramebuffer(n), t.bindFramebuffer(t.FRAMEBUFFER, null); !i && t.getError() !== t.NO_ERROR;); return i }, n.prototype._getWebGLTextureType = function(e) {
            return e === n.TEXTURETYPE_FLOAT ? this._gl.FLOAT : e === n.TEXTURETYPE_HALF_FLOAT ? n.HALF_FLOAT_OES : this._gl.UNSIGNED_BYTE
        }, n.prototype._getRGBABufferInternalSizedFormat = function(e) { return 1 === this._webGLVersion ? this._gl.RGBA : e === n.TEXTURETYPE_FLOAT ? n.RGBA32F : e === n.TEXTURETYPE_HALF_FLOAT ? n.RGBA16F : this._gl.RGBA }, n.isSupported = function() { try { if (navigator.isCocoonJS) return !0; var e = document.createElement("canvas"); return null != (e.getContext("webgl") || e.getContext("experimental-webgl")) && !!window.WebGLRenderingContext } catch (e) { return !1 } }, n
    })();
    h.Instances = new Array, h._ALPHA_DISABLE = 0, h._ALPHA_ADD = 1, h._ALPHA_COMBINE = 2, h._ALPHA_SUBTRACT = 3, h._ALPHA_MULTIPLY = 4, h._ALPHA_MAXIMIZED = 5, h._ALPHA_ONEONE = 6, h._ALPHA_PREMULTIPLIED = 7, h._DELAYLOADSTATE_NONE = 0, h._DELAYLOADSTATE_LOADED = 1, h._DELAYLOADSTATE_LOADING = 2, h._DELAYLOADSTATE_NOTLOADED = 4, h._TEXTUREFORMAT_ALPHA = 0, h._TEXTUREFORMAT_LUMINANCE = 1, h._TEXTUREFORMAT_LUMINANCE_ALPHA = 2, h._TEXTUREFORMAT_RGB = 4, h._TEXTUREFORMAT_RGBA = 5, h._TEXTURETYPE_UNSIGNED_INT = 0, h._TEXTURETYPE_FLOAT = 1, h._TEXTURETYPE_HALF_FLOAT = 2, h._NEVER = 512, h._ALWAYS = 519, h._LESS = 513, h._EQUAL = 514, h._LEQUAL = 515, h._GREATER = 516, h._GEQUAL = 518, h._NOTEQUAL = 517, h.HALF_FLOAT_OES = 36193, h.RGBA16F = 34842, h.RGBA32F = 34836, h._KEEP = 7680, h._REPLACE = 7681, h._INCR = 7682, h._DECR = 7683, h._INVERT = 5386, h._INCR_WRAP = 34055, h._DECR_WRAP = 34056, h.CollisionsEpsilon = .001, h.CodeRepository = "src/", h.ShadersRepository = "src/Shaders/", e.Engine = h
})(BABYLON || (BABYLON = {}));
var BABYLON;
!(function(e) { var t = (function() {
        function t(t, i) { this.state = "", this.metadata = null, this.doNotSerialize = !1, this.animations = new Array, this._ranges = {}, this._childrenFlag = -1, this._isEnabled = !0, this._isReady = !0, this._currentRenderId = -1, this._parentRenderId = -1, this.onDisposeObservable = new e.Observable, this.name = t, this.id = t, this._scene = i || e.Engine.LastCreatedScene, this._initCache() } return Object.defineProperty(t.prototype, "parent", { get: function() { return this._parentNode }, set: function(e) { if (this._parentNode !== e) { if (this._parentNode) { var t = this._parentNode._children.indexOf(this);
                        t !== -1 && this._parentNode._children.splice(t, 1) }
                    this._parentNode = e, this._parentNode && (this._parentNode._children || (this._parentNode._children = new Array), this._parentNode._children.push(this)) } }, enumerable: !0, configurable: !0 }), t.prototype.getClassName = function() { return "Node" }, Object.defineProperty(t.prototype, "onDispose", { set: function(e) { this._onDisposeObserver && this.onDisposeObservable.remove(this._onDisposeObserver), this._onDisposeObserver = this.onDisposeObservable.add(e) }, enumerable: !0, configurable: !0 }), t.prototype.getScene = function() { return this._scene }, t.prototype.getEngine = function() { return this._scene.getEngine() }, t.prototype.getWorldMatrix = function() { return e.Matrix.Identity() }, t.prototype._initCache = function() { this._cache = {}, this._cache.parent = void 0 }, t.prototype.updateCache = function(e) {!e && this.isSynchronized() || (this._cache.parent = this.parent, this._updateCache()) }, t.prototype._updateCache = function(e) {}, t.prototype._isSynchronized = function() { return !0 }, t.prototype._markSyncedWithParent = function() { this._parentRenderId = this.parent._currentRenderId }, t.prototype.isSynchronizedWithParent = function() { return !this.parent || this._parentRenderId === this.parent._currentRenderId && this.parent.isSynchronized() }, t.prototype.isSynchronized = function(e) { var t = this.hasNewParent(); return t = t || !this.isSynchronizedWithParent(), t = t || !this._isSynchronized(), e && this.updateCache(!0), !t }, t.prototype.hasNewParent = function(e) { return this._cache.parent !== this.parent && (e && (this._cache.parent = this.parent), !0) }, t.prototype.isReady = function() { return this._isReady }, t.prototype.isEnabled = function() { return !!this._isEnabled && (!this.parent || this.parent.isEnabled()) }, t.prototype.setEnabled = function(e) { this._isEnabled = e }, t.prototype.isDescendantOf = function(e) { return !!this.parent && (this.parent === e || this.parent.isDescendantOf(e)) }, t.prototype._getDescendants = function(e, t, i) { if (void 0 === t && (t = !1), this._children)
                for (var r = 0; r < this._children.length; r++) { var n = this._children[r];
                    i && !i(n) || e.push(n), t || n._getDescendants(e, !1, i) } }, t.prototype.getDescendants = function(e, t) { var i = []; return this._getDescendants(i, e, t), i }, t.prototype.getChildMeshes = function(t, i) { var r = []; return this._getDescendants(r, t, (function(t) { return (!i || i(t)) && t instanceof e.AbstractMesh })), r }, t.prototype.getChildren = function(e) { return this.getDescendants(!0, e) }, t.prototype._setReady = function(e) { if (e !== this._isReady) { if (!e) return void(this._isReady = !1);
                this._isReady = !0, this.onReady && this.onReady(this) } }, t.prototype.getAnimationByName = function(e) { for (var t = 0; t < this.animations.length; t++) { var i = this.animations[t]; if (i.name === e) return i } return null }, t.prototype.createAnimationRange = function(t, i, r) { if (!this._ranges[t]) { this._ranges[t] = new e.AnimationRange(t, i, r); for (var n = 0, o = this.animations.length; n < o; n++) this.animations[n] && this.animations[n].createRange(t, i, r) } }, t.prototype.deleteAnimationRange = function(e, t) { void 0 === t && (t = !0); for (var i = 0, r = this.animations.length; i < r; i++) this.animations[i] && this.animations[i].deleteRange(e, t);
            this._ranges[e] = void 0 }, t.prototype.getAnimationRange = function(e) { return this._ranges[e] }, t.prototype.beginAnimation = function(e, t, i, r) { var n = this.getAnimationRange(e); if (!n) return null;
            this._scene.beginAnimation(this, n.from, n.to, t, i, r) }, t.prototype.serializeAnimationRanges = function() { var e = []; for (var t in this._ranges) { var i = {};
                i.name = t, i.from = this._ranges[t].from, i.to = this._ranges[t].to, e.push(i) } return e }, t.prototype.dispose = function() { this.parent = null, this.onDisposeObservable.notifyObservers(this), this.onDisposeObservable.clear() }, t.ParseAnimationRanges = function(e, t, i) { if (t.ranges)
                for (var r = 0; r < t.ranges.length; r++) { var n = t.ranges[r];
                    e.createAnimationRange(n.name, n.from, n.to) } }, t })();
    __decorate([e.serialize()], t.prototype, "name", void 0), __decorate([e.serialize()], t.prototype, "id", void 0), __decorate([e.serialize()], t.prototype, "uniqueId", void 0), __decorate([e.serialize()], t.prototype, "state", void 0), __decorate([e.serialize()], t.prototype, "metadata", void 0), e.Node = t })(BABYLON || (BABYLON = {}));
var BABYLON;
!(function(e) { var t = (function() {
        function t(t, i) { this.minimum = t, this.maximum = i, this._tempRadiusVector = e.Vector3.Zero(); var r = e.Vector3.Distance(t, i);
            this.center = e.Vector3.Lerp(t, i, .5), this.radius = .5 * r, this.centerWorld = e.Vector3.Zero(), this._update(e.Matrix.Identity()) } return t.prototype._update = function(t) { e.Vector3.TransformCoordinatesToRef(this.center, t, this.centerWorld), e.Vector3.TransformNormalFromFloatsToRef(1, 1, 1, t, this._tempRadiusVector), this.radiusWorld = Math.max(Math.abs(this._tempRadiusVector.x), Math.abs(this._tempRadiusVector.y), Math.abs(this._tempRadiusVector.z)) * this.radius }, t.prototype.isInFrustum = function(e) { for (var t = 0; t < 6; t++)
                if (e[t].dotCoordinate(this.centerWorld) <= -this.radiusWorld) return !1;
            return !0 }, t.prototype.intersectsPoint = function(t) { var i = this.centerWorld.x - t.x,
                r = this.centerWorld.y - t.y,
                n = this.centerWorld.z - t.z,
                o = Math.sqrt(i * i + r * r + n * n); return !(Math.abs(this.radiusWorld - o) < e.Epsilon) }, t.Intersects = function(e, t) { var i = e.centerWorld.x - t.centerWorld.x,
                r = e.centerWorld.y - t.centerWorld.y,
                n = e.centerWorld.z - t.centerWorld.z,
                o = Math.sqrt(i * i + r * r + n * n); return !(e.radiusWorld + t.radiusWorld < o) }, t })();
    e.BoundingSphere = t })(BABYLON || (BABYLON = {}));
var BABYLON;
!(function(e) { var t = (function() {
        function t(t, i) { this.minimum = t, this.maximum = i, this.vectors = new Array, this.vectorsWorld = new Array, this.vectors.push(this.minimum.clone()), this.vectors.push(this.maximum.clone()), this.vectors.push(this.minimum.clone()), this.vectors[2].x = this.maximum.x, this.vectors.push(this.minimum.clone()), this.vectors[3].y = this.maximum.y, this.vectors.push(this.minimum.clone()), this.vectors[4].z = this.maximum.z, this.vectors.push(this.maximum.clone()), this.vectors[5].z = this.minimum.z, this.vectors.push(this.maximum.clone()), this.vectors[6].x = this.minimum.x, this.vectors.push(this.maximum.clone()), this.vectors[7].y = this.minimum.y, this.center = this.maximum.add(this.minimum).scale(.5), this.extendSize = this.maximum.subtract(this.minimum).scale(.5), this.directions = [e.Vector3.Zero(), e.Vector3.Zero(), e.Vector3.Zero()]; for (var r = 0; r < this.vectors.length; r++) this.vectorsWorld[r] = e.Vector3.Zero();
            this.minimumWorld = e.Vector3.Zero(), this.maximumWorld = e.Vector3.Zero(), this.centerWorld = e.Vector3.Zero(), this.extendSizeWorld = e.Vector3.Zero(), this._update(e.Matrix.Identity()) } return t.prototype.getWorldMatrix = function() { return this._worldMatrix }, t.prototype.setWorldMatrix = function(e) { return this._worldMatrix.copyFrom(e), this }, t.prototype._update = function(t) { e.Vector3.FromFloatsToRef(Number.MAX_VALUE, Number.MAX_VALUE, Number.MAX_VALUE, this.minimumWorld), e.Vector3.FromFloatsToRef(-Number.MAX_VALUE, -Number.MAX_VALUE, -Number.MAX_VALUE, this.maximumWorld); for (var i = 0; i < this.vectors.length; i++) { var r = this.vectorsWorld[i];
                e.Vector3.TransformCoordinatesToRef(this.vectors[i], t, r), r.x < this.minimumWorld.x && (this.minimumWorld.x = r.x), r.y < this.minimumWorld.y && (this.minimumWorld.y = r.y), r.z < this.minimumWorld.z && (this.minimumWorld.z = r.z), r.x > this.maximumWorld.x && (this.maximumWorld.x = r.x), r.y > this.maximumWorld.y && (this.maximumWorld.y = r.y), r.z > this.maximumWorld.z && (this.maximumWorld.z = r.z) }
            this.maximumWorld.subtractToRef(this.minimumWorld, this.extendSizeWorld), this.extendSizeWorld.scaleInPlace(.5), this.maximumWorld.addToRef(this.minimumWorld, this.centerWorld), this.centerWorld.scaleInPlace(.5), e.Vector3.FromFloatArrayToRef(t.m, 0, this.directions[0]), e.Vector3.FromFloatArrayToRef(t.m, 4, this.directions[1]), e.Vector3.FromFloatArrayToRef(t.m, 8, this.directions[2]), this._worldMatrix = t }, t.prototype.isInFrustum = function(e) { return t.IsInFrustum(this.vectorsWorld, e) }, t.prototype.isCompletelyInFrustum = function(e) { return t.IsCompletelyInFrustum(this.vectorsWorld, e) }, t.prototype.intersectsPoint = function(t) { var i = -e.Epsilon; return !(this.maximumWorld.x - t.x < i || i > t.x - this.minimumWorld.x) && (!(this.maximumWorld.y - t.y < i || i > t.y - this.minimumWorld.y) && !(this.maximumWorld.z - t.z < i || i > t.z - this.minimumWorld.z)) }, t.prototype.intersectsSphere = function(e) { return t.IntersectsSphere(this.minimumWorld, this.maximumWorld, e.centerWorld, e.radiusWorld) }, t.prototype.intersectsMinMax = function(e, t) { return !(this.maximumWorld.x < e.x || this.minimumWorld.x > t.x) && (!(this.maximumWorld.y < e.y || this.minimumWorld.y > t.y) && !(this.maximumWorld.z < e.z || this.minimumWorld.z > t.z)) }, t.Intersects = function(e, t) { return !(e.maximumWorld.x < t.minimumWorld.x || e.minimumWorld.x > t.maximumWorld.x) && (!(e.maximumWorld.y < t.minimumWorld.y || e.minimumWorld.y > t.maximumWorld.y) && !(e.maximumWorld.z < t.minimumWorld.z || e.minimumWorld.z > t.maximumWorld.z)) }, t.IntersectsSphere = function(t, i, r, n) { var o = e.Vector3.Clamp(r, t, i); return e.Vector3.DistanceSquared(r, o) <= n * n }, t.IsCompletelyInFrustum = function(e, t) { for (var i = 0; i < 6; i++)
                for (var r = 0; r < 8; r++)
                    if (t[i].dotCoordinate(e[r]) < 0) return !1;
            return !0 }, t.IsInFrustum = function(e, t) { for (var i = 0; i < 6; i++) { for (var r = 8, n = 0; n < 8 && t[i].dotCoordinate(e[n]) < 0; n++) --r; if (0 === r) return !1 } return !0 }, t })();
    e.BoundingBox = t })(BABYLON || (BABYLON = {}));
var BABYLON;
!(function(e) { var t = function(t, i) { var r = e.Vector3.Dot(i.centerWorld, t),
                n = Math.abs(e.Vector3.Dot(i.directions[0], t)) * i.extendSize.x,
                o = Math.abs(e.Vector3.Dot(i.directions[1], t)) * i.extendSize.y,
                s = Math.abs(e.Vector3.Dot(i.directions[2], t)) * i.extendSize.z,
                a = n + o + s; return { min: r - a, max: r + a } },
        i = function(e, t, i, r) { return !(e > r || i > t) },
        r = function(e, r, n) { var o = t(e, r),
                s = t(e, n); return i(o.min, o.max, s.min, s.max) },
        n = (function() {
            function t(t, i) { this.minimum = t, this.maximum = i, this._isLocked = !1, this.boundingBox = new e.BoundingBox(t, i), this.boundingSphere = new e.BoundingSphere(t, i) } return Object.defineProperty(t.prototype, "isLocked", { get: function() { return this._isLocked }, set: function(e) { this._isLocked = e }, enumerable: !0, configurable: !0 }), t.prototype.update = function(e) { this._isLocked || (this.boundingBox._update(e), this.boundingSphere._update(e)) }, t.prototype.isInFrustum = function(e) { return !!this.boundingSphere.isInFrustum(e) && this.boundingBox.isInFrustum(e) }, t.prototype.isCompletelyInFrustum = function(e) { return this.boundingBox.isCompletelyInFrustum(e) }, t.prototype._checkCollision = function(e) { return e._canDoCollision(this.boundingSphere.centerWorld, this.boundingSphere.radiusWorld, this.boundingBox.minimumWorld, this.boundingBox.maximumWorld) }, t.prototype.intersectsPoint = function(e) { return !!this.boundingSphere.centerWorld && (!!this.boundingSphere.intersectsPoint(e) && !!this.boundingBox.intersectsPoint(e)) }, t.prototype.intersects = function(t, i) { if (!this.boundingSphere.centerWorld || !t.boundingSphere.centerWorld) return !1; if (!e.BoundingSphere.Intersects(this.boundingSphere, t.boundingSphere)) return !1; if (!e.BoundingBox.Intersects(this.boundingBox, t.boundingBox)) return !1; if (!i) return !0; var n = this.boundingBox,
                    o = t.boundingBox; return !!r(n.directions[0], n, o) && (!!r(n.directions[1], n, o) && (!!r(n.directions[2], n, o) && (!!r(o.directions[0], n, o) && (!!r(o.directions[1], n, o) && (!!r(o.directions[2], n, o) && (!!r(e.Vector3.Cross(n.directions[0], o.directions[0]), n, o) && (!!r(e.Vector3.Cross(n.directions[0], o.directions[1]), n, o) && (!!r(e.Vector3.Cross(n.directions[0], o.directions[2]), n, o) && (!!r(e.Vector3.Cross(n.directions[1], o.directions[0]), n, o) && (!!r(e.Vector3.Cross(n.directions[1], o.directions[1]), n, o) && (!!r(e.Vector3.Cross(n.directions[1], o.directions[2]), n, o) && (!!r(e.Vector3.Cross(n.directions[2], o.directions[0]), n, o) && (!!r(e.Vector3.Cross(n.directions[2], o.directions[1]), n, o) && !!r(e.Vector3.Cross(n.directions[2], o.directions[2]), n, o)))))))))))))) }, t })();
    e.BoundingInfo = n })(BABYLON || (BABYLON = {}));
var BABYLON;
!(function(e) {
    var t = (function(t) {
        function i(r, n) { var o = t.call(this, r, n) || this; return o._facetNb = 0, o._partitioningSubdivisions = 10, o._partitioningBBoxRatio = 1.01, o._facetDataEnabled = !1, o._facetParameters = {}, o._bbSize = e.Vector3.Zero(), o._subDiv = { max: 1, X: 1, Y: 1, Z: 1 }, o.onCollideObservable = new e.Observable, o.onCollisionPositionChangeObservable = new e.Observable, o.onAfterWorldMatrixUpdateObservable = new e.Observable, o.definedFacingForward = !0, o.position = new e.Vector3(0, 0, 0), o._rotation = new e.Vector3(0, 0, 0), o._scaling = new e.Vector3(1, 1, 1), o.billboardMode = i.BILLBOARDMODE_NONE, o.visibility = 1, o.alphaIndex = Number.MAX_VALUE, o.infiniteDistance = !1, o.isVisible = !0, o.isPickable = !0, o.showBoundingBox = !1, o.showSubMeshesBoundingBox = !1, o.isBlocker = !1, o.renderingGroupId = 0, o._receiveShadows = !1, o.renderOutline = !1, o.outlineColor = e.Color3.Red(), o.outlineWidth = .02, o.renderOverlay = !1, o.overlayColor = e.Color3.Red(), o.overlayAlpha = .5, o._hasVertexAlpha = !1, o._useVertexColors = !0, o._computeBonesUsingShaders = !0, o._numBoneInfluencers = 4, o._applyFog = !0, o.scalingDeterminant = 1, o.useOctreeForRenderingSelection = !0, o.useOctreeForPicking = !0, o.useOctreeForCollisions = !0, o.layerMask = 268435455, o.alwaysSelectAsActiveMesh = !1, o._checkCollisions = !1, o._collisionMask = -1, o._collisionGroup = -1, o.ellipsoid = new e.Vector3(.5, 1, .5), o.ellipsoidOffset = new e.Vector3(0, 0, 0), o._oldPositionForCollisions = new e.Vector3(0, 0, 0), o._diffPositionForCollisions = new e.Vector3(0, 0, 0), o._newPositionForCollisions = new e.Vector3(0, 0, 0), o.edgesWidth = 1, o.edgesColor = new e.Color4(1, 0, 0, 1), o._localWorld = e.Matrix.Zero(), o._worldMatrix = e.Matrix.Zero(), o._absolutePosition = e.Vector3.Zero(), o._collisionsTransformMatrix = e.Matrix.Zero(), o._collisionsScalingMatrix = e.Matrix.Zero(), o._isDirty = !1, o._pivotMatrix = e.Matrix.Identity(), o._isDisposed = !1, o._renderId = 0, o._intersectionsInProgress = new Array, o._isWorldMatrixFrozen = !1, o._unIndexed = !1, o._lightSources = new Array, o._onCollisionPositionChange = function(t, i, r) { void 0 === r && (r = null), o.getScene().workerCollisions && i.multiplyInPlace(o._collider.radius), i.subtractToRef(o._oldPositionForCollisions, o._diffPositionForCollisions), o._diffPositionForCollisions.length() > e.Engine.CollisionsEpsilon && o.position.addInPlace(o._diffPositionForCollisions), r && o.onCollideObservable.notifyObservers(r), o.onCollisionPositionChangeObservable.notifyObservers(o.position) }, o.getScene().addMesh(o), o._resyncLightSources(), o }
        return __extends(i, t), Object.defineProperty(i, "BILLBOARDMODE_NONE", { get: function() { return i._BILLBOARDMODE_NONE }, enumerable: !0, configurable: !0 }), Object.defineProperty(i, "BILLBOARDMODE_X", { get: function() { return i._BILLBOARDMODE_X }, enumerable: !0, configurable: !0 }), Object.defineProperty(i, "BILLBOARDMODE_Y", { get: function() { return i._BILLBOARDMODE_Y }, enumerable: !0, configurable: !0 }), Object.defineProperty(i, "BILLBOARDMODE_Z", { get: function() { return i._BILLBOARDMODE_Z }, enumerable: !0, configurable: !0 }), Object.defineProperty(i, "BILLBOARDMODE_ALL", { get: function() { return i._BILLBOARDMODE_ALL }, enumerable: !0, configurable: !0 }), Object.defineProperty(i.prototype, "facetNb", { get: function() { return this._facetNb }, enumerable: !0, configurable: !0 }), Object.defineProperty(i.prototype, "partitioningSubdivisions", { get: function() { return this._partitioningSubdivisions }, set: function(e) { this._partitioningSubdivisions = e }, enumerable: !0, configurable: !0 }), Object.defineProperty(i.prototype, "partitioningBBoxRatio", { get: function() { return this._partitioningBBoxRatio }, set: function(e) { this._partitioningBBoxRatio = e }, enumerable: !0, configurable: !0 }), Object.defineProperty(i.prototype, "isFacetDataEnabled", { get: function() { return this._facetDataEnabled }, enumerable: !0, configurable: !0 }), Object.defineProperty(i.prototype, "onCollide", { set: function(e) { this._onCollideObserver && this.onCollideObservable.remove(this._onCollideObserver), this._onCollideObserver = this.onCollideObservable.add(e) }, enumerable: !0, configurable: !0 }), Object.defineProperty(i.prototype, "onCollisionPositionChange", { set: function(e) { this._onCollisionPositionChangeObserver && this.onCollisionPositionChangeObservable.remove(this._onCollisionPositionChangeObserver), this._onCollisionPositionChangeObserver = this.onCollisionPositionChangeObservable.add(e) }, enumerable: !0, configurable: !0 }), Object.defineProperty(i.prototype, "material", { get: function() { return this._material }, set: function(e) { if (this._material !== e && (this._material = e, this.subMeshes))
                    for (var t = 0, i = this.subMeshes; t < i.length; t++) { var r = i[t];
                        r.setEffect(null) } }, enumerable: !0, configurable: !0 }), Object.defineProperty(i.prototype, "receiveShadows", { get: function() { return this._receiveShadows }, set: function(e) { this._receiveShadows !== e && (this._receiveShadows = e, this._markSubMeshesAsLightDirty()) }, enumerable: !0, configurable: !0 }), Object.defineProperty(i.prototype, "hasVertexAlpha", { get: function() { return this._hasVertexAlpha }, set: function(e) { this._hasVertexAlpha !== e && (this._hasVertexAlpha = e, this._markSubMeshesAsAttributesDirty()) }, enumerable: !0, configurable: !0 }), Object.defineProperty(i.prototype, "useVertexColors", { get: function() { return this._useVertexColors }, set: function(e) { this._useVertexColors !== e && (this._useVertexColors = e, this._markSubMeshesAsAttributesDirty()) }, enumerable: !0, configurable: !0 }), Object.defineProperty(i.prototype, "computeBonesUsingShaders", { get: function() { return this._computeBonesUsingShaders }, set: function(e) { this._computeBonesUsingShaders !== e && (this._computeBonesUsingShaders = e, this._markSubMeshesAsAttributesDirty()) }, enumerable: !0, configurable: !0 }), Object.defineProperty(i.prototype, "numBoneInfluencers", { get: function() { return this._numBoneInfluencers }, set: function(e) { this._numBoneInfluencers !== e && (this._numBoneInfluencers = e, this._markSubMeshesAsAttributesDirty()) }, enumerable: !0, configurable: !0 }), Object.defineProperty(i.prototype, "applyFog", { get: function() { return this._applyFog }, set: function(e) { this._applyFog !== e && (this._applyFog = e, this._markSubMeshesAsMiscDirty()) }, enumerable: !0, configurable: !0 }), Object.defineProperty(i.prototype, "collisionMask", { get: function() { return this._collisionMask }, set: function(e) { this._collisionMask = isNaN(e) ? -1 : e }, enumerable: !0, configurable: !0 }), Object.defineProperty(i.prototype, "collisionGroup", { get: function() { return this._collisionGroup }, set: function(e) { this._collisionGroup = isNaN(e) ? -1 : e }, enumerable: !0, configurable: !0 }), Object.defineProperty(i.prototype, "skeleton", { get: function() { return this._skeleton }, set: function(e) { this._skeleton && this._skeleton.needInitialSkinMatrix && this._skeleton._unregisterMeshWithPoseMatrix(this), e && e.needInitialSkinMatrix && e._registerMeshWithPoseMatrix(this), this._skeleton = e, this._skeleton || (this._bonesTransformMatrices = null), this._markSubMeshesAsAttributesDirty() }, enumerable: !0, configurable: !0 }), i.prototype.getClassName = function() { return "AbstractMesh" }, i.prototype.toString = function(t) { var i = "Name: " + this.name + ", isInstance: " + (this instanceof e.InstancedMesh ? "YES" : "NO"); return i += ", # of submeshes: " + (this.subMeshes ? this.subMeshes.length : 0), this._skeleton && (i += ", skeleton: " + this._skeleton.name), t && (i += ", billboard mode: " + ["NONE", "X", "Y", null, "Z", null, null, "ALL"][this.billboardMode], i += ", freeze wrld mat: " + (this._isWorldMatrixFrozen || this._waitingFreezeWorldMatrix ? "YES" : "NO")), i }, i.prototype._resyncLightSources = function() { this._lightSources.length = 0; for (var e = 0, t = this.getScene().lights; e < t.length; e++) { var i = t[e];
                i.isEnabled() && (i.canAffectMesh(this) && this._lightSources.push(i)) }
            this._markSubMeshesAsLightDirty() }, i.prototype._resyncLighSource = function(e) { var t = e.isEnabled() && e.canAffectMesh(this),
                i = this._lightSources.indexOf(e); if (i === -1) { if (!t) return;
                this._lightSources.push(e) } else { if (t) return;
                this._lightSources.splice(i, 1) }
            this._markSubMeshesAsLightDirty() }, i.prototype._removeLightSource = function(e) { var t = this._lightSources.indexOf(e);
            t !== -1 && this._lightSources.splice(t, 1) }, i.prototype._markSubMeshesAsDirty = function(e) { if (this.subMeshes)
                for (var t = 0, i = this.subMeshes; t < i.length; t++) { var r = i[t];
                    r._materialDefines && e(r._materialDefines) } }, i.prototype._markSubMeshesAsLightDirty = function() { this._markSubMeshesAsDirty((function(e) { return e.markAsLightDirty() })) }, i.prototype._markSubMeshesAsAttributesDirty = function() { this._markSubMeshesAsDirty((function(e) { return e.markAsAttributesDirty() })) }, i.prototype._markSubMeshesAsMiscDirty = function() { if (this.subMeshes)
                for (var t = 0, i = this.subMeshes; t < i.length; t++) { var r = i[t],
                        n = r.getMaterial();
                    n && n.markAsDirty(e.Material.MiscDirtyFlag) } }, Object.defineProperty(i.prototype, "rotation", { get: function() { return this._rotation }, set: function(e) { this._rotation = e }, enumerable: !0, configurable: !0 }), Object.defineProperty(i.prototype, "scaling", { get: function() { return this._scaling }, set: function(e) { this._scaling = e, this.physicsImpostor && this.physicsImpostor.forceUpdate() }, enumerable: !0, configurable: !0 }), Object.defineProperty(i.prototype, "rotationQuaternion", { get: function() { return this._rotationQuaternion }, set: function(e) { this._rotationQuaternion = e, e && this.rotation.length() && this.rotation.copyFromFloats(0, 0, 0) }, enumerable: !0, configurable: !0 }), i.prototype.updatePoseMatrix = function(e) { return this._poseMatrix.copyFrom(e), this }, i.prototype.getPoseMatrix = function() { return this._poseMatrix }, i.prototype.disableEdgesRendering = function() { return void 0 !== this._edgesRenderer && (this._edgesRenderer.dispose(), this._edgesRenderer = void 0), this }, i.prototype.enableEdgesRendering = function(t, i) { return void 0 === t && (t = .95), void 0 === i && (i = !1), this.disableEdgesRendering(), this._edgesRenderer = new e.EdgesRenderer(this, t, i), this }, Object.defineProperty(i.prototype, "isBlocked", { get: function() { return !1 }, enumerable: !0, configurable: !0 }), i.prototype.getLOD = function(e) { return this }, i.prototype.getTotalVertices = function() { return 0 }, i.prototype.getIndices = function() { return null }, i.prototype.getVerticesData = function(e) { return null }, i.prototype.setVerticesData = function(e, t, i, r) { return null }, i.prototype.updateVerticesData = function(e, t, i, r) { return null }, i.prototype.setIndices = function(e, t) { return null }, i.prototype.isVerticesDataPresent = function(e) { return !1 }, i.prototype.getBoundingInfo = function() { return this._masterMesh ? this._masterMesh.getBoundingInfo() : (this._boundingInfo || this._updateBoundingInfo(), this._boundingInfo) }, i.prototype.setBoundingInfo = function(e) { return this._boundingInfo = e, this }, Object.defineProperty(i.prototype, "useBones", { get: function() { return this.skeleton && this.getScene().skeletonsEnabled && this.isVerticesDataPresent(e.VertexBuffer.MatricesIndicesKind) && this.isVerticesDataPresent(e.VertexBuffer.MatricesWeightsKind) }, enumerable: !0, configurable: !0 }), i.prototype._preActivate = function() {}, i.prototype._preActivateForIntermediateRendering = function(e) {}, i.prototype._activate = function(e) { this._renderId = e }, i.prototype.getWorldMatrix = function() { return this._masterMesh ? this._masterMesh.getWorldMatrix() : (this._currentRenderId === this.getScene().getRenderId() && this.isSynchronized() || this.computeWorldMatrix(), this._worldMatrix) }, Object.defineProperty(i.prototype, "worldMatrixFromCache", { get: function() { return this._worldMatrix }, enumerable: !0, configurable: !0 }), Object.defineProperty(i.prototype, "absolutePosition", { get: function() { return this._absolutePosition }, enumerable: !0, configurable: !0 }), i.prototype.freezeWorldMatrix = function() { return this._isWorldMatrixFrozen = !1, this.computeWorldMatrix(!0), this._isWorldMatrixFrozen = !0, this }, i.prototype.unfreezeWorldMatrix = function() { return this._isWorldMatrixFrozen = !1, this.computeWorldMatrix(!0), this }, Object.defineProperty(i.prototype, "isWorldMatrixFrozen", { get: function() { return this._isWorldMatrixFrozen }, enumerable: !0, configurable: !0 }), i.prototype.rotate = function(t, r, n) { t.normalize(), this.rotationQuaternion || (this.rotationQuaternion = e.Quaternion.RotationYawPitchRoll(this.rotation.y, this.rotation.x, this.rotation.z), this.rotation = e.Vector3.Zero()); var o; if (n && n !== e.Space.LOCAL) { if (this.parent) { var s = this.parent.getWorldMatrix().clone();
                    s.invert(), t = e.Vector3.TransformNormal(t, s) }
                o = e.Quaternion.RotationAxisToRef(t, r, i._rotationAxisCache), o.multiplyToRef(this.rotationQuaternion, this.rotationQuaternion) } else o = e.Quaternion.RotationAxisToRef(t, r, i._rotationAxisCache), this.rotationQuaternion.multiplyToRef(o, this.rotationQuaternion); return this }, i.prototype.translate = function(t, i, r) { var n = t.scale(i); if (r && r !== e.Space.LOCAL) this.setAbsolutePosition(this.getAbsolutePosition().add(n));
            else { var o = this.getPositionExpressedInLocalSpace().add(n);
                this.setPositionWithLocalVector(o) } return this }, i.prototype.addRotation = function(t, i, r) { var n;
            this.rotationQuaternion ? n = this.rotationQuaternion : (n = e.Tmp.Quaternion[1], e.Quaternion.RotationYawPitchRollToRef(this.rotation.y, this.rotation.x, this.rotation.z, n)); var o = e.Tmp.Quaternion[0]; return e.Quaternion.RotationYawPitchRollToRef(i, t, r, o), n.multiplyInPlace(o), this.rotationQuaternion || n.toEulerAnglesToRef(this.rotation), this }, i.prototype.getAbsolutePosition = function() { return this.computeWorldMatrix(), this._absolutePosition }, i.prototype.setAbsolutePosition = function(t) { if (t) { var i, r, n; if (void 0 === t.x) { if (arguments.length < 3) return;
                    i = arguments[0], r = arguments[1], n = arguments[2] } else i = t.x, r = t.y, n = t.z; if (this.parent) { var o = this.parent.getWorldMatrix().clone();
                    o.invert(); var s = new e.Vector3(i, r, n);
                    this.position = e.Vector3.TransformCoordinates(s, o) } else this.position.x = i, this.position.y = r, this.position.z = n; return this } }, i.prototype.movePOV = function(e, t, i) { return this.position.addInPlace(this.calcMovePOV(e, t, i)), this }, i.prototype.calcMovePOV = function(t, i, r) { var n = new e.Matrix;
            (this.rotationQuaternion ? this.rotationQuaternion : e.Quaternion.RotationYawPitchRoll(this.rotation.y, this.rotation.x, this.rotation.z)).toRotationMatrix(n); var o = e.Vector3.Zero(),
                s = this.definedFacingForward ? -1 : 1; return e.Vector3.TransformCoordinatesFromFloatsToRef(t * s, i, r * s, n, o), o }, i.prototype.rotatePOV = function(e, t, i) { return this.rotation.addInPlace(this.calcRotatePOV(e, t, i)), this }, i.prototype.calcRotatePOV = function(t, i, r) { var n = this.definedFacingForward ? 1 : -1; return new e.Vector3(t * n, i, r * n) }, i.prototype.setPivotMatrix = function(e) { return this._pivotMatrix = e, this._cache.pivotMatrixUpdated = !0, this }, i.prototype.getPivotMatrix = function() { return this._pivotMatrix }, i.prototype._isSynchronized = function() { return !this._isDirty && (this.billboardMode === this._cache.billboardMode && this.billboardMode === i.BILLBOARDMODE_NONE && (!this._cache.pivotMatrixUpdated && (!this.infiniteDistance && (!!this._cache.position.equals(this.position) && (!(this.rotationQuaternion && !this._cache.rotationQuaternion.equals(this.rotationQuaternion)) && (!!this._cache.rotation.equals(this.rotation) && !!this._cache.scaling.equals(this.scaling))))))) }, i.prototype._initCache = function() { t.prototype._initCache.call(this), this._cache.localMatrixUpdated = !1, this._cache.position = e.Vector3.Zero(), this._cache.scaling = e.Vector3.Zero(), this._cache.rotation = e.Vector3.Zero(), this._cache.rotationQuaternion = new e.Quaternion(0, 0, 0, 0), this._cache.billboardMode = -1 }, i.prototype.markAsDirty = function(e) { return "rotation" === e && (this.rotationQuaternion = null), this._currentRenderId = Number.MAX_VALUE, this._isDirty = !0, this }, i.prototype._updateBoundingInfo = function() { return this._boundingInfo = this._boundingInfo || new e.BoundingInfo(this.absolutePosition, this.absolutePosition), this._boundingInfo.update(this.worldMatrixFromCache), this._updateSubMeshesBoundingInfo(this.worldMatrixFromCache), this }, i.prototype._updateSubMeshesBoundingInfo = function(e) { if (this.subMeshes) { for (var t = 0; t < this.subMeshes.length; t++) { var i = this.subMeshes[t];
                    i.IsGlobal || i.updateBoundingInfo(e) } return this } }, i.prototype.computeWorldMatrix = function(t) {
            if (this._isWorldMatrixFrozen) return this._worldMatrix;
            if (!t && this.isSynchronized(!0)) return this._currentRenderId = this.getScene().getRenderId(), this._worldMatrix;
            if (this._cache.position.copyFrom(this.position), this._cache.scaling.copyFrom(this.scaling), this._cache.pivotMatrixUpdated = !1, this._cache.billboardMode = this.billboardMode, this._currentRenderId = this.getScene().getRenderId(), this._isDirty = !1, e.Matrix.ScalingToRef(this.scaling.x * this.scalingDeterminant, this.scaling.y * this.scalingDeterminant, this.scaling.z * this.scalingDeterminant, e.Tmp.Matrix[1]), this.rotationQuaternion) { this.rotation.length() && (this.rotationQuaternion.multiplyInPlace(e.Quaternion.RotationYawPitchRoll(this.rotation.y, this.rotation.x, this.rotation.z)), this.rotation.copyFromFloats(0, 0, 0)) }
            if (this.rotationQuaternion ? (this.rotationQuaternion.toRotationMatrix(e.Tmp.Matrix[0]), this._cache.rotationQuaternion.copyFrom(this.rotationQuaternion)) : (e.Matrix.RotationYawPitchRollToRef(this.rotation.y, this.rotation.x, this.rotation.z, e.Tmp.Matrix[0]), this._cache.rotation.copyFrom(this.rotation)), this.infiniteDistance && !this.parent) { var r = this.getScene().activeCamera; if (r) { var n = r.getWorldMatrix(),
                        o = new e.Vector3(n.m[12], n.m[13], n.m[14]);
                    e.Matrix.TranslationToRef(this.position.x + o.x, this.position.y + o.y, this.position.z + o.z, e.Tmp.Matrix[2]) } } else e.Matrix.TranslationToRef(this.position.x, this.position.y, this.position.z, e.Tmp.Matrix[2]);
            if (this._pivotMatrix.multiplyToRef(e.Tmp.Matrix[1], e.Tmp.Matrix[4]), e.Tmp.Matrix[4].multiplyToRef(e.Tmp.Matrix[0], e.Tmp.Matrix[5]), this.billboardMode !== i.BILLBOARDMODE_NONE && this.getScene().activeCamera) { if ((this.billboardMode & i.BILLBOARDMODE_ALL) !== i.BILLBOARDMODE_ALL) { var s = e.Tmp.Vector3[3];
                    this.parent && this.parent.getWorldMatrix ? this._meshToBoneReferal ? (this.parent.getWorldMatrix().multiplyToRef(this._meshToBoneReferal.getWorldMatrix(), e.Tmp.Matrix[6]), e.Vector3.TransformCoordinatesToRef(this.position, e.Tmp.Matrix[6], s)) : e.Vector3.TransformCoordinatesToRef(this.position, this.parent.getWorldMatrix(), s) : s.copyFrom(this.position), s.subtractInPlace(this.getScene().activeCamera.globalPosition); var a = e.Tmp.Vector3[4].copyFromFloats(0, 0, 0);
                    (this.billboardMode & i.BILLBOARDMODE_X) === i.BILLBOARDMODE_X && (a.x = Math.atan2(-s.y, s.z)), (this.billboardMode & i.BILLBOARDMODE_Y) === i.BILLBOARDMODE_Y && (a.y = Math.atan2(s.x, s.z)), (this.billboardMode & i.BILLBOARDMODE_Z) === i.BILLBOARDMODE_Z && (a.z = Math.atan2(s.y, s.x)), e.Matrix.RotationYawPitchRollToRef(a.y, a.x, a.z, e.Tmp.Matrix[0]) } else e.Tmp.Matrix[1].copyFrom(this.getScene().activeCamera.getViewMatrix()), e.Tmp.Matrix[1].setTranslationFromFloats(0, 0, 0), e.Tmp.Matrix[1].invertToRef(e.Tmp.Matrix[0]);
                e.Tmp.Matrix[1].copyFrom(e.Tmp.Matrix[5]), e.Tmp.Matrix[1].multiplyToRef(e.Tmp.Matrix[0], e.Tmp.Matrix[5]) }
            return e.Tmp.Matrix[5].multiplyToRef(e.Tmp.Matrix[2], this._localWorld), this.parent && this.parent.getWorldMatrix ? (this._markSyncedWithParent(), this.billboardMode !== i.BILLBOARDMODE_NONE ? (this._meshToBoneReferal ? (this.parent.getWorldMatrix().multiplyToRef(this._meshToBoneReferal.getWorldMatrix(), e.Tmp.Matrix[6]),
                e.Tmp.Matrix[5].copyFrom(e.Tmp.Matrix[6])) : e.Tmp.Matrix[5].copyFrom(this.parent.getWorldMatrix()), this._localWorld.getTranslationToRef(e.Tmp.Vector3[5]), e.Vector3.TransformCoordinatesToRef(e.Tmp.Vector3[5], e.Tmp.Matrix[5], e.Tmp.Vector3[5]), this._worldMatrix.copyFrom(this._localWorld), this._worldMatrix.setTranslation(e.Tmp.Vector3[5])) : this._meshToBoneReferal ? (this._localWorld.multiplyToRef(this.parent.getWorldMatrix(), e.Tmp.Matrix[6]), e.Tmp.Matrix[6].multiplyToRef(this._meshToBoneReferal.getWorldMatrix(), this._worldMatrix)) : this._localWorld.multiplyToRef(this.parent.getWorldMatrix(), this._worldMatrix)) : this._worldMatrix.copyFrom(this._localWorld), this._updateBoundingInfo(), this._absolutePosition.copyFromFloats(this._worldMatrix.m[12], this._worldMatrix.m[13], this._worldMatrix.m[14]), this.onAfterWorldMatrixUpdateObservable.notifyObservers(this), this._poseMatrix || (this._poseMatrix = e.Matrix.Invert(this._worldMatrix)), this._worldMatrix
        }, i.prototype.registerAfterWorldMatrixUpdate = function(e) { return this.onAfterWorldMatrixUpdateObservable.add(e), this }, i.prototype.unregisterAfterWorldMatrixUpdate = function(e) { return this.onAfterWorldMatrixUpdateObservable.removeCallback(e), this }, i.prototype.setPositionWithLocalVector = function(t) { return this.computeWorldMatrix(), this.position = e.Vector3.TransformNormal(t, this._localWorld), this }, i.prototype.getPositionExpressedInLocalSpace = function() { this.computeWorldMatrix(); var t = this._localWorld.clone(); return t.invert(), e.Vector3.TransformNormal(this.position, t) }, i.prototype.locallyTranslate = function(t) { return this.computeWorldMatrix(!0), this.position = e.Vector3.TransformCoordinates(t, this._localWorld), this }, i.prototype.lookAt = function(t, r, n, o, s) { void 0 === r && (r = 0), void 0 === n && (n = 0), void 0 === o && (o = 0), void 0 === s && (s = e.Space.LOCAL); var a = i._lookAtVectorCache,
                h = s === e.Space.LOCAL ? this.position : this.getAbsolutePosition();
            t.subtractToRef(h, a); var l = -Math.atan2(a.z, a.x) - Math.PI / 2,
                c = Math.sqrt(a.x * a.x + a.z * a.z),
                u = Math.atan2(a.y, c); return this.rotationQuaternion = this.rotationQuaternion || new e.Quaternion, e.Quaternion.RotationYawPitchRollToRef(l + r, u + n, o, this.rotationQuaternion), this }, i.prototype.attachToBone = function(e, t) { return this._meshToBoneReferal = t, this.parent = e, e.getWorldMatrix().determinant() < 0 && (this.scalingDeterminant *= -1), this }, i.prototype.detachFromBone = function() { return this.parent.getWorldMatrix().determinant() < 0 && (this.scalingDeterminant *= -1), this._meshToBoneReferal = null, this.parent = null, this }, i.prototype.isInFrustum = function(e) { return this._boundingInfo.isInFrustum(e) }, i.prototype.isCompletelyInFrustum = function(e) { return this._boundingInfo.isCompletelyInFrustum(e) }, i.prototype.intersectsMesh = function(e, t) { return !(!this._boundingInfo || !e._boundingInfo) && this._boundingInfo.intersects(e._boundingInfo, t) }, i.prototype.intersectsPoint = function(e) { return !!this._boundingInfo && this._boundingInfo.intersectsPoint(e) }, i.prototype.getPhysicsImpostor = function() { return this.physicsImpostor }, i.prototype.getPositionInCameraSpace = function(t) { return t || (t = this.getScene().activeCamera), e.Vector3.TransformCoordinates(this.absolutePosition, t.getViewMatrix()) }, i.prototype.getDistanceToCamera = function(e) { return e || (e = this.getScene().activeCamera), this.absolutePosition.subtract(e.position).length() }, i.prototype.applyImpulse = function(e, t) { if (this.physicsImpostor) return this.physicsImpostor.applyImpulse(e, t), this }, i.prototype.setPhysicsLinkWith = function(t, i, r, n) { if (this.physicsImpostor && t.physicsImpostor) return this.physicsImpostor.createJoint(t.physicsImpostor, e.PhysicsJoint.HingeJoint, { mainPivot: i, connectedPivot: r, nativeParams: n }), this }, Object.defineProperty(i.prototype, "checkCollisions", { get: function() { return this._checkCollisions }, set: function(e) { this._checkCollisions = e, this.getScene().workerCollisions && this.getScene().collisionCoordinator.onMeshUpdated(this) }, enumerable: !0, configurable: !0 }), i.prototype.moveWithCollisions = function(t) { return this.getAbsolutePosition().subtractFromFloatsToRef(0, this.ellipsoid.y, 0, this._oldPositionForCollisions), this._oldPositionForCollisions.addInPlace(this.ellipsoidOffset), this._collider || (this._collider = new e.Collider), this._collider.radius = this.ellipsoid, this.getScene().collisionCoordinator.getNewPosition(this._oldPositionForCollisions, t, this._collider, 3, this, this._onCollisionPositionChange, this.uniqueId), this }, i.prototype.createOrUpdateSubmeshesOctree = function(t, i) { void 0 === t && (t = 64), void 0 === i && (i = 2), this._submeshesOctree || (this._submeshesOctree = new e.Octree(e.Octree.CreationFuncForSubMeshes, t, i)), this.computeWorldMatrix(!0); var r = this.getBoundingInfo().boundingBox; return this._submeshesOctree.update(r.minimumWorld, r.maximumWorld, this.subMeshes), this._submeshesOctree }, i.prototype._collideForSubMesh = function(t, i, r) { if (this._generatePointsArray(), !t._lastColliderWorldVertices || !t._lastColliderTransformMatrix.equals(i)) { t._lastColliderTransformMatrix = i.clone(), t._lastColliderWorldVertices = [], t._trianglePlanes = []; for (var n = t.verticesStart, o = t.verticesStart + t.verticesCount, s = n; s < o; s++) t._lastColliderWorldVertices.push(e.Vector3.TransformCoordinates(this._positions[s], i)) } return r._collide(t._trianglePlanes, t._lastColliderWorldVertices, this.getIndices(), t.indexStart, t.indexStart + t.indexCount, t.verticesStart, !!t.getMaterial()), r.collisionFound && (r.collidedMesh = this), this }, i.prototype._processCollisionsForSubMeshes = function(e, t) { var i, r; if (this._submeshesOctree && this.useOctreeForCollisions) { var n = e.velocityWorldLength + Math.max(e.radius.x, e.radius.y, e.radius.z),
                    o = this._submeshesOctree.intersects(e.basePointWorld, n);
                r = o.length, i = o.data } else i = this.subMeshes, r = i.length; for (var s = 0; s < r; s++) { var a = i[s];
                r > 1 && !a._checkCollision(e) || this._collideForSubMesh(a, t, e) } return this }, i.prototype._checkCollision = function(t) { return this._boundingInfo._checkCollision(t) ? (e.Matrix.ScalingToRef(1 / t.radius.x, 1 / t.radius.y, 1 / t.radius.z, this._collisionsScalingMatrix), this.worldMatrixFromCache.multiplyToRef(this._collisionsScalingMatrix, this._collisionsTransformMatrix), this._processCollisionsForSubMeshes(t, this._collisionsTransformMatrix), this) : this }, i.prototype._generatePointsArray = function() { return !1 }, i.prototype.intersects = function(t, i) { var r = new e.PickingInfo; if (!(this.subMeshes && this._boundingInfo && t.intersectsSphere(this._boundingInfo.boundingSphere) && t.intersectsBox(this._boundingInfo.boundingBox))) return r; if (!this._generatePointsArray()) return r; var n, o, s = null; if (this._submeshesOctree && this.useOctreeForPicking) { var a = e.Ray.Transform(t, this.getWorldMatrix()),
                    h = this._submeshesOctree.intersectsRay(a);
                o = h.length, n = h.data } else n = this.subMeshes, o = n.length; for (var l = 0; l < o; l++) { var c = n[l]; if (!(o > 1) || c.canIntersects(t)) { var u = c.intersects(t, this._positions, this.getIndices(), i); if (u && (i || !s || u.distance < s.distance) && (s = u, s.subMeshId = l, i)) break } } if (s) { var d = this.getWorldMatrix(),
                    f = e.Vector3.TransformCoordinates(t.origin, d),
                    p = t.direction.clone();
                p = p.scale(s.distance); var _ = e.Vector3.TransformNormal(p, d),
                    m = f.add(_); return r.hit = !0, r.distance = e.Vector3.Distance(f, m), r.pickedPoint = m, r.pickedMesh = this, r.bu = s.bu, r.bv = s.bv, r.faceId = s.faceId, r.subMeshId = s.subMeshId, r } return r }, i.prototype.clone = function(e, t, i) { return null }, i.prototype.releaseSubMeshes = function() { if (this.subMeshes)
                for (; this.subMeshes.length;) this.subMeshes[0].dispose();
            else this.subMeshes = new Array; return this }, i.prototype.dispose = function(e) { var i, r = this; for (this.actionManager && (this.actionManager.dispose(), this.actionManager = null), this.skeleton = null, this.getScene().stopAnimation(this), this.physicsImpostor && this.physicsImpostor.dispose(), i = 0; i < this._intersectionsInProgress.length; i++) { var n = this._intersectionsInProgress[i],
                    o = n._intersectionsInProgress.indexOf(this);
                n._intersectionsInProgress.splice(o, 1) }
            this._intersectionsInProgress = [], this.getScene().lights.forEach((function(e) { var t = e.includedOnlyMeshes.indexOf(r);
                t !== -1 && e.includedOnlyMeshes.splice(t, 1), (t = e.excludedMeshes.indexOf(r)) !== -1 && e.excludedMeshes.splice(t, 1); var i = e.getShadowGenerator();
                i && (t = i.getShadowMap().renderList.indexOf(r)) !== -1 && i.getShadowMap().renderList.splice(t, 1) })), this._edgesRenderer && (this._edgesRenderer.dispose(), this._edgesRenderer = null), "InstancedMesh" !== this.getClassName() && this.releaseSubMeshes(); var s = this.getScene().selectionOctree; if (s) { var i = s.dynamicContent.indexOf(this);
                i !== -1 && s.dynamicContent.splice(i, 1) } if (this.getScene().getEngine().wipeCaches(), this.getScene().removeMesh(this), e) { var a = this.getChildMeshes(!0); for (i = 0; i < a.length; i++) { var h = a[i];
                    h.parent = null, h.computeWorldMatrix(!0) } } else { for (i = 0; i < this.getScene().particleSystems.length; i++) this.getScene().particleSystems[i].emitter === this && (this.getScene().particleSystems[i].dispose(), i--); var l = this.getDescendants(!0); for (i = 0; i < l.length; i++) l[i].dispose() }
            this._facetDataEnabled && this.disableFacetData(), this.onAfterWorldMatrixUpdateObservable.clear(), this.onCollideObservable.clear(), this.onCollisionPositionChangeObservable.clear(), this._isDisposed = !0, t.prototype.dispose.call(this) }, i.prototype.getDirection = function(t) { var i = e.Vector3.Zero(); return this.getDirectionToRef(t, i), i }, i.prototype.getDirectionToRef = function(t, i) { return e.Vector3.TransformNormalToRef(t, this.getWorldMatrix(), i), this }, i.prototype.setPivotPoint = function(t, i) { void 0 === i && (i = e.Space.LOCAL), 0 == this.getScene().getRenderId() && this.computeWorldMatrix(!0); var r = this.getWorldMatrix(); if (i == e.Space.WORLD) { var n = e.Tmp.Matrix[0];
                r.invertToRef(n), t = e.Vector3.TransformCoordinates(t, n) } return e.Vector3.TransformCoordinatesToRef(t, r, this.position), this._pivotMatrix.m[12] = -t.x, this._pivotMatrix.m[13] = -t.y, this._pivotMatrix.m[14] = -t.z, this._cache.pivotMatrixUpdated = !0, this }, i.prototype.getPivotPoint = function() { var t = e.Vector3.Zero(); return this.getPivotPointToRef(t), t }, i.prototype.getPivotPointToRef = function(e) { return e.x = -this._pivotMatrix.m[12], e.y = -this._pivotMatrix.m[13], e.z = -this._pivotMatrix.m[14], this }, i.prototype.getAbsolutePivotPoint = function() { var t = e.Vector3.Zero(); return this.getAbsolutePivotPointToRef(t), t }, i.prototype.setParent = function(t, i) { void 0 === i && (i = !1); var r = this,
                n = t; if (null == t) { if (r.parent && i) { var o = e.Tmp.Quaternion[0],
                        s = e.Tmp.Vector3[0],
                        a = e.Tmp.Vector3[1];
                    r.getWorldMatrix().decompose(a, o, s), r.rotationQuaternion ? r.rotationQuaternion.copyFrom(o) : o.toEulerAnglesToRef(r.rotation), r.position.x = s.x, r.position.y = s.y, r.position.z = s.z } } else if (i) { var o = e.Tmp.Quaternion[0],
                    s = e.Tmp.Vector3[0],
                    a = e.Tmp.Vector3[1],
                    h = e.Tmp.Matrix[0],
                    l = e.Tmp.Matrix[1];
                n.getWorldMatrix().decompose(a, o, s), o.toRotationMatrix(h), l.setTranslation(s), l.multiplyToRef(h, h); var c = e.Matrix.Invert(h),
                    u = r.getWorldMatrix().multiply(c);
                u.decompose(a, o, s), r.rotationQuaternion ? r.rotationQuaternion.copyFrom(o) : o.toEulerAnglesToRef(r.rotation), c = e.Matrix.Invert(n.getWorldMatrix()); var u = r.getWorldMatrix().multiply(c);
                u.decompose(a, o, s), r.position.x = s.x, r.position.y = s.y, r.position.z = s.z } return r.parent = n, this }, i.prototype.addChild = function(e, t) { return void 0 === t && (t = !1), e.setParent(this, t), this }, i.prototype.removeChild = function(e, t) { return void 0 === t && (t = !1), e.setParent(null, t), this }, i.prototype.getAbsolutePivotPointToRef = function(t) { return t.x = this._pivotMatrix.m[12], t.y = this._pivotMatrix.m[13], t.z = this._pivotMatrix.m[14], this.getPivotPointToRef(t), e.Vector3.TransformCoordinatesToRef(t, this.getWorldMatrix(), t), this }, i.prototype._initFacetData = function() { this._facetNormals || (this._facetNormals = new Array), this._facetPositions || (this._facetPositions = new Array), this._facetPartitioning || (this._facetPartitioning = new Array), this._facetNb = this.getIndices().length / 3, this._partitioningSubdivisions = this._partitioningSubdivisions ? this._partitioningSubdivisions : 10, this._partitioningBBoxRatio = this._partitioningBBoxRatio ? this._partitioningBBoxRatio : 1.01; for (var t = 0; t < this._facetNb; t++) this._facetNormals[t] = e.Vector3.Zero(), this._facetPositions[t] = e.Vector3.Zero(); return this._facetDataEnabled = !0, this }, i.prototype.updateFacetData = function() { this._facetDataEnabled || this._initFacetData(); var t = this.getVerticesData(e.VertexBuffer.PositionKind),
                i = this.getIndices(),
                r = this.getVerticesData(e.VertexBuffer.NormalKind),
                n = this.getBoundingInfo();
            this._bbSize.x = n.maximum.x - n.minimum.x > e.Epsilon ? n.maximum.x - n.minimum.x : e.Epsilon, this._bbSize.y = n.maximum.y - n.minimum.y > e.Epsilon ? n.maximum.y - n.minimum.y : e.Epsilon, this._bbSize.z = n.maximum.z - n.minimum.z > e.Epsilon ? n.maximum.z - n.minimum.z : e.Epsilon; var o = this._bbSize.x > this._bbSize.y ? this._bbSize.x : this._bbSize.y; return o = o > this._bbSize.z ? o : this._bbSize.z, this._subDiv.max = this._partitioningSubdivisions, this._subDiv.X = Math.floor(this._subDiv.max * this._bbSize.x / o), this._subDiv.Y = Math.floor(this._subDiv.max * this._bbSize.y / o), this._subDiv.Z = Math.floor(this._subDiv.max * this._bbSize.z / o), this._subDiv.X = this._subDiv.X < 1 ? 1 : this._subDiv.X, this._subDiv.Y = this._subDiv.Y < 1 ? 1 : this._subDiv.Y, this._subDiv.Z = this._subDiv.Z < 1 ? 1 : this._subDiv.Z, this._facetParameters.facetNormals = this.getFacetLocalNormals(), this._facetParameters.facetPositions = this.getFacetLocalPositions(), this._facetParameters.facetPartitioning = this.getFacetLocalPartitioning(), this._facetParameters.bInfo = n, this._facetParameters.bbSize = this._bbSize, this._facetParameters.subDiv = this._subDiv, this._facetParameters.ratio = this.partitioningBBoxRatio, e.VertexData.ComputeNormals(t, i, r, this._facetParameters), this }, i.prototype.getFacetLocalNormals = function() { return this._facetNormals || this.updateFacetData(), this._facetNormals }, i.prototype.getFacetLocalPositions = function() { return this._facetPositions || this.updateFacetData(), this._facetPositions }, i.prototype.getFacetLocalPartitioning = function() { return this._facetPartitioning || this.updateFacetData(), this._facetPartitioning }, i.prototype.getFacetPosition = function(t) { var i = e.Vector3.Zero(); return this.getFacetPositionToRef(t, i), i }, i.prototype.getFacetPositionToRef = function(t, i) { var r = this.getFacetLocalPositions()[t],
                n = this.getWorldMatrix(); return e.Vector3.TransformCoordinatesToRef(r, n, i), this }, i.prototype.getFacetNormal = function(t) { var i = e.Vector3.Zero(); return this.getFacetNormalToRef(t, i), i }, i.prototype.getFacetNormalToRef = function(t, i) { var r = this.getFacetLocalNormals()[t]; return e.Vector3.TransformNormalToRef(r, this.getWorldMatrix(), i), this }, i.prototype.getFacetsAtLocalCoordinates = function(e, t, i) { var r = this.getBoundingInfo(),
                n = Math.floor((e - r.minimum.x * this._partitioningBBoxRatio) * this._subDiv.X * this._partitioningBBoxRatio / this._bbSize.x),
                o = Math.floor((t - r.minimum.y * this._partitioningBBoxRatio) * this._subDiv.Y * this._partitioningBBoxRatio / this._bbSize.y),
                s = Math.floor((i - r.minimum.z * this._partitioningBBoxRatio) * this._subDiv.Z * this._partitioningBBoxRatio / this._bbSize.z); return n < 0 || n > this._subDiv.max || o < 0 || o > this._subDiv.max || s < 0 || s > this._subDiv.max ? null : this._facetPartitioning[n + this._subDiv.max * o + this._subDiv.max * this._subDiv.max * s] }, i.prototype.getClosestFacetAtCoordinates = function(t, i, r, n, o, s) { void 0 === o && (o = !1), void 0 === s && (s = !0); var a = this.getWorldMatrix(),
                h = e.Tmp.Matrix[5];
            a.invertToRef(h); var l = e.Tmp.Vector3[8],
                c = null; return e.Vector3.TransformCoordinatesFromFloatsToRef(t, i, r, h, l), c = this.getClosestFacetAtLocalCoordinates(l.x, l.y, l.z, n, o, s), n && e.Vector3.TransformCoordinatesFromFloatsToRef(n.x, n.y, n.z, a, n), c }, i.prototype.getClosestFacetAtLocalCoordinates = function(e, t, i, r, n, o) { void 0 === n && (n = !1), void 0 === o && (o = !0); var s = null,
                a = 0,
                h = 0,
                l = 0,
                c = 0,
                u = 0,
                d = 0,
                f = 0,
                p = 0,
                _ = this.getFacetLocalPositions(),
                m = this.getFacetLocalNormals(),
                g = this.getFacetsAtLocalCoordinates(e, t, i); if (!g) return null; for (var v, y, x, b = Number.MAX_VALUE, A = b, E = 0; E < g.length; E++) v = g[E], y = m[v], x = _[v], c = (e - x.x) * y.x + (t - x.y) * y.y + (i - x.z) * y.z, (!n || n && o && c >= 0 || n && !o && c <= 0) && (c = y.x * x.x + y.y * x.y + y.z * x.z, u = -(y.x * e + y.y * t + y.z * i - c) / (y.x * y.x + y.y * y.y + y.z * y.z), d = e + y.x * u, f = t + y.y * u, p = i + y.z * u, a = d - e, h = f - t, l = p - i, (A = a * a + h * h + l * l) < b && (b = A, s = v, r && (r.x = d, r.y = f, r.z = p))); return s }, i.prototype.getFacetDataParameters = function() { return this._facetParameters }, i.prototype.disableFacetData = function() { return this._facetDataEnabled && (this._facetDataEnabled = !1, this._facetPositions = null, this._facetNormals = null, this._facetPartitioning = null, this._facetParameters = null), this }, i.prototype.createNormals = function(t) { var i, r = this.getVerticesData(e.VertexBuffer.PositionKind),
                n = this.getIndices();
            i = this.isVerticesDataPresent(e.VertexBuffer.NormalKind) ? this.getVerticesData(e.VertexBuffer.NormalKind) : [], e.VertexData.ComputeNormals(r, n, i), this.setVerticesData(e.VertexBuffer.NormalKind, i, t) }, i
    })(e.Node);
    t._BILLBOARDMODE_NONE = 0, t._BILLBOARDMODE_X = 1, t._BILLBOARDMODE_Y = 2, t._BILLBOARDMODE_Z = 4, t._BILLBOARDMODE_ALL = 7, t._rotationAxisCache = new e.Quaternion, t._lookAtVectorCache = new e.Vector3(0, 0, 0), e.AbstractMesh = t
})(BABYLON || (BABYLON = {}));
var BABYLON;
!(function(e) { var t = (function(t) {
        function i(i, r) { var n = t.call(this, i, r) || this; return n.diffuse = new e.Color3(1, 1, 1), n.specular = new e.Color3(1, 1, 1), n.intensity = 1, n.range = Number.MAX_VALUE, n._excludeWithLayerMask = 0, n._includeOnlyWithLayerMask = 0, n._lightmapMode = 0, n.radius = 1e-5, n._excludedMeshesIds = new Array, n._includedOnlyMeshesIds = new Array, n.getScene().addLight(n), n.includedOnlyMeshes = new Array, n.excludedMeshes = new Array, n._resyncMeshes(), n } return __extends(i, t), Object.defineProperty(i, "LIGHTMAP_DEFAULT", { get: function() { return i._LIGHTMAP_DEFAULT }, enumerable: !0, configurable: !0 }), Object.defineProperty(i, "LIGHTMAP_SPECULAR", { get: function() { return i._LIGHTMAP_SPECULAR }, enumerable: !0, configurable: !0 }), Object.defineProperty(i, "LIGHTMAP_SHADOWSONLY", { get: function() { return i._LIGHTMAP_SHADOWSONLY }, enumerable: !0, configurable: !0 }), Object.defineProperty(i.prototype, "includedOnlyMeshes", { get: function() { return this._includedOnlyMeshes }, set: function(e) { this._includedOnlyMeshes = e, this._hookArrayForIncludedOnly(e) }, enumerable: !0, configurable: !0 }), Object.defineProperty(i.prototype, "excludedMeshes", { get: function() { return this._excludedMeshes }, set: function(e) { this._excludedMeshes = e, this._hookArrayForExcluded(e) }, enumerable: !0, configurable: !0 }), Object.defineProperty(i.prototype, "excludeWithLayerMask", { get: function() { return this._excludeWithLayerMask }, set: function(e) { this._excludeWithLayerMask = e, this._resyncMeshes() }, enumerable: !0, configurable: !0 }), Object.defineProperty(i.prototype, "includeOnlyWithLayerMask", { get: function() { return this._includeOnlyWithLayerMask }, set: function(e) { this._includeOnlyWithLayerMask = e, this._resyncMeshes() }, enumerable: !0, configurable: !0 }), Object.defineProperty(i.prototype, "lightmapMode", { get: function() { return this._lightmapMode }, set: function(e) { this._lightmapMode !== e && (this._lightmapMode = e, this._markMeshesAsLightDirty()) }, enumerable: !0, configurable: !0 }), i.prototype.getClassName = function() { return "Light" }, i.prototype.toString = function(e) { var t = "Name: " + this.name; if (t += ", type: " + ["Point", "Directional", "Spot", "Hemispheric"][this.getTypeID()], this.animations)
                for (var i = 0; i < this.animations.length; i++) t += ", animation[0]: " + this.animations[i].toString(e); return t }, i.prototype.setEnabled = function(e) { t.prototype.setEnabled.call(this, e), this._resyncMeshes() }, i.prototype.getShadowGenerator = function() { return this._shadowGenerator }, i.prototype.getAbsolutePosition = function() { return e.Vector3.Zero() }, i.prototype.transferToEffect = function(e, t, i) {}, i.prototype._getWorldMatrix = function() { return e.Matrix.Identity() }, i.prototype.canAffectMesh = function(e) { return !e || !(this.includedOnlyMeshes.length > 0 && this.includedOnlyMeshes.indexOf(e) === -1) && (!(this.excludedMeshes.length > 0 && this.excludedMeshes.indexOf(e) !== -1) && ((0 === this.includeOnlyWithLayerMask || 0 != (this.includeOnlyWithLayerMask & e.layerMask)) && !(0 !== this.excludeWithLayerMask && this.excludeWithLayerMask & e.layerMask))) }, i.prototype.getWorldMatrix = function() { this._currentRenderId = this.getScene().getRenderId(); var t = this._getWorldMatrix(); return this.parent && this.parent.getWorldMatrix ? (this._parentedWorldMatrix || (this._parentedWorldMatrix = e.Matrix.Identity()), t.multiplyToRef(this.parent.getWorldMatrix(), this._parentedWorldMatrix), this._markSyncedWithParent(), this._parentedWorldMatrix) : t }, i.prototype.dispose = function() { this._shadowGenerator && (this._shadowGenerator.dispose(), this._shadowGenerator = null), this.getScene().stopAnimation(this); for (var e = 0, i = this.getScene().meshes; e < i.length; e++) { i[e]._removeLightSource(this) }
            this.getScene().removeLight(this), t.prototype.dispose.call(this) }, i.prototype.getTypeID = function() { return 0 }, i.prototype.clone = function(t) { return e.SerializationHelper.Clone(i.GetConstructorFromName(this.getTypeID(), t, this.getScene()), this) }, i.prototype.serialize = function() { var t = e.SerializationHelper.Serialize(this); return t.type = this.getTypeID(), this.parent && (t.parentId = this.parent.id), this.excludedMeshes.length > 0 && (t.excludedMeshesIds = [], this.excludedMeshes.forEach((function(e) { t.excludedMeshesIds.push(e.id) }))), this.includedOnlyMeshes.length > 0 && (t.includedOnlyMeshesIds = [], this.includedOnlyMeshes.forEach((function(e) { t.includedOnlyMeshesIds.push(e.id) }))), e.Animation.AppendSerializedAnimations(this, t), t.ranges = this.serializeAnimationRanges(), t }, i.GetConstructorFromName = function(t, i, r) { switch (t) {
                case 0:
                    return function() { return new e.PointLight(i, e.Vector3.Zero(), r) };
                case 1:
                    return function() { return new e.DirectionalLight(i, e.Vector3.Zero(), r) };
                case 2:
                    return function() { return new e.SpotLight(i, e.Vector3.Zero(), e.Vector3.Zero(), 0, 0, r) };
                case 3:
                    return function() { return new e.HemisphericLight(i, e.Vector3.Zero(), r) } } }, i.Parse = function(t, r) { var n = e.SerializationHelper.Parse(i.GetConstructorFromName(t.type, t.name, r), t, r); if (t.excludedMeshesIds && (n._excludedMeshesIds = t.excludedMeshesIds), t.includedOnlyMeshesIds && (n._includedOnlyMeshesIds = t.includedOnlyMeshesIds), t.parentId && (n._waitingParentId = t.parentId), t.animations) { for (var o = 0; o < t.animations.length; o++) { var s = t.animations[o];
                    n.animations.push(e.Animation.Parse(s)) }
                e.Node.ParseAnimationRanges(n, t, r) } return t.autoAnimate && r.beginAnimation(n, t.autoAnimateFrom, t.autoAnimateTo, t.autoAnimateLoop, t.autoAnimateSpeed || 1), n }, i.prototype._hookArrayForExcluded = function(e) { var t = this,
                i = e.push;
            e.push = function() { for (var r = [], n = 0; n < arguments.length; n++) r[n] = arguments[n]; for (var o = i.apply(e, r), s = 0, a = r; s < a.length; s++) { a[s]._resyncLighSource(t) } return o }; var r = e.splice;
            e.splice = function(i, n) { for (var o = r.apply(e, [i, n]), s = 0, a = o; s < a.length; s++) { a[s]._resyncLighSource(t) } return o } }, i.prototype._hookArrayForIncludedOnly = function(e) { var t = this,
                i = e.push;
            e.push = function() { for (var r = [], n = 0; n < arguments.length; n++) r[n] = arguments[n]; var o = i.apply(e, r); return t._resyncMeshes(), o }; var r = e.splice;
            e.splice = function(i, n) { var o = r.apply(e, [i, n]); return t._resyncMeshes(), o } }, i.prototype._resyncMeshes = function() { for (var e = 0, t = this.getScene().meshes; e < t.length; e++) { t[e]._resyncLighSource(this) } }, i.prototype._markMeshesAsLightDirty = function() { for (var e = 0, t = this.getScene().meshes; e < t.length; e++) { var i = t[e];
                i._lightSources.indexOf(this) !== -1 && i._markSubMeshesAsLightDirty() } }, i })(e.Node);
    t._LIGHTMAP_DEFAULT = 0, t._LIGHTMAP_SPECULAR = 1, t._LIGHTMAP_SHADOWSONLY = 2, __decorate([e.serializeAsColor3()], t.prototype, "diffuse", void 0), __decorate([e.serializeAsColor3()], t.prototype, "specular", void 0), __decorate([e.serialize()], t.prototype, "intensity", void 0), __decorate([e.serialize()], t.prototype, "range", void 0), __decorate([e.serialize("excludeWithLayerMask")], t.prototype, "_excludeWithLayerMask", void 0), __decorate([e.serialize("includeOnlyWithLayerMask")], t.prototype, "_includeOnlyWithLayerMask", void 0), __decorate([e.serialize("lightmapMode")], t.prototype, "_lightmapMode", void 0), __decorate([e.serialize()], t.prototype, "radius", void 0), e.Light = t })(BABYLON || (BABYLON = {}));
var BABYLON;
!(function(e) {
    var t = (function(t) {
        function i(r, n, o) { var s = t.call(this, r, o) || this; return s.upVector = e.Vector3.Up(), s.orthoLeft = null, s.orthoRight = null, s.orthoBottom = null, s.orthoTop = null, s.fov = .8, s.minZ = 1, s.maxZ = 1e4, s.inertia = .9, s.mode = i.PERSPECTIVE_CAMERA, s.isIntermediate = !1, s.viewport = new e.Viewport(0, 0, 1, 1), s.layerMask = 268435455, s.fovMode = i.FOVMODE_VERTICAL_FIXED, s.cameraRigMode = i.RIG_MODE_NONE, s._rigCameras = new Array, s._webvrViewMatrix = e.Matrix.Identity(), s._computedViewMatrix = e.Matrix.Identity(), s._projectionMatrix = new e.Matrix, s._doNotComputeProjectionMatrix = !1, s._postProcesses = new Array, s._transformMatrix = e.Matrix.Zero(), s._activeMeshes = new e.SmartArray(256), s._globalPosition = e.Vector3.Zero(), s._refreshFrustumPlanes = !0, s.getScene().addCamera(s), s.getScene().activeCamera || (s.getScene().activeCamera = s), s.position = n, s }
        return __extends(i, t), Object.defineProperty(i, "PERSPECTIVE_CAMERA", { get: function() { return i._PERSPECTIVE_CAMERA }, enumerable: !0, configurable: !0 }), Object.defineProperty(i, "ORTHOGRAPHIC_CAMERA", { get: function() { return i._ORTHOGRAPHIC_CAMERA }, enumerable: !0, configurable: !0 }), Object.defineProperty(i, "FOVMODE_VERTICAL_FIXED", { get: function() { return i._FOVMODE_VERTICAL_FIXED }, enumerable: !0, configurable: !0 }), Object.defineProperty(i, "FOVMODE_HORIZONTAL_FIXED", { get: function() { return i._FOVMODE_HORIZONTAL_FIXED }, enumerable: !0, configurable: !0 }), Object.defineProperty(i, "RIG_MODE_NONE", { get: function() { return i._RIG_MODE_NONE }, enumerable: !0, configurable: !0 }), Object.defineProperty(i, "RIG_MODE_STEREOSCOPIC_ANAGLYPH", { get: function() { return i._RIG_MODE_STEREOSCOPIC_ANAGLYPH }, enumerable: !0, configurable: !0 }), Object.defineProperty(i, "RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL", { get: function() { return i._RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL }, enumerable: !0, configurable: !0 }), Object.defineProperty(i, "RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED", { get: function() { return i._RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED }, enumerable: !0, configurable: !0 }), Object.defineProperty(i, "RIG_MODE_STEREOSCOPIC_OVERUNDER", { get: function() { return i._RIG_MODE_STEREOSCOPIC_OVERUNDER }, enumerable: !0, configurable: !0 }), Object.defineProperty(i, "RIG_MODE_VR", { get: function() { return i._RIG_MODE_VR }, enumerable: !0, configurable: !0 }), Object.defineProperty(i, "RIG_MODE_WEBVR", { get: function() { return i._RIG_MODE_WEBVR }, enumerable: !0, configurable: !0 }), i.prototype.getClassName = function() { return "Camera" }, i.prototype.toString = function(e) { var t = "Name: " + this.name; if (t += ", type: " + this.getClassName(), this.animations)
                for (var i = 0; i < this.animations.length; i++) t += ", animation[0]: " + this.animations[i].toString(e); return t }, Object.defineProperty(i.prototype, "globalPosition", { get: function() { return this._globalPosition }, enumerable: !0, configurable: !0 }), i.prototype.getActiveMeshes = function() { return this._activeMeshes }, i.prototype.isActiveMesh = function(e) { return this._activeMeshes.indexOf(e) !== -1 }, i.prototype._initCache = function() { t.prototype._initCache.call(this), this._cache.position = new e.Vector3(Number.MAX_VALUE, Number.MAX_VALUE, Number.MAX_VALUE), this._cache.upVector = new e.Vector3(Number.MAX_VALUE, Number.MAX_VALUE, Number.MAX_VALUE), this._cache.mode = void 0, this._cache.minZ = void 0, this._cache.maxZ = void 0, this._cache.fov = void 0, this._cache.fovMode = void 0, this._cache.aspectRatio = void 0, this._cache.orthoLeft = void 0, this._cache.orthoRight = void 0, this._cache.orthoBottom = void 0, this._cache.orthoTop = void 0, this._cache.renderWidth = void 0, this._cache.renderHeight = void 0 }, i.prototype._updateCache = function(e) { e || t.prototype._updateCache.call(this); var i = this.getEngine();
            this._cache.position.copyFrom(this.position), this._cache.upVector.copyFrom(this.upVector), this._cache.mode = this.mode, this._cache.minZ = this.minZ, this._cache.maxZ = this.maxZ, this._cache.fov = this.fov, this._cache.fovMode = this.fovMode, this._cache.aspectRatio = i.getAspectRatio(this), this._cache.orthoLeft = this.orthoLeft, this._cache.orthoRight = this.orthoRight, this._cache.orthoBottom = this.orthoBottom, this._cache.orthoTop = this.orthoTop, this._cache.renderWidth = i.getRenderWidth(), this._cache.renderHeight = i.getRenderHeight() }, i.prototype._updateFromScene = function() { this.updateCache(), this.update() }, i.prototype._isSynchronized = function() { return this._isSynchronizedViewMatrix() && this._isSynchronizedProjectionMatrix() }, i.prototype._isSynchronizedViewMatrix = function() { return !!t.prototype._isSynchronized.call(this) && (this._cache.position.equals(this.position) && this._cache.upVector.equals(this.upVector) && this.isSynchronizedWithParent()) }, i.prototype._isSynchronizedProjectionMatrix = function() { var e = this._cache.mode === this.mode && this._cache.minZ === this.minZ && this._cache.maxZ === this.maxZ; if (!e) return !1; var t = this.getEngine(); return e = this.mode === i.PERSPECTIVE_CAMERA ? this._cache.fov === this.fov && this._cache.fovMode === this.fovMode && this._cache.aspectRatio === t.getAspectRatio(this) : this._cache.orthoLeft === this.orthoLeft && this._cache.orthoRight === this.orthoRight && this._cache.orthoBottom === this.orthoBottom && this._cache.orthoTop === this.orthoTop && this._cache.renderWidth === t.getRenderWidth() && this._cache.renderHeight === t.getRenderHeight() }, i.prototype.attachControl = function(e, t) {}, i.prototype.detachControl = function(e) {}, i.prototype.update = function() { this.cameraRigMode !== i.RIG_MODE_NONE && this._updateRigCameras(), this._checkInputs() }, i.prototype._checkInputs = function() {}, Object.defineProperty(i.prototype, "rigCameras", { get: function() { return this._rigCameras }, enumerable: !0, configurable: !0 }), Object.defineProperty(i.prototype, "rigPostProcess", { get: function() { return this._rigPostProcess }, enumerable: !0, configurable: !0 }), i.prototype._cascadePostProcessesToRigCams = function() { this._postProcesses.length > 0 && this._postProcesses[0].markTextureDirty(); for (var t = 0, i = this._rigCameras.length; t < i; t++) { var r = this._rigCameras[t],
                    n = r._rigPostProcess; if (n) { n instanceof e.PassPostProcess && (r.isIntermediate = 0 === this._postProcesses.length), r._postProcesses = this._postProcesses.slice(0).concat(n), n.markTextureDirty() } else r._postProcesses = this._postProcesses.slice(0) } }, i.prototype.attachPostProcess = function(t, i) { return void 0 === i && (i = null), !t.isReusable() && this._postProcesses.indexOf(t) > -1 ? (e.Tools.Error("You're trying to reuse a post process not defined as reusable."), 0) : (null == i || i < 0 ? this._postProcesses.push(t) : this._postProcesses.splice(i, 0, t), this._cascadePostProcessesToRigCams(), this._postProcesses.indexOf(t)) }, i.prototype.detachPostProcess = function(e, t) { void 0 === t && (t = null); var i, r, n = []; if (t)
                for (t = t instanceof Array ? t : [t], i = t.length - 1; i >= 0; i--) this._postProcesses[t[i]] === e ? (r = t[i], this._postProcesses.splice(r, 1)) : n.push(i);
            else { var o = this._postProcesses.indexOf(e);
                o !== -1 && this._postProcesses.splice(o, 1) } return this._cascadePostProcessesToRigCams(), n }, i.prototype.getWorldMatrix = function() { return this._worldMatrix || (this._worldMatrix = e.Matrix.Identity()), this.getViewMatrix().invertToRef(this._worldMatrix), this._worldMatrix }, i.prototype._getViewMatrix = function() { return e.Matrix.Identity() }, i.prototype.getViewMatrix = function(t) { return this._computedViewMatrix = this._computeViewMatrix(t), !t && this._isSynchronizedViewMatrix() ? this._computedViewMatrix : (this._refreshFrustumPlanes = !0, this.parent && this.parent.getWorldMatrix ? (this._worldMatrix || (this._worldMatrix = e.Matrix.Identity()), this._computedViewMatrix.invertToRef(this._worldMatrix), this._worldMatrix.multiplyToRef(this.parent.getWorldMatrix(), this._computedViewMatrix), this._globalPosition.copyFromFloats(this._computedViewMatrix.m[12], this._computedViewMatrix.m[13], this._computedViewMatrix.m[14]), this._computedViewMatrix.invert(), this._markSyncedWithParent()) : this._globalPosition.copyFrom(this.position), this._cameraRigParams && this._cameraRigParams.vrPreViewMatrix && this._computedViewMatrix.multiplyToRef(this._cameraRigParams.vrPreViewMatrix, this._computedViewMatrix), this._currentRenderId = this.getScene().getRenderId(), this._computedViewMatrix) }, i.prototype._computeViewMatrix = function(e) { return !e && this._isSynchronizedViewMatrix() ? this._computedViewMatrix : (this._computedViewMatrix = this._getViewMatrix(), this._currentRenderId = this.getScene().getRenderId(), this._computedViewMatrix) }, i.prototype.freezeProjectionMatrix = function(e) { this._doNotComputeProjectionMatrix = !0, void 0 !== e && (this._projectionMatrix = e) }, i.prototype.unfreezeProjectionMatrix = function() { this._doNotComputeProjectionMatrix = !1 }, i.prototype.getProjectionMatrix = function(t) {
            if (this._doNotComputeProjectionMatrix || !t && this._isSynchronizedProjectionMatrix()) return this._projectionMatrix;
            this._refreshFrustumPlanes = !0;
            var r = this.getEngine(),
                n = this.getScene();
            if (this.mode === i.PERSPECTIVE_CAMERA) return this.minZ <= 0 && (this.minZ = .1), n.useRightHandedSystem ? e.Matrix.PerspectiveFovRHToRef(this.fov, r.getAspectRatio(this), this.minZ, this.maxZ, this._projectionMatrix, this.fovMode === i.FOVMODE_VERTICAL_FIXED) : e.Matrix.PerspectiveFovLHToRef(this.fov, r.getAspectRatio(this), this.minZ, this.maxZ, this._projectionMatrix, this.fovMode === i.FOVMODE_VERTICAL_FIXED), this._projectionMatrix;
            var o = r.getRenderWidth() / 2,
                s = r.getRenderHeight() / 2;
            return n.useRightHandedSystem ? e.Matrix.OrthoOffCenterRHToRef(this.orthoLeft || -o, this.orthoRight || o, this.orthoBottom || -s, this.orthoTop || s, this.minZ, this.maxZ, this._projectionMatrix) : e.Matrix.OrthoOffCenterLHToRef(this.orthoLeft || -o, this.orthoRight || o, this.orthoBottom || -s, this.orthoTop || s, this.minZ, this.maxZ, this._projectionMatrix), this._projectionMatrix
        }, i.prototype.getTranformationMatrix = function() { return this._computedViewMatrix.multiplyToRef(this._projectionMatrix, this._transformMatrix), this._transformMatrix }, i.prototype.updateFrustumPlanes = function() { this._refreshFrustumPlanes && (this.getTranformationMatrix(), this._frustumPlanes ? e.Frustum.GetPlanesToRef(this._transformMatrix, this._frustumPlanes) : this._frustumPlanes = e.Frustum.GetPlanes(this._transformMatrix), this._refreshFrustumPlanes = !1) }, i.prototype.isInFrustum = function(e) { return this.updateFrustumPlanes(), e.isInFrustum(this._frustumPlanes) }, i.prototype.isCompletelyInFrustum = function(e) { return this.updateFrustumPlanes(), e.isCompletelyInFrustum(this._frustumPlanes) }, i.prototype.dispose = function() { for (this.getScene().stopAnimation(this), this.getScene().removeCamera(this); this._rigCameras.length > 0;) this._rigCameras.pop().dispose(); for (var e = this._postProcesses.length; --e >= 0;) this._postProcesses[e].dispose(this);
            t.prototype.dispose.call(this) }, i.prototype.setCameraRigMode = function(t, r) { for (; this._rigCameras.length > 0;) this._rigCameras.pop().dispose(); switch (this.cameraRigMode = t, this._cameraRigParams = {}, this._cameraRigParams.interaxialDistance = r.interaxialDistance || .0637, this._cameraRigParams.stereoHalfAngle = e.Tools.ToRadians(this._cameraRigParams.interaxialDistance / .0637), this.cameraRigMode !== i.RIG_MODE_NONE && (this._rigCameras.push(this.createRigCamera(this.name + "_L", 0)), this._rigCameras.push(this.createRigCamera(this.name + "_R", 1))), this.cameraRigMode) {
                case i.RIG_MODE_STEREOSCOPIC_ANAGLYPH:
                    this._rigCameras[0]._rigPostProcess = new e.PassPostProcess(this.name + "_passthru", 1, this._rigCameras[0]), this._rigCameras[1]._rigPostProcess = new e.AnaglyphPostProcess(this.name + "_anaglyph", 1, this._rigCameras); break;
                case i.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL:
                case i.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED:
                case i.RIG_MODE_STEREOSCOPIC_OVERUNDER:
                    var n = this.cameraRigMode === i.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL || this.cameraRigMode === i.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED;
                    this._rigCameras[0]._rigPostProcess = new e.PassPostProcess(this.name + "_passthru", 1, this._rigCameras[0]), this._rigCameras[1]._rigPostProcess = new e.StereoscopicInterlacePostProcess(this.name + "_stereoInterlace", this._rigCameras, n); break;
                case i.RIG_MODE_VR:
                    var o = r.vrCameraMetrics || e.VRCameraMetrics.GetDefault();
                    this._rigCameras[0]._cameraRigParams.vrMetrics = o, this._rigCameras[0].viewport = new e.Viewport(0, 0, .5, 1), this._rigCameras[0]._cameraRigParams.vrWorkMatrix = new e.Matrix, this._rigCameras[0]._cameraRigParams.vrHMatrix = o.leftHMatrix, this._rigCameras[0]._cameraRigParams.vrPreViewMatrix = o.leftPreViewMatrix, this._rigCameras[0].getProjectionMatrix = this._rigCameras[0]._getVRProjectionMatrix, this._rigCameras[1]._cameraRigParams.vrMetrics = o, this._rigCameras[1].viewport = new e.Viewport(.5, 0, .5, 1), this._rigCameras[1]._cameraRigParams.vrWorkMatrix = new e.Matrix, this._rigCameras[1]._cameraRigParams.vrHMatrix = o.rightHMatrix, this._rigCameras[1]._cameraRigParams.vrPreViewMatrix = o.rightPreViewMatrix, this._rigCameras[1].getProjectionMatrix = this._rigCameras[1]._getVRProjectionMatrix, o.compensateDistortion && (this._rigCameras[0]._rigPostProcess = new e.VRDistortionCorrectionPostProcess("VR_Distort_Compensation_Left", this._rigCameras[0], !1, o), this._rigCameras[1]._rigPostProcess = new e.VRDistortionCorrectionPostProcess("VR_Distort_Compensation_Right", this._rigCameras[1], !0, o)); break;
                case i.RIG_MODE_WEBVR:
                    if (r.vrDisplay) { var s = r.vrDisplay.getEyeParameters("left"),
                            a = r.vrDisplay.getEyeParameters("right");
                        this._rigCameras[0].viewport = new e.Viewport(0, 0, .5, 1), this._rigCameras[0].setCameraRigParameter("left", !0), this._rigCameras[0].setCameraRigParameter("specs", r.specs), this._rigCameras[0].setCameraRigParameter("eyeParameters", s), this._rigCameras[0].setCameraRigParameter("frameData", r.frameData), this._rigCameras[0].setCameraRigParameter("parentCamera", r.parentCamera), this._rigCameras[0]._cameraRigParams.vrWorkMatrix = new e.Matrix, this._rigCameras[0].getProjectionMatrix = this._getWebVRProjectionMatrix, this._rigCameras[0].parent = this, this._rigCameras[0]._getViewMatrix = this._getWebVRViewMatrix, this._rigCameras[1].viewport = new e.Viewport(.5, 0, .5, 1), this._rigCameras[1].setCameraRigParameter("eyeParameters", a), this._rigCameras[1].setCameraRigParameter("specs", r.specs), this._rigCameras[1].setCameraRigParameter("frameData", r.frameData), this._rigCameras[1].setCameraRigParameter("parentCamera", r.parentCamera), this._rigCameras[1]._cameraRigParams.vrWorkMatrix = new e.Matrix, this._rigCameras[1].getProjectionMatrix = this._getWebVRProjectionMatrix, this._rigCameras[1].parent = this, this._rigCameras[1]._getViewMatrix = this._getWebVRViewMatrix } }
            this._cascadePostProcessesToRigCams(), this.update() }, i.prototype._getVRProjectionMatrix = function() { return e.Matrix.PerspectiveFovLHToRef(this._cameraRigParams.vrMetrics.aspectRatioFov, this._cameraRigParams.vrMetrics.aspectRatio, this.minZ, this.maxZ, this._cameraRigParams.vrWorkMatrix), this._cameraRigParams.vrWorkMatrix.multiplyToRef(this._cameraRigParams.vrHMatrix, this._projectionMatrix), this._projectionMatrix }, i.prototype._updateCameraRotationMatrix = function() {}, i.prototype._updateWebVRCameraRotationMatrix = function() {}, i.prototype._getWebVRProjectionMatrix = function() { return e.Matrix.Identity() }, i.prototype._getWebVRViewMatrix = function() { return e.Matrix.Identity() }, i.prototype.setCameraRigParameter = function(t, i) { this._cameraRigParams || (this._cameraRigParams = {}), this._cameraRigParams[t] = i, "interaxialDistance" === t && (this._cameraRigParams.stereoHalfAngle = e.Tools.ToRadians(i / .0637)) }, i.prototype.createRigCamera = function(e, t) { return null }, i.prototype._updateRigCameras = function() { for (var e = 0; e < this._rigCameras.length; e++) this._rigCameras[e].minZ = this.minZ, this._rigCameras[e].maxZ = this.maxZ, this._rigCameras[e].fov = this.fov;
            this.cameraRigMode === i.RIG_MODE_STEREOSCOPIC_ANAGLYPH && (this._rigCameras[0].viewport = this._rigCameras[1].viewport = this.viewport) }, i.prototype._setupInputs = function() {}, i.prototype.serialize = function() { var t = e.SerializationHelper.Serialize(this); return t.type = this.getClassName(), this.parent && (t.parentId = this.parent.id), this.inputs && this.inputs.serialize(t), e.Animation.AppendSerializedAnimations(this, t), t.ranges = this.serializeAnimationRanges(), t }, i.prototype.clone = function(t) { return e.SerializationHelper.Clone(i.GetConstructorFromName(this.getClassName(), t, this.getScene(), this.interaxialDistance, this.isStereoscopicSideBySide), this) }, i.prototype.getDirection = function(t) { var i = e.Vector3.Zero(); return this.getDirectionToRef(t, i), i }, i.prototype.getDirectionToRef = function(t, i) { e.Vector3.TransformNormalToRef(t, this.getWorldMatrix(), i) }, i.GetConstructorFromName = function(t, i, r, n, o) { switch (void 0 === n && (n = 0), void 0 === o && (o = !0), t) {
                case "ArcRotateCamera":
                    return function() { return new e.ArcRotateCamera(i, 0, 0, 1, e.Vector3.Zero(), r) };
                case "DeviceOrientationCamera":
                    return function() { return new e.DeviceOrientationCamera(i, e.Vector3.Zero(), r) };
                case "FollowCamera":
                    return function() { return new e.FollowCamera(i, e.Vector3.Zero(), r) };
                case "ArcFollowCamera":
                    return function() { return new e.ArcFollowCamera(i, 0, 0, 1, null, r) };
                case "GamepadCamera":
                    return function() { return new e.GamepadCamera(i, e.Vector3.Zero(), r) };
                case "TouchCamera":
                    return function() { return new e.TouchCamera(i, e.Vector3.Zero(), r) };
                case "VirtualJoysticksCamera":
                    return function() { return new e.VirtualJoysticksCamera(i, e.Vector3.Zero(), r) };
                case "WebVRFreeCamera":
                case "WebVRGamepadCamera":
                    return function() { return new e.WebVRFreeCamera(i, e.Vector3.Zero(), r) };
                case "VRDeviceOrientationFreeCamera":
                    return function() { return new e.VRDeviceOrientationFreeCamera(i, e.Vector3.Zero(), r) };
                case "VRDeviceOrientationGamepadCamera":
                    return function() { return new e.VRDeviceOrientationGamepadCamera(i, e.Vector3.Zero(), r) };
                case "AnaglyphArcRotateCamera":
                    return function() { return new e.AnaglyphArcRotateCamera(i, 0, 0, 1, e.Vector3.Zero(), n, r) };
                case "AnaglyphFreeCamera":
                    return function() { return new e.AnaglyphFreeCamera(i, e.Vector3.Zero(), n, r) };
                case "AnaglyphGamepadCamera":
                    return function() { return new e.AnaglyphGamepadCamera(i, e.Vector3.Zero(), n, r) };
                case "AnaglyphUniversalCamera":
                    return function() { return new e.AnaglyphUniversalCamera(i, e.Vector3.Zero(), n, r) };
                case "StereoscopicArcRotateCamera":
                    return function() { return new e.StereoscopicArcRotateCamera(i, 0, 0, 1, e.Vector3.Zero(), n, o, r) };
                case "StereoscopicFreeCamera":
                    return function() { return new e.StereoscopicFreeCamera(i, e.Vector3.Zero(), n, o, r) };
                case "StereoscopicGamepadCamera":
                    return function() { return new e.StereoscopicGamepadCamera(i, e.Vector3.Zero(), n, o, r) };
                case "StereoscopicUniversalCamera":
                    return function() { return new e.StereoscopicUniversalCamera(i, e.Vector3.Zero(), n, o, r) };
                case "FreeCamera":
                default:
                    return function() { return new e.UniversalCamera(i, e.Vector3.Zero(), r) } } }, i.Parse = function(t, r) { var n = t.type,
                o = i.GetConstructorFromName(n, t.name, r, t.interaxial_distance, t.isStereoscopicSideBySide),
                s = e.SerializationHelper.Parse(o, t, r); if (t.parentId && (s._waitingParentId = t.parentId), s.inputs && (s.inputs.parse(t), s._setupInputs()), t.target && s.setTarget && s.setTarget(e.Vector3.FromArray(t.target)), t.cameraRigMode) { var a = t.interaxial_distance ? { interaxialDistance: t.interaxial_distance } : {};
                s.setCameraRigMode(t.cameraRigMode, a) } if (t.animations) { for (var h = 0; h < t.animations.length; h++) { var l = t.animations[h];
                    s.animations.push(e.Animation.Parse(l)) }
                e.Node.ParseAnimationRanges(s, t, r) } return t.autoAnimate && r.beginAnimation(s, t.autoAnimateFrom, t.autoAnimateTo, t.autoAnimateLoop, t.autoAnimateSpeed || 1), s }, i
    })(e.Node);
    t._PERSPECTIVE_CAMERA = 0, t._ORTHOGRAPHIC_CAMERA = 1, t._FOVMODE_VERTICAL_FIXED = 0, t._FOVMODE_HORIZONTAL_FIXED = 1, t._RIG_MODE_NONE = 0, t._RIG_MODE_STEREOSCOPIC_ANAGLYPH = 10, t._RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL = 11, t._RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED = 12, t._RIG_MODE_STEREOSCOPIC_OVERUNDER = 13, t._RIG_MODE_VR = 20, t._RIG_MODE_WEBVR = 21, t.ForceAttachControlToAlwaysPreventDefault = !1, __decorate([e.serializeAsVector3()], t.prototype, "position", void 0), __decorate([e.serializeAsVector3()], t.prototype, "upVector", void 0), __decorate([e.serialize()], t.prototype, "orthoLeft", void 0), __decorate([e.serialize()], t.prototype, "orthoRight", void 0), __decorate([e.serialize()], t.prototype, "orthoBottom", void 0), __decorate([e.serialize()], t.prototype, "orthoTop", void 0), __decorate([e.serialize()], t.prototype, "fov", void 0), __decorate([e.serialize()], t.prototype, "minZ", void 0), __decorate([e.serialize()], t.prototype, "maxZ", void 0), __decorate([e.serialize()], t.prototype, "inertia", void 0), __decorate([e.serialize()], t.prototype, "mode", void 0), __decorate([e.serialize()], t.prototype, "layerMask", void 0), __decorate([e.serialize()], t.prototype, "fovMode", void 0), __decorate([e.serialize()], t.prototype, "cameraRigMode", void 0), __decorate([e.serialize()], t.prototype, "interaxialDistance", void 0), __decorate([e.serialize()], t.prototype, "isStereoscopicSideBySide", void 0), e.Camera = t
})(BABYLON || (BABYLON = {}));
var BABYLON;
!(function(e) { var t = (function() {
        function t(e) { this._renderingGroups = new Array, this._autoClearDepthStencil = {}, this._customOpaqueSortCompareFn = {}, this._customAlphaTestSortCompareFn = {}, this._customTransparentSortCompareFn = {}, this._renderinGroupInfo = null, this._scene = e; for (var i = t.MIN_RENDERINGGROUPS; i < t.MAX_RENDERINGGROUPS; i++) this._autoClearDepthStencil[i] = { autoClear: !0, depth: !0, stencil: !0 } } return t.prototype._clearDepthStencilBuffer = function(e, t) { void 0 === e && (e = !0), void 0 === t && (t = !0), this._depthStencilBufferAlreadyCleaned || (this._scene.getEngine().clear(null, !1, e, t), this._depthStencilBufferAlreadyCleaned = !0) }, t.prototype.render = function(i, r, n, o) { var s = this._scene.onRenderingGroupObservable.hasObservers() ? this._scene.onRenderingGroupObservable : null,
                a = null; if (s && (this._renderinGroupInfo || (this._renderinGroupInfo = new e.RenderingGroupInfo), a = this._renderinGroupInfo, a.scene = this._scene, a.camera = this._scene.activeCamera), o)
                for (var h = 0; h < this._scene.spriteManagers.length; h++) { var l = this._scene.spriteManagers[h];
                    this.dispatchSprites(l) }
            for (var h = t.MIN_RENDERINGGROUPS; h < t.MAX_RENDERINGGROUPS; h++) { this._depthStencilBufferAlreadyCleaned = h === t.MIN_RENDERINGGROUPS; var c = this._renderingGroups[h]; if (c || s) { this._currentIndex = h; var u = 0;
                    s && (u = Math.pow(2, h), a.renderStage = e.RenderingGroupInfo.STAGE_PRECLEAR, a.renderingGroupId = h, s.notifyObservers(a, u)); var d = this._autoClearDepthStencil[h];
                    d && d.autoClear && this._clearDepthStencilBuffer(d.depth, d.stencil), s && (a.renderStage = e.RenderingGroupInfo.STAGE_PREOPAQUE, s.notifyObservers(a, u), a.renderStage = e.RenderingGroupInfo.STAGE_PRETRANSPARENT, s.notifyObservers(a, u)), c && c.render(i, o, n, r), s && (a.renderStage = e.RenderingGroupInfo.STAGE_POSTTRANSPARENT, s.notifyObservers(a, u)) } } }, t.prototype.reset = function() { for (var e = t.MIN_RENDERINGGROUPS; e < t.MAX_RENDERINGGROUPS; e++) { var i = this._renderingGroups[e];
                i && i.prepare() } }, t.prototype.dispose = function() { for (var e = t.MIN_RENDERINGGROUPS; e < t.MAX_RENDERINGGROUPS; e++) { var i = this._renderingGroups[e];
                i && i.dispose() }
            this._renderingGroups.length = 0 }, t.prototype._prepareRenderingGroup = function(t) { this._renderingGroups[t] || (this._renderingGroups[t] = new e.RenderingGroup(t, this._scene, this._customOpaqueSortCompareFn[t], this._customAlphaTestSortCompareFn[t], this._customTransparentSortCompareFn[t])) }, t.prototype.dispatchSprites = function(e) { var t = e.renderingGroupId || 0;
            this._prepareRenderingGroup(t), this._renderingGroups[t].dispatchSprites(e) }, t.prototype.dispatchParticles = function(e) { var t = e.renderingGroupId || 0;
            this._prepareRenderingGroup(t), this._renderingGroups[t].dispatchParticles(e) }, t.prototype.dispatch = function(e) { var t = e.getMesh(),
                i = t.renderingGroupId || 0;
            this._prepareRenderingGroup(i), this._renderingGroups[i].dispatch(e) }, t.prototype.setRenderingOrder = function(e, t, i, r) { if (void 0 === t && (t = null), void 0 === i && (i = null), void 0 === r && (r = null), this._customOpaqueSortCompareFn[e] = t, this._customAlphaTestSortCompareFn[e] = i, this._customTransparentSortCompareFn[e] = r, this._renderingGroups[e]) { var n = this._renderingGroups[e];
                n.opaqueSortCompareFn = this._customOpaqueSortCompareFn[e], n.alphaTestSortCompareFn = this._customAlphaTestSortCompareFn[e], n.transparentSortCompareFn = this._customTransparentSortCompareFn[e] } }, t.prototype.setRenderingAutoClearDepthStencil = function(e, t, i, r) { void 0 === i && (i = !0), void 0 === r && (r = !0), this._autoClearDepthStencil[e] = { autoClear: t, depth: i, stencil: r } }, t })();
    t.MAX_RENDERINGGROUPS = 4, t.MIN_RENDERINGGROUPS = 0, e.RenderingManager = t })(BABYLON || (BABYLON = {}));
var BABYLON;
!(function(e) { var t = (function() {
        function t(t, i, r, n, o) { void 0 === r && (r = null), void 0 === n && (n = null), void 0 === o && (o = null), this.index = t, this._opaqueSubMeshes = new e.SmartArray(256), this._transparentSubMeshes = new e.SmartArray(256), this._alphaTestSubMeshes = new e.SmartArray(256), this._particleSystems = new e.SmartArray(256), this._spriteManagers = new e.SmartArray(256), this._scene = i, this.opaqueSortCompareFn = r, this.alphaTestSortCompareFn = n, this.transparentSortCompareFn = o } return Object.defineProperty(t.prototype, "opaqueSortCompareFn", { set: function(e) { this._opaqueSortCompareFn = e, this._renderOpaque = e ? this.renderOpaqueSorted : t.renderUnsorted }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "alphaTestSortCompareFn", { set: function(e) { this._alphaTestSortCompareFn = e, this._renderAlphaTest = e ? this.renderAlphaTestSorted : t.renderUnsorted }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "transparentSortCompareFn", { set: function(e) { this._transparentSortCompareFn = e || t.defaultTransparentSortCompare, this._renderTransparent = this.renderTransparentSorted }, enumerable: !0, configurable: !0 }), t.prototype.render = function(t, i, r, n) { if (t) return void t(this._opaqueSubMeshes, this._alphaTestSubMeshes, this._transparentSubMeshes); var o = this._scene.getEngine();
            0 !== this._opaqueSubMeshes.length && this._renderOpaque(this._opaqueSubMeshes), 0 !== this._alphaTestSubMeshes.length && (o.setAlphaTesting(!0), this._renderAlphaTest(this._alphaTestSubMeshes), o.setAlphaTesting(!1)); var s = o.getStencilBuffer();
            o.setStencilBuffer(!1), i && this._renderSprites(), r && this._renderParticles(n), this.onBeforeTransparentRendering && this.onBeforeTransparentRendering(), 0 !== this._transparentSubMeshes.length && (this._renderTransparent(this._transparentSubMeshes), o.setAlphaMode(e.Engine.ALPHA_DISABLE)), o.setStencilBuffer(s) }, t.prototype.renderOpaqueSorted = function(e) { return t.renderSorted(e, this._opaqueSortCompareFn, this._scene.activeCamera.globalPosition, !1) }, t.prototype.renderAlphaTestSorted = function(e) { return t.renderSorted(e, this._alphaTestSortCompareFn, this._scene.activeCamera.globalPosition, !1) }, t.prototype.renderTransparentSorted = function(e) { return t.renderSorted(e, this._transparentSortCompareFn, this._scene.activeCamera.globalPosition, !0) }, t.renderSorted = function(e, t, i, r) { for (var n, o = 0; o < e.length; o++) n = e.data[o], n._alphaIndex = n.getMesh().alphaIndex, n._distanceToCamera = n.getBoundingInfo().boundingSphere.centerWorld.subtract(i).length(); var s = e.data.slice(0, e.length); for (s.sort(t), o = 0; o < s.length; o++) n = s[o], n.render(r) }, t.renderUnsorted = function(e) { for (var t = 0; t < e.length; t++) { e.data[t].render(!1) } }, t.defaultTransparentSortCompare = function(e, i) { return e._alphaIndex > i._alphaIndex ? 1 : e._alphaIndex < i._alphaIndex ? -1 : t.backToFrontSortCompare(e, i) }, t.backToFrontSortCompare = function(e, t) { return e._distanceToCamera < t._distanceToCamera ? 1 : e._distanceToCamera > t._distanceToCamera ? -1 : 0 }, t.frontToBackSortCompare = function(e, t) { return e._distanceToCamera < t._distanceToCamera ? -1 : e._distanceToCamera > t._distanceToCamera ? 1 : 0 }, t.prototype.prepare = function() { this._opaqueSubMeshes.reset(), this._transparentSubMeshes.reset(), this._alphaTestSubMeshes.reset(), this._particleSystems.reset(), this._spriteManagers.reset() }, t.prototype.dispose = function() { this._opaqueSubMeshes.dispose(), this._transparentSubMeshes.dispose(), this._alphaTestSubMeshes.dispose(), this._particleSystems.dispose(), this._spriteManagers.dispose() }, t.prototype.dispatch = function(e) { var t = e.getMaterial(),
                i = e.getMesh();
            t.needAlphaBlending() || i.visibility < 1 || i.hasVertexAlpha ? this._transparentSubMeshes.push(e) : t.needAlphaTesting() ? this._alphaTestSubMeshes.push(e) : this._opaqueSubMeshes.push(e) }, t.prototype.dispatchSprites = function(e) { this._spriteManagers.push(e) }, t.prototype.dispatchParticles = function(e) { this._particleSystems.push(e) }, t.prototype._renderParticles = function(e) { if (0 !== this._particleSystems.length) { var t = this._scene.activeCamera;
                this._scene._particlesDuration.beginMonitoring(); for (var i = 0; i < this._scene._activeParticleSystems.length; i++) { var r = this._scene._activeParticleSystems.data[i];
                    0 != (t.layerMask & r.layerMask) && (r.emitter.position && e && e.indexOf(r.emitter) === -1 || this._scene._activeParticles.addCount(r.render(), !1)) }
                this._scene._particlesDuration.endMonitoring(!1) } }, t.prototype._renderSprites = function() { if (this._scene.spritesEnabled && 0 !== this._spriteManagers.length) { var e = this._scene.activeCamera;
                this._scene._spritesDuration.beginMonitoring(); for (var t = 0; t < this._spriteManagers.length; t++) { var i = this._spriteManagers.data[t];
                    0 != (e.layerMask & i.layerMask) && i.render() }
                this._scene._spritesDuration.endMonitoring(!1) } }, t })();
    e.RenderingGroup = t })(BABYLON || (BABYLON = {}));
var BABYLON;
!(function(e) {
    var t = (function() {
            function e() { this._singleClick = !1, this._doubleClick = !1, this._hasSwiped = !1, this._ignore = !1 } return Object.defineProperty(e.prototype, "singleClick", { get: function() { return this._singleClick }, set: function(e) { this._singleClick = e }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "doubleClick", { get: function() { return this._doubleClick }, set: function(e) { this._doubleClick = e }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "hasSwiped", { get: function() { return this._hasSwiped }, set: function(e) { this._hasSwiped = e }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "ignore", { get: function() { return this._ignore }, set: function(e) { this._ignore = e }, enumerable: !0, configurable: !0 }), e })(),
        i = (function() {
            function e() {} return Object.defineProperty(e, "POINTERDOWN", { get: function() { return e._POINTERDOWN }, enumerable: !0, configurable: !0 }), Object.defineProperty(e, "POINTERUP", { get: function() { return e._POINTERUP }, enumerable: !0, configurable: !0 }), Object.defineProperty(e, "POINTERMOVE", { get: function() { return e._POINTERMOVE }, enumerable: !0, configurable: !0 }), Object.defineProperty(e, "POINTERWHEEL", { get: function() { return e._POINTERWHEEL }, enumerable: !0, configurable: !0 }), Object.defineProperty(e, "POINTERPICK", { get: function() { return e._POINTERPICK }, enumerable: !0, configurable: !0 }), Object.defineProperty(e, "POINTERTAP", { get: function() { return e._POINTERTAP }, enumerable: !0, configurable: !0 }), Object.defineProperty(e, "POINTERDOUBLETAP", { get: function() { return e._POINTERDOUBLETAP }, enumerable: !0, configurable: !0 }), e })();
    i._POINTERDOWN = 1, i._POINTERUP = 2, i._POINTERMOVE = 4, i._POINTERWHEEL = 8, i._POINTERPICK = 16, i._POINTERTAP = 32, i._POINTERDOUBLETAP = 64, e.PointerEventTypes = i;
    var r = (function() {
        function e(e, t) { this.type = e, this.event = t } return e })();
    e.PointerInfoBase = r;
    var n = (function(t) {
        function i(i, r, n, o) { var s = t.call(this, i, r) || this; return s.skipOnPointerObservable = !1, s.localPosition = new e.Vector2(n, o), s } return __extends(i, t), i })(r);
    e.PointerInfoPre = n;
    var o = (function(e) {
        function t(t, i, r) { var n = e.call(this, t, i) || this; return n.pickInfo = r, n } return __extends(t, e), t })(r);
    e.PointerInfo = o;
    var s = (function() {
        function e() {} return e })();
    s.STAGE_PRECLEAR = 1, s.STAGE_PREOPAQUE = 2, s.STAGE_PRETRANSPARENT = 3, s.STAGE_POSTTRANSPARENT = 4, e.RenderingGroupInfo = s;
    var a = (function() {
        function r(t) { this.autoClear = !0, this.clearColor = new e.Color4(.2, .2, .3, 1), this.ambientColor = new e.Color3(0, 0, 0), this.forceWireframe = !1, this._forcePointsCloud = !1, this.forceShowBoundingBoxes = !1, this.animationsEnabled = !0, this.constantlyUpdateMeshUnderPointer = !1, this.useRightHandedSystem = !1, this.hoverCursor = "pointer", this.metadata = null, this.onDisposeObservable = new e.Observable, this.onBeforeRenderObservable = new e.Observable, this.onAfterRenderObservable = new e.Observable, this.onReadyObservable = new e.Observable, this.onBeforeCameraRenderObservable = new e.Observable, this.onAfterCameraRenderObservable = new e.Observable, this.onNewCameraAddedObservable = new e.Observable, this.onCameraRemovedObservable = new e.Observable, this.onNewLightAddedObservable = new e.Observable, this.onLightRemovedObservable = new e.Observable, this.onNewGeometryAddedObservable = new e.Observable, this.onGeometryRemovedObservable = new e.Observable, this.onNewMeshAddedObservable = new e.Observable, this.onMeshRemovedObservable = new e.Observable, this.onRenderingGroupObservable = new e.Observable, this.animations = [], this.onPrePointerObservable = new e.Observable, this.onPointerObservable = new e.Observable, this._meshPickProceed = !1, this._previousHasSwiped = !1, this._currentPickResult = null, this._previousPickResult = null, this._isButtonPressed = !1, this._doubleClickOccured = !1, this.cameraToUseForPointers = null, this._startingPointerPosition = new e.Vector2(0, 0), this._previousStartingPointerPosition = new e.Vector2(0, 0), this._startingPointerTime = 0, this._previousStartingPointerTime = 0, this._fogEnabled = !0, this._fogMode = r.FOGMODE_NONE, this.fogColor = new e.Color3(.2, .2, .3), this.fogDensity = .1, this.fogStart = 0, this.fogEnd = 1e3, this._shadowsEnabled = !0, this._lightsEnabled = !0, this.lights = new Array, this.cameras = new Array, this.activeCameras = new Array, this.meshes = new Array, this._geometries = new Array, this.materials = new Array, this.multiMaterials = new Array, this._texturesEnabled = !0, this.textures = new Array, this.particlesEnabled = !0, this.particleSystems = new Array, this.spritesEnabled = !0, this.spriteManagers = new Array, this.layers = new Array, this.highlightLayers = new Array, this._skeletonsEnabled = !0, this.skeletons = new Array, this.morphTargetManagers = new Array, this.lensFlaresEnabled = !0, this.lensFlareSystems = new Array, this.collisionsEnabled = !0, this.gravity = new e.Vector3(0, -9.807, 0), this.postProcessesEnabled = !0, this.renderTargetsEnabled = !0, this.dumpNextRenderTargets = !1, this.customRenderTargets = new Array, this.importedMeshesFiles = new Array, this.probesEnabled = !0, this.reflectionProbes = new Array, this._actionManagers = new Array, this._meshesForIntersections = new e.SmartArray(256), this.proceduralTexturesEnabled = !0, this._proceduralTextures = new Array, this.soundTracks = new Array, this._audioEnabled = !0, this._headphone = !1, this._totalMeshesCounter = new e.PerfCounter, this._totalLightsCounter = new e.PerfCounter, this._totalMaterialsCounter = new e.PerfCounter, this._totalTexturesCounter = new e.PerfCounter, this._totalVertices = new e.PerfCounter, this._activeIndices = new e.PerfCounter, this._activeParticles = new e.PerfCounter, this._lastFrameDuration = new e.PerfCounter, this._evaluateActiveMeshesDuration = new e.PerfCounter, this._renderTargetsDuration = new e.PerfCounter, this._particlesDuration = new e.PerfCounter, this._renderDuration = new e.PerfCounter, this._spritesDuration = new e.PerfCounter, this._activeBones = new e.PerfCounter, this._animationTime = 0, this.animationTimeScale = 1, this._renderId = 0, this._executeWhenReadyTimeoutId = -1, this._intermediateRendering = !1, this._viewUpdateFlag = -1, this._projectionUpdateFlag = -1, this._toBeDisposed = new e.SmartArray(256), this._pendingData = [], this._activeMeshes = new e.SmartArray(256), this._processedMaterials = new e.SmartArray(256), this._renderTargets = new e.SmartArray(256), this._activeParticleSystems = new e.SmartArray(256), this._activeSkeletons = new e.SmartArray(32), this._softwareSkinnedMeshes = new e.SmartArray(32), this._activeAnimatables = new Array, this._transformMatrix = e.Matrix.Zero(), this._edgesRenderers = new e.SmartArray(16), this._uniqueIdCounter = 0, this._engine = t || e.Engine.LastCreatedEngine, this._engine.scenes.push(this), this._uid = null, this._renderingManager = new e.RenderingManager(this), this.postProcessManager = new e.PostProcessManager(this), e.OutlineRenderer && (this._outlineRenderer = new e.OutlineRenderer(this)), this.attachControl(), e.SoundTrack && (this.mainSoundTrack = new e.SoundTrack(this, { mainTrack: !0 })), e.SimplificationQueue && (this.simplificationQueue = new e.SimplificationQueue), this.workerCollisions = !1 }
        return Object.defineProperty(r, "FOGMODE_NONE", { get: function() { return r._FOGMODE_NONE }, enumerable: !0, configurable: !0 }), Object.defineProperty(r, "FOGMODE_EXP", { get: function() { return r._FOGMODE_EXP }, enumerable: !0, configurable: !0 }), Object.defineProperty(r, "FOGMODE_EXP2", { get: function() { return r._FOGMODE_EXP2 }, enumerable: !0, configurable: !0 }), Object.defineProperty(r, "FOGMODE_LINEAR", { get: function() { return r._FOGMODE_LINEAR }, enumerable: !0, configurable: !0 }), Object.defineProperty(r.prototype, "forcePointsCloud", { get: function() { return this._forcePointsCloud }, set: function(t) { this._forcePointsCloud !== t && (this._forcePointsCloud = t, this.markAllMaterialsAsDirty(e.Material.MiscDirtyFlag)) }, enumerable: !0, configurable: !0 }), Object.defineProperty(r.prototype, "onDispose", { set: function(e) { this._onDisposeObserver && this.onDisposeObservable.remove(this._onDisposeObserver), this._onDisposeObserver = this.onDisposeObservable.add(e) }, enumerable: !0, configurable: !0 }), Object.defineProperty(r.prototype, "beforeRender", { set: function(e) { this._onBeforeRenderObserver && this.onBeforeRenderObservable.remove(this._onBeforeRenderObserver), this._onBeforeRenderObserver = this.onBeforeRenderObservable.add(e) }, enumerable: !0, configurable: !0 }), Object.defineProperty(r.prototype, "afterRender", { set: function(e) { this._onAfterRenderObserver && this.onAfterRenderObservable.remove(this._onAfterRenderObserver), this._onAfterRenderObserver = this.onAfterRenderObservable.add(e) }, enumerable: !0, configurable: !0 }), Object.defineProperty(r.prototype, "beforeCameraRender", { set: function(e) { this._onBeforeCameraRenderObserver && this.onBeforeCameraRenderObservable.remove(this._onBeforeCameraRenderObserver), this._onBeforeCameraRenderObserver = this.onBeforeCameraRenderObservable.add(e) }, enumerable: !0, configurable: !0 }), Object.defineProperty(r.prototype, "afterCameraRender", { set: function(e) { this._onAfterCameraRenderObserver && this.onAfterCameraRenderObservable.remove(this._onAfterCameraRenderObserver), this._onAfterCameraRenderObserver = this.onAfterCameraRenderObservable.add(e) }, enumerable: !0, configurable: !0 }), Object.defineProperty(r.prototype, "unTranslatedPointer", { get: function() { return new e.Vector2(this._unTranslatedPointerX, this._unTranslatedPointerY) }, enumerable: !0, configurable: !0 }), Object.defineProperty(r.prototype, "fogEnabled", { get: function() { return this._fogEnabled }, set: function(t) { this._fogEnabled !== t && (this._fogEnabled = t, this.markAllMaterialsAsDirty(e.Material.MiscDirtyFlag)) }, enumerable: !0, configurable: !0 }), Object.defineProperty(r.prototype, "fogMode", { get: function() { return this._fogMode }, set: function(t) { this._fogMode !== t && (this._fogMode = t, this.markAllMaterialsAsDirty(e.Material.MiscDirtyFlag)) }, enumerable: !0, configurable: !0 }), Object.defineProperty(r.prototype, "shadowsEnabled", { get: function() { return this._shadowsEnabled }, set: function(t) { this._shadowsEnabled !== t && (this._shadowsEnabled = t, this.markAllMaterialsAsDirty(e.Material.LightDirtyFlag)) }, enumerable: !0, configurable: !0 }), Object.defineProperty(r.prototype, "lightsEnabled", { get: function() { return this._lightsEnabled }, set: function(t) { this._lightsEnabled !== t && (this._lightsEnabled = t, this.markAllMaterialsAsDirty(e.Material.LightDirtyFlag)) }, enumerable: !0, configurable: !0 }), Object.defineProperty(r.prototype, "defaultMaterial", { get: function() { return this._defaultMaterial || (this._defaultMaterial = new e.StandardMaterial("default material", this)), this._defaultMaterial }, enumerable: !0, configurable: !0 }), Object.defineProperty(r.prototype, "texturesEnabled", { get: function() { return this._texturesEnabled }, set: function(t) { this._texturesEnabled !== t && (this._texturesEnabled = t, this.markAllMaterialsAsDirty(e.Material.TextureDirtyFlag)) }, enumerable: !0, configurable: !0 }), Object.defineProperty(r.prototype, "skeletonsEnabled", { get: function() { return this._skeletonsEnabled }, set: function(t) { this._skeletonsEnabled !== t && (this._skeletonsEnabled = t, this.markAllMaterialsAsDirty(e.Material.AttributesDirtyFlag)) }, enumerable: !0, configurable: !0 }), Object.defineProperty(r.prototype, "postProcessRenderPipelineManager", { get: function() { return this._postProcessRenderPipelineManager || (this._postProcessRenderPipelineManager = new e.PostProcessRenderPipelineManager), this._postProcessRenderPipelineManager }, enumerable: !0, configurable: !0 }), Object.defineProperty(r.prototype, "frustumPlanes", { get: function() { return this._frustumPlanes }, enumerable: !0, configurable: !0 }), Object.defineProperty(r.prototype, "debugLayer", { get: function() { return this._debugLayer || (this._debugLayer = new e.DebugLayer(this)), this._debugLayer }, enumerable: !0, configurable: !0 }), Object.defineProperty(r.prototype, "workerCollisions", { get: function() { return this._workerCollisions }, set: function(t) { e.CollisionCoordinatorLegacy && (t = t && !!Worker, this._workerCollisions = t, this.collisionCoordinator && this.collisionCoordinator.destroy(), this.collisionCoordinator = t ? new e.CollisionCoordinatorWorker : new e.CollisionCoordinatorLegacy, this.collisionCoordinator.init(this)) }, enumerable: !0, configurable: !0 }), Object.defineProperty(r.prototype, "selectionOctree", { get: function() { return this._selectionOctree }, enumerable: !0, configurable: !0 }), Object.defineProperty(r.prototype, "meshUnderPointer", { get: function() { return this._pointerOverMesh }, enumerable: !0, configurable: !0 }), Object.defineProperty(r.prototype, "pointerX", { get: function() { return this._pointerX }, enumerable: !0, configurable: !0 }), Object.defineProperty(r.prototype, "pointerY", { get: function() { return this._pointerY }, enumerable: !0, configurable: !0 }), r.prototype.getCachedMaterial = function() {
            return this._cachedMaterial
        }, r.prototype.getCachedEffect = function() { return this._cachedEffect }, r.prototype.getBoundingBoxRenderer = function() { return this._boundingBoxRenderer || (this._boundingBoxRenderer = new e.BoundingBoxRenderer(this)), this._boundingBoxRenderer }, r.prototype.getOutlineRenderer = function() { return this._outlineRenderer }, r.prototype.getEngine = function() { return this._engine }, r.prototype.getTotalVertices = function() { return this._totalVertices.current }, Object.defineProperty(r.prototype, "totalVerticesPerfCounter", { get: function() { return this._totalVertices }, enumerable: !0, configurable: !0 }), r.prototype.getActiveIndices = function() { return this._activeIndices.current }, Object.defineProperty(r.prototype, "totalActiveIndicesPerfCounter", { get: function() { return this._activeIndices }, enumerable: !0, configurable: !0 }), r.prototype.getActiveParticles = function() { return this._activeParticles.current }, Object.defineProperty(r.prototype, "activeParticlesPerfCounter", { get: function() { return this._activeParticles }, enumerable: !0, configurable: !0 }), r.prototype.getActiveBones = function() { return this._activeBones.current }, Object.defineProperty(r.prototype, "activeBonesPerfCounter", { get: function() { return this._activeBones }, enumerable: !0, configurable: !0 }), r.prototype.getLastFrameDuration = function() { return this._lastFrameDuration.current }, Object.defineProperty(r.prototype, "lastFramePerfCounter", { get: function() { return this._lastFrameDuration }, enumerable: !0, configurable: !0 }), r.prototype.getEvaluateActiveMeshesDuration = function() { return this._evaluateActiveMeshesDuration.current }, Object.defineProperty(r.prototype, "evaluateActiveMeshesDurationPerfCounter", { get: function() { return this._evaluateActiveMeshesDuration }, enumerable: !0, configurable: !0 }), r.prototype.getActiveMeshes = function() { return this._activeMeshes }, r.prototype.getRenderTargetsDuration = function() { return this._renderTargetsDuration.current }, r.prototype.getRenderDuration = function() { return this._renderDuration.current }, Object.defineProperty(r.prototype, "renderDurationPerfCounter", { get: function() { return this._renderDuration }, enumerable: !0, configurable: !0 }), r.prototype.getParticlesDuration = function() { return this._particlesDuration.current }, Object.defineProperty(r.prototype, "particlesDurationPerfCounter", { get: function() { return this._particlesDuration }, enumerable: !0, configurable: !0 }), r.prototype.getSpritesDuration = function() { return this._spritesDuration.current }, Object.defineProperty(r.prototype, "spriteDuractionPerfCounter", { get: function() { return this._spritesDuration }, enumerable: !0, configurable: !0 }), r.prototype.getAnimationRatio = function() { return this._animationRatio }, r.prototype.getRenderId = function() { return this._renderId }, r.prototype.incrementRenderId = function() { this._renderId++ }, r.prototype._updatePointerPosition = function(e) { var t = this._engine.getRenderingCanvasClientRect();
            this._pointerX = e.clientX - t.left, this._pointerY = e.clientY - t.top, this._unTranslatedPointerX = this._pointerX, this._unTranslatedPointerY = this._pointerY, this.cameraToUseForPointers && (this._pointerX = this._pointerX - this.cameraToUseForPointers.viewport.x * this._engine.getRenderWidth(), this._pointerY = this._pointerY - this.cameraToUseForPointers.viewport.y * this._engine.getRenderHeight()) }, r.prototype.attachControl = function(s, a, h) { var l = this;
            void 0 === s && (s = !0), void 0 === a && (a = !0), void 0 === h && (h = !0), this._initActionManager = function(e, t) { if (!l._meshPickProceed) { var i = l.pick(l._unTranslatedPointerX, l._unTranslatedPointerY, l.pointerDownPredicate, !1, l.cameraToUseForPointers);
                    l._currentPickResult = i, i && (e = i.hit && i.pickedMesh ? i.pickedMesh.actionManager : null), l._meshPickProceed = !0 } return e }, this._delayedSimpleClick = function(e, t, i) {
                ((new Date).getTime() - l._previousStartingPointerTime > r.DoubleClickDelay && !l._doubleClickOccured || e !== l._previousButtonPressed) && (l._doubleClickOccured = !1, t.singleClick = !0, t.ignore = !1, i(t, l._currentPickResult)) }, this._initClickEvent = function(n, o, s, a) { var h = new t;
                l._currentPickResult = null; var c, u = n.hasSpecificMask(i.POINTERPICK) || o.hasSpecificMask(i.POINTERPICK) || n.hasSpecificMask(i.POINTERTAP) || o.hasSpecificMask(i.POINTERTAP) || n.hasSpecificMask(i.POINTERDOUBLETAP) || o.hasSpecificMask(i.POINTERDOUBLETAP); if (!u && e.ActionManager && e.ActionManager.HasPickTriggers && (c = l._initActionManager(c, h)) && (u = c.hasPickTriggers), u) { var d = s.button; if (h.hasSwiped = Math.abs(l._startingPointerPosition.x - l._pointerX) > r.DragMovementThreshold || Math.abs(l._startingPointerPosition.y - l._pointerY) > r.DragMovementThreshold, !h.hasSwiped) { var f = !r.ExclusiveDoubleClickMode;
                        f || (f = !n.hasSpecificMask(i.POINTERDOUBLETAP) && !o.hasSpecificMask(i.POINTERDOUBLETAP)) && !e.ActionManager.HasSpecificTrigger(e.ActionManager.OnDoublePickTrigger) && (c = l._initActionManager(c, h)) && (f = !c.hasSpecificTrigger(e.ActionManager.OnDoublePickTrigger)), f ? ((new Date).getTime() - l._previousStartingPointerTime > r.DoubleClickDelay || d !== l._previousButtonPressed) && (h.singleClick = !0, a(h, l._currentPickResult)) : (l._previousDelayedSimpleClickTimeout = l._delayedSimpleClickTimeout, l._delayedSimpleClickTimeout = window.setTimeout(l._delayedSimpleClick.bind(l, d, h, a), r.DoubleClickDelay)); var p = n.hasSpecificMask(i.POINTERDOUBLETAP) || o.hasSpecificMask(i.POINTERDOUBLETAP);!p && e.ActionManager.HasSpecificTrigger(e.ActionManager.OnDoublePickTrigger) && (c = l._initActionManager(c, h)) && (p = c.hasSpecificTrigger(e.ActionManager.OnDoublePickTrigger)), p && (d === l._previousButtonPressed && (new Date).getTime() - l._previousStartingPointerTime < r.DoubleClickDelay && !l._doubleClickOccured ? !h.hasSwiped && Math.abs(l._previousStartingPointerPosition.x - l._startingPointerPosition.x) < r.DragMovementThreshold && Math.abs(l._previousStartingPointerPosition.y - l._startingPointerPosition.y) < r.DragMovementThreshold ? (l._previousStartingPointerTime = 0, l._doubleClickOccured = !0, h.doubleClick = !0, h.ignore = !1, r.ExclusiveDoubleClickMode && l._previousDelayedSimpleClickTimeout && l._previousDelayedSimpleClickTimeout.clearTimeout && l._previousDelayedSimpleClickTimeout.clearTimeout(), l._previousDelayedSimpleClickTimeout = l._delayedSimpleClickTimeout, a(h, l._currentPickResult)) : (l._doubleClickOccured = !1, l._previousStartingPointerTime = l._startingPointerTime, l._previousStartingPointerPosition.x = l._startingPointerPosition.x, l._previousStartingPointerPosition.y = l._startingPointerPosition.y, l._previousButtonPressed = d, l._previousHasSwiped = h.hasSwiped, r.ExclusiveDoubleClickMode ? (l._previousDelayedSimpleClickTimeout && l._previousDelayedSimpleClickTimeout.clearTimeout && l._previousDelayedSimpleClickTimeout.clearTimeout(), l._previousDelayedSimpleClickTimeout = l._delayedSimpleClickTimeout, a(h, l._previousPickResult)) : a(h, l._currentPickResult)) : (l._doubleClickOccured = !1, l._previousStartingPointerTime = l._startingPointerTime, l._previousStartingPointerPosition.x = l._startingPointerPosition.x, l._previousStartingPointerPosition.y = l._startingPointerPosition.y, l._previousButtonPressed = d, l._previousHasSwiped = h.hasSwiped)) } }
                h.ignore = !0, a(h, l._currentPickResult) }; var c = function(e) { return e.isPickable && e.actionManager && e.actionManager.hasPointerTriggers };
            this._onPointerMove = function(e) { if (l._updatePointerPosition(e), l.onPrePointerObservable.hasObservers()) { var t = "mousewheel" === e.type || "DOMMouseScroll" === e.type ? i.POINTERWHEEL : i.POINTERMOVE,
                        r = new n(t, e, l._unTranslatedPointerX, l._unTranslatedPointerY); if (l.onPrePointerObservable.notifyObservers(r, t), r.skipOnPointerObservable) return } if (l.cameraToUseForPointers || l.activeCamera) { var s = l._engine.getRenderingCanvas();
                    l.pointerMovePredicate || (l.pointerMovePredicate = function(e) { return e.isPickable && e.isVisible && e.isReady() && (l.constantlyUpdateMeshUnderPointer || null !== e.actionManager && void 0 !== e.actionManager) }); var a = l.pick(l._unTranslatedPointerX, l._unTranslatedPointerY, l.pointerMovePredicate, !1, l.cameraToUseForPointers); if (a && a.hit && a.pickedMesh ? (l.setPointerOverSprite(null), l.setPointerOverMesh(a.pickedMesh), l._pointerOverMesh.actionManager && l._pointerOverMesh.actionManager.hasPointerTriggers ? l._pointerOverMesh.actionManager.hoverCursor ? s.style.cursor = l._pointerOverMesh.actionManager.hoverCursor : s.style.cursor = l.hoverCursor : s.style.cursor = "") : (l.setPointerOverMesh(null), a = l.pickSprite(l._unTranslatedPointerX, l._unTranslatedPointerY, c, !1, l.cameraToUseForPointers), a && a.hit && a.pickedSprite ? (l.setPointerOverSprite(a.pickedSprite), l._pointerOverSprite.actionManager && l._pointerOverSprite.actionManager.hoverCursor ? s.style.cursor = l._pointerOverSprite.actionManager.hoverCursor : s.style.cursor = l.hoverCursor) : (l.setPointerOverSprite(null), s.style.cursor = "")), l.onPointerMove && l.onPointerMove(e, a), l.onPointerObservable.hasObservers()) { var t = "mousewheel" === e.type || "DOMMouseScroll" === e.type ? i.POINTERWHEEL : i.POINTERMOVE,
                            r = new o(t, e, a);
                        l.onPointerObservable.notifyObservers(r, t) } } }, this._onPointerDown = function(t) { if (l._isButtonPressed = !0, l._pickedDownMesh = null, l._meshPickProceed = !1, l._updatePointerPosition(t), l.onPrePointerObservable.hasObservers()) { var s = i.POINTERDOWN,
                        a = new n(s, t, l._unTranslatedPointerX, l._unTranslatedPointerY); if (l.onPrePointerObservable.notifyObservers(a, s), a.skipOnPointerObservable) return } if (l.cameraToUseForPointers || l.activeCamera) { l._startingPointerPosition.x = l._pointerX, l._startingPointerPosition.y = l._pointerY, l._startingPointerTime = (new Date).getTime(), l.pointerDownPredicate || (l.pointerDownPredicate = function(e) { return e.isPickable && e.isVisible && e.isReady() }), l._pickedDownMesh = null; var h = l.pick(l._unTranslatedPointerX, l._unTranslatedPointerY, l.pointerDownPredicate, !1, l.cameraToUseForPointers); if (h && h.hit && h.pickedMesh) { l._pickedDownMesh = h.pickedMesh; var u = h.pickedMesh.actionManager; if (u) { if (u.hasPickTriggers) switch (u.processTrigger(e.ActionManager.OnPickDownTrigger, e.ActionEvent.CreateNew(h.pickedMesh, t)), t.button) {
                                case 0:
                                    u.processTrigger(e.ActionManager.OnLeftPickTrigger, e.ActionEvent.CreateNew(h.pickedMesh, t)); break;
                                case 1:
                                    u.processTrigger(e.ActionManager.OnCenterPickTrigger, e.ActionEvent.CreateNew(h.pickedMesh, t)); break;
                                case 2:
                                    u.processTrigger(e.ActionManager.OnRightPickTrigger, e.ActionEvent.CreateNew(h.pickedMesh, t)) }
                            u.hasSpecificTrigger(e.ActionManager.OnLongPressTrigger) && window.setTimeout(function() { var i = this,
                                    n = this.pick(this._unTranslatedPointerX, this._unTranslatedPointerY, (function(t) { return t.isPickable && t.isVisible && t.isReady() && t.actionManager && t.actionManager.hasSpecificTrigger(e.ActionManager.OnLongPressTrigger) && t == i._pickedDownMesh }), !1, this.cameraToUseForPointers);
                                n && n.hit && n.pickedMesh && this._isButtonPressed && (new Date).getTime() - this._startingPointerTime > r.LongPressDelay && Math.abs(this._startingPointerPosition.x - this._pointerX) < r.DragMovementThreshold && Math.abs(this._startingPointerPosition.y - this._pointerY) < r.DragMovementThreshold && (this._startingPointerTime = 0, u.processTrigger(e.ActionManager.OnLongPressTrigger, e.ActionEvent.CreateNew(n.pickedMesh, t))) }.bind(l), r.LongPressDelay) } } if (l.onPointerDown && l.onPointerDown(t, h), l.onPointerObservable.hasObservers()) { var s = i.POINTERDOWN,
                            a = new o(s, t, h);
                        l.onPointerObservable.notifyObservers(a, s) } if (l._pickedDownSprite = null, l.spriteManagers.length > 0 && (h = l.pickSprite(l._unTranslatedPointerX, l._unTranslatedPointerY, c, !1, l.cameraToUseForPointers)) && h.hit && h.pickedSprite && h.pickedSprite.actionManager) { switch (l._pickedDownSprite = h.pickedSprite, t.button) {
                            case 0:
                                h.pickedSprite.actionManager.processTrigger(e.ActionManager.OnLeftPickTrigger, e.ActionEvent.CreateNewFromSprite(h.pickedSprite, l, t)); break;
                            case 1:
                                h.pickedSprite.actionManager.processTrigger(e.ActionManager.OnCenterPickTrigger, e.ActionEvent.CreateNewFromSprite(h.pickedSprite, l, t)); break;
                            case 2:
                                h.pickedSprite.actionManager.processTrigger(e.ActionManager.OnRightPickTrigger, e.ActionEvent.CreateNewFromSprite(h.pickedSprite, l, t)) }
                        h.pickedSprite.actionManager && h.pickedSprite.actionManager.processTrigger(e.ActionManager.OnPickDownTrigger, e.ActionEvent.CreateNewFromSprite(h.pickedSprite, l, t)) } } }, this._onPointerUp = function(t) { l._isButtonPressed = !1, l._pickedUpMesh = null, l._meshPickProceed = !1, l._updatePointerPosition(t), l._initClickEvent(l.onPrePointerObservable, l.onPointerObservable, t, function(s, a) { if (this.onPrePointerObservable.hasObservers())
                        if (s.ignore) { var h = i.POINTERUP,
                                l = new n(h, t, this._unTranslatedPointerX, this._unTranslatedPointerY); if (this.onPrePointerObservable.notifyObservers(l, h), l.skipOnPointerObservable) return } else if (!s.hasSwiped) { if (s.singleClick && this.onPrePointerObservable.hasSpecificMask(i.POINTERTAP)) { var h = i.POINTERTAP,
                                l = new n(h, t, this._unTranslatedPointerX, this._unTranslatedPointerY); if (this.onPrePointerObservable.notifyObservers(l, h), l.skipOnPointerObservable) return } if (s.doubleClick && this.onPrePointerObservable.hasSpecificMask(i.POINTERDOUBLETAP)) { var h = i.POINTERDOUBLETAP,
                                l = new n(h, t, this._unTranslatedPointerX, this._unTranslatedPointerY); if (this.onPrePointerObservable.notifyObservers(l, h), l.skipOnPointerObservable) return } } if (this.cameraToUseForPointers || this.activeCamera) { if (this.pointerUpPredicate || (this.pointerUpPredicate = function(e) { return e.isPickable && e.isVisible && e.isReady() }), !this._meshPickProceed && (e.ActionManager && e.ActionManager.HasTriggers || this.onPointerObservable.hasObservers()) && this._initActionManager(null, s), a || (a = this._currentPickResult), a && a && a.pickedMesh) { if (this._pickedUpMesh = a.pickedMesh, this._pickedDownMesh === this._pickedUpMesh && (this.onPointerPick && this.onPointerPick(t, a), s.singleClick && !s.ignore && this.onPointerObservable.hasObservers())) { var h = i.POINTERPICK,
                                    l = new o(h, t, a);
                                this.onPointerObservable.notifyObservers(l, h) }
                            a.pickedMesh.actionManager && (s.ignore && a.pickedMesh.actionManager.processTrigger(e.ActionManager.OnPickUpTrigger, e.ActionEvent.CreateNew(a.pickedMesh, t)), s.hasSwiped || s.ignore || !s.singleClick || a.pickedMesh.actionManager.processTrigger(e.ActionManager.OnPickTrigger, e.ActionEvent.CreateNew(a.pickedMesh, t)), s.doubleClick && !s.ignore && a.pickedMesh.actionManager.hasSpecificTrigger(e.ActionManager.OnDoublePickTrigger) && a.pickedMesh.actionManager.processTrigger(e.ActionManager.OnDoublePickTrigger, e.ActionEvent.CreateNew(a.pickedMesh, t))) } if (this._pickedDownMesh && this._pickedDownMesh.actionManager && this._pickedDownMesh.actionManager.hasSpecificTrigger(e.ActionManager.OnPickOutTrigger) && this._pickedDownMesh !== this._pickedUpMesh && this._pickedDownMesh.actionManager.processTrigger(e.ActionManager.OnPickOutTrigger, e.ActionEvent.CreateNew(this._pickedDownMesh, t)), this.onPointerUp && this.onPointerUp(t, a), this.onPointerObservable.hasObservers())
                            if (s.ignore) { var h = i.POINTERUP,
                                    l = new o(h, t, a);
                                this.onPointerObservable.notifyObservers(l, h) } else if (!s.hasSwiped) { if (s.singleClick && this.onPointerObservable.hasSpecificMask(i.POINTERTAP)) { var h = i.POINTERTAP,
                                    l = new o(h, t, a);
                                this.onPointerObservable.notifyObservers(l, h) } if (s.doubleClick && this.onPointerObservable.hasSpecificMask(i.POINTERDOUBLETAP)) { var h = i.POINTERDOUBLETAP,
                                    l = new o(h, t, a);
                                this.onPointerObservable.notifyObservers(l, h) } }
                        this.spriteManagers.length > 0 && (a = this.pickSprite(this._unTranslatedPointerX, this._unTranslatedPointerY, c, !1, this.cameraToUseForPointers), a.hit && a.pickedSprite && a.pickedSprite.actionManager && (a.pickedSprite.actionManager.processTrigger(e.ActionManager.OnPickUpTrigger, e.ActionEvent.CreateNewFromSprite(a.pickedSprite, this, t)), a.pickedSprite.actionManager && Math.abs(this._startingPointerPosition.x - this._pointerX) < r.DragMovementThreshold && Math.abs(this._startingPointerPosition.y - this._pointerY) < r.DragMovementThreshold && a.pickedSprite.actionManager.processTrigger(e.ActionManager.OnPickTrigger, e.ActionEvent.CreateNewFromSprite(a.pickedSprite, this, t))), this._pickedDownSprite && this._pickedDownSprite.actionManager && this._pickedDownSprite !== a.pickedSprite && this._pickedDownSprite.actionManager.processTrigger(e.ActionManager.OnPickOutTrigger, e.ActionEvent.CreateNewFromSprite(this._pickedDownSprite, this, t))), this._previousPickResult = this._currentPickResult } }.bind(l)) }, this._onKeyDown = function(t) { l.actionManager && l.actionManager.processTrigger(e.ActionManager.OnKeyDownTrigger, e.ActionEvent.CreateNewFromScene(l, t)) }, this._onKeyUp = function(t) { l.actionManager && l.actionManager.processTrigger(e.ActionManager.OnKeyUpTrigger, e.ActionEvent.CreateNewFromScene(l, t)) }; var u = e.Tools.GetPointerPrefix(),
                d = this._engine.getRenderingCanvas();
            h && (d.addEventListener(u + "move", this._onPointerMove, !1), d.addEventListener("mousewheel", this._onPointerMove, !1), d.addEventListener("DOMMouseScroll", this._onPointerMove, !1)), a && d.addEventListener(u + "down", this._onPointerDown, !1), s && d.addEventListener(u + "up", this._onPointerUp, !1), d.tabIndex = 1, d.addEventListener("keydown", this._onKeyDown, !1), d.addEventListener("keyup", this._onKeyUp, !1) }, r.prototype.detachControl = function() { var t = e.Tools.GetPointerPrefix(),
                i = this._engine.getRenderingCanvas();
            i.removeEventListener(t + "move", this._onPointerMove), i.removeEventListener(t + "down", this._onPointerDown), i.removeEventListener(t + "up", this._onPointerUp), i.removeEventListener("mousewheel", this._onPointerMove), i.removeEventListener("DOMMouseScroll", this._onPointerMove), i.removeEventListener("keydown", this._onKeyDown), i.removeEventListener("keyup", this._onKeyUp) }, r.prototype.isReady = function() { if (this._pendingData.length > 0) return !1; var t; for (t = 0; t < this._geometries.length; t++) { if (this._geometries[t].delayLoadState === e.Engine.DELAYLOADSTATE_LOADING) return !1 } for (t = 0; t < this.meshes.length; t++) { var i = this.meshes[t]; if (i.isEnabled() && (i.subMeshes && 0 !== i.subMeshes.length)) { if (!i.isReady()) return !1; var r = i.material; if (r && !r.isReady(i)) return !1 } } return !0 }, r.prototype.resetCachedMaterial = function() { this._cachedMaterial = null, this._cachedEffect = null }, r.prototype.registerBeforeRender = function(e) { this.onBeforeRenderObservable.add(e) }, r.prototype.unregisterBeforeRender = function(e) { this.onBeforeRenderObservable.removeCallback(e) }, r.prototype.registerAfterRender = function(e) { this.onAfterRenderObservable.add(e) }, r.prototype.unregisterAfterRender = function(e) { this.onAfterRenderObservable.removeCallback(e) }, r.prototype._addPendingData = function(e) { this._pendingData.push(e) }, r.prototype._removePendingData = function(e) { var t = this._pendingData.indexOf(e);
            t !== -1 && this._pendingData.splice(t, 1) }, r.prototype.getWaitingItemsCount = function() { return this._pendingData.length }, r.prototype.executeWhenReady = function(e) { var t = this;
            this.onReadyObservable.add(e), this._executeWhenReadyTimeoutId === -1 && (this._executeWhenReadyTimeoutId = setTimeout((function() { t._checkIsReady() }), 150)) }, r.prototype._checkIsReady = function() { var e = this; if (this.isReady()) return this.onReadyObservable.notifyObservers(this), this.onReadyObservable.clear(), void(this._executeWhenReadyTimeoutId = -1);
            this._executeWhenReadyTimeoutId = setTimeout((function() { e._checkIsReady() }), 150) }, r.prototype.beginAnimation = function(t, i, r, n, o, s, a) { if (void 0 === o && (o = 1), this.stopAnimation(t), a || (a = new e.Animatable(this, t, i, r, n, o, s)), t.animations && a.appendAnimations(t, t.animations), t.getAnimatables)
                for (var h = t.getAnimatables(), l = 0; l < h.length; l++) this.beginAnimation(h[l], i, r, n, o, s, a); return a.reset(), a }, r.prototype.beginDirectAnimation = function(t, i, r, n, o, s, a) { return void 0 === s && (s = 1), new e.Animatable(this, t, r, n, o, s, a, i) }, r.prototype.getAnimatableByTarget = function(e) { for (var t = 0; t < this._activeAnimatables.length; t++)
                if (this._activeAnimatables[t].target === e) return this._activeAnimatables[t];
            return null }, Object.defineProperty(r.prototype, "Animatables", { get: function() { return this._activeAnimatables }, enumerable: !0, configurable: !0 }), r.prototype.stopAnimation = function(e, t) { var i = this.getAnimatableByTarget(e);
            i && i.stop(t) }, r.prototype._animate = function() { if (this.animationsEnabled && 0 !== this._activeAnimatables.length) { var t = e.Tools.Now; if (!this._animationTimeLast) { if (this._pendingData.length > 0) return;
                    this._animationTimeLast = t } var i = (t - this._animationTimeLast) * this.animationTimeScale;
                this._animationTime += i, this._animationTimeLast = t; for (var r = 0; r < this._activeAnimatables.length; r++) this._activeAnimatables[r]._animate(this._animationTime) } }, r.prototype.getViewMatrix = function() { return this._viewMatrix }, r.prototype.getProjectionMatrix = function() { return this._projectionMatrix }, r.prototype.getTransformMatrix = function() { return this._transformMatrix }, r.prototype.setTransformMatrix = function(t, i) { this._viewUpdateFlag === t.updateFlag && this._projectionUpdateFlag === i.updateFlag || (this._viewUpdateFlag = t.updateFlag, this._projectionUpdateFlag = i.updateFlag, this._viewMatrix = t, this._projectionMatrix = i, this._viewMatrix.multiplyToRef(this._projectionMatrix, this._transformMatrix), this._frustumPlanes ? e.Frustum.GetPlanesToRef(this._transformMatrix, this._frustumPlanes) : this._frustumPlanes = e.Frustum.GetPlanes(this._transformMatrix)) }, r.prototype.getUniqueId = function() { var e = this._uniqueIdCounter; return this._uniqueIdCounter++, e }, r.prototype.addMesh = function(e) { e.uniqueId = this.getUniqueId();
            this.meshes.push(e);
            this.collisionCoordinator && this.collisionCoordinator.onMeshAdded(e), this.onNewMeshAddedObservable.notifyObservers(e) }, r.prototype.removeMesh = function(e) { var t = this.meshes.indexOf(e); return t !== -1 && this.meshes.splice(t, 1), this.collisionCoordinator && this.collisionCoordinator.onMeshRemoved(e), this.onMeshRemovedObservable.notifyObservers(e), t }, r.prototype.removeSkeleton = function(e) { var t = this.skeletons.indexOf(e); return t !== -1 && this.skeletons.splice(t, 1), t }, r.prototype.removeMorphTargetManager = function(e) { var t = this.morphTargetManagers.indexOf(e); return t !== -1 && this.morphTargetManagers.splice(t, 1), t }, r.prototype.removeLight = function(e) { var t = this.lights.indexOf(e); return t !== -1 && this.lights.splice(t, 1), this.onLightRemovedObservable.notifyObservers(e), t }, r.prototype.removeCamera = function(e) { var t = this.cameras.indexOf(e);
            t !== -1 && this.cameras.splice(t, 1); var i = this.activeCameras.indexOf(e); return i !== -1 && this.activeCameras.splice(i, 1), this.activeCamera === e && (this.cameras.length > 0 ? this.activeCamera = this.cameras[0] : this.activeCamera = null), this.onCameraRemovedObservable.notifyObservers(e), t }, r.prototype.addLight = function(e) { e.uniqueId = this.getUniqueId();
            this.lights.push(e);
            this.onNewLightAddedObservable.notifyObservers(e) }, r.prototype.addCamera = function(e) { e.uniqueId = this.getUniqueId();
            this.cameras.push(e);
            this.onNewCameraAddedObservable.notifyObservers(e) }, r.prototype.switchActiveCamera = function(e, t) { void 0 === t && (t = !0); var i = this._engine.getRenderingCanvas();
            this.activeCamera.detachControl(i), this.activeCamera = e, t && e.attachControl(i) }, r.prototype.setActiveCameraByID = function(e) { var t = this.getCameraByID(e); return t ? (this.activeCamera = t, t) : null }, r.prototype.setActiveCameraByName = function(e) { var t = this.getCameraByName(e); return t ? (this.activeCamera = t, t) : null }, r.prototype.getMaterialByID = function(e) { for (var t = 0; t < this.materials.length; t++)
                if (this.materials[t].id === e) return this.materials[t];
            return null }, r.prototype.getMaterialByName = function(e) { for (var t = 0; t < this.materials.length; t++)
                if (this.materials[t].name === e) return this.materials[t];
            return null }, r.prototype.getLensFlareSystemByName = function(e) { for (var t = 0; t < this.lensFlareSystems.length; t++)
                if (this.lensFlareSystems[t].name === e) return this.lensFlareSystems[t];
            return null }, r.prototype.getLensFlareSystemByID = function(e) { for (var t = 0; t < this.lensFlareSystems.length; t++)
                if (this.lensFlareSystems[t].id === e) return this.lensFlareSystems[t];
            return null }, r.prototype.getCameraByID = function(e) { for (var t = 0; t < this.cameras.length; t++)
                if (this.cameras[t].id === e) return this.cameras[t];
            return null }, r.prototype.getCameraByUniqueID = function(e) { for (var t = 0; t < this.cameras.length; t++)
                if (this.cameras[t].uniqueId === e) return this.cameras[t];
            return null }, r.prototype.getCameraByName = function(e) { for (var t = 0; t < this.cameras.length; t++)
                if (this.cameras[t].name === e) return this.cameras[t];
            return null }, r.prototype.getBoneByID = function(e) { for (var t = 0; t < this.skeletons.length; t++)
                for (var i = this.skeletons[t], r = 0; r < i.bones.length; r++)
                    if (i.bones[r].id === e) return i.bones[r];
            return null }, r.prototype.getBoneByName = function(e) { for (var t = 0; t < this.skeletons.length; t++)
                for (var i = this.skeletons[t], r = 0; r < i.bones.length; r++)
                    if (i.bones[r].name === e) return i.bones[r];
            return null }, r.prototype.getLightByName = function(e) { for (var t = 0; t < this.lights.length; t++)
                if (this.lights[t].name === e) return this.lights[t];
            return null }, r.prototype.getLightByID = function(e) { for (var t = 0; t < this.lights.length; t++)
                if (this.lights[t].id === e) return this.lights[t];
            return null }, r.prototype.getLightByUniqueID = function(e) { for (var t = 0; t < this.lights.length; t++)
                if (this.lights[t].uniqueId === e) return this.lights[t];
            return null }, r.prototype.getParticleSystemByID = function(e) { for (var t = 0; t < this.particleSystems.length; t++)
                if (this.particleSystems[t].id === e) return this.particleSystems[t];
            return null }, r.prototype.getGeometryByID = function(e) { for (var t = 0; t < this._geometries.length; t++)
                if (this._geometries[t].id === e) return this._geometries[t];
            return null }, r.prototype.pushGeometry = function(e, t) { return !(!t && this.getGeometryByID(e.id)) && (this._geometries.push(e), this.collisionCoordinator && this.collisionCoordinator.onGeometryAdded(e), this.onNewGeometryAddedObservable.notifyObservers(e), !0) }, r.prototype.removeGeometry = function(e) { var t = this._geometries.indexOf(e); return t > -1 && (this._geometries.splice(t, 1), this.collisionCoordinator && this.collisionCoordinator.onGeometryDeleted(e), this.onGeometryRemovedObservable.notifyObservers(e), !0) }, r.prototype.getGeometries = function() { return this._geometries }, r.prototype.getMeshByID = function(e) { for (var t = 0; t < this.meshes.length; t++)
                if (this.meshes[t].id === e) return this.meshes[t];
            return null }, r.prototype.getMeshesByID = function(e) { return this.meshes.filter((function(t) { return t.id === e })) }, r.prototype.getMeshByUniqueID = function(e) { for (var t = 0; t < this.meshes.length; t++)
                if (this.meshes[t].uniqueId === e) return this.meshes[t];
            return null }, r.prototype.getLastMeshByID = function(e) { for (var t = this.meshes.length - 1; t >= 0; t--)
                if (this.meshes[t].id === e) return this.meshes[t];
            return null }, r.prototype.getLastEntryByID = function(e) { var t; for (t = this.meshes.length - 1; t >= 0; t--)
                if (this.meshes[t].id === e) return this.meshes[t];
            for (t = this.cameras.length - 1; t >= 0; t--)
                if (this.cameras[t].id === e) return this.cameras[t];
            for (t = this.lights.length - 1; t >= 0; t--)
                if (this.lights[t].id === e) return this.lights[t];
            return null }, r.prototype.getNodeByID = function(e) { var t = this.getMeshByID(e); if (t) return t; var i = this.getLightByID(e); if (i) return i; var r = this.getCameraByID(e); return r || this.getBoneByID(e) }, r.prototype.getNodeByName = function(e) { var t = this.getMeshByName(e); if (t) return t; var i = this.getLightByName(e); if (i) return i; var r = this.getCameraByName(e); return r || this.getBoneByName(e) }, r.prototype.getMeshByName = function(e) { for (var t = 0; t < this.meshes.length; t++)
                if (this.meshes[t].name === e) return this.meshes[t];
            return null }, r.prototype.getSoundByName = function(t) { var i; if (e.AudioEngine) { for (i = 0; i < this.mainSoundTrack.soundCollection.length; i++)
                    if (this.mainSoundTrack.soundCollection[i].name === t) return this.mainSoundTrack.soundCollection[i];
                for (var r = 0; r < this.soundTracks.length; r++)
                    for (i = 0; i < this.soundTracks[r].soundCollection.length; i++)
                        if (this.soundTracks[r].soundCollection[i].name === t) return this.soundTracks[r].soundCollection[i] } return null }, r.prototype.getLastSkeletonByID = function(e) { for (var t = this.skeletons.length - 1; t >= 0; t--)
                if (this.skeletons[t].id === e) return this.skeletons[t];
            return null }, r.prototype.getSkeletonById = function(e) { for (var t = 0; t < this.skeletons.length; t++)
                if (this.skeletons[t].id === e) return this.skeletons[t];
            return null }, r.prototype.getSkeletonByName = function(e) { for (var t = 0; t < this.skeletons.length; t++)
                if (this.skeletons[t].name === e) return this.skeletons[t];
            return null }, r.prototype.getMorphTargetManagerById = function(e) { for (var t = 0; t < this.morphTargetManagers.length; t++)
                if (this.morphTargetManagers[t].uniqueId === e) return this.morphTargetManagers[t];
            return null }, r.prototype.isActiveMesh = function(e) { return this._activeMeshes.indexOf(e) !== -1 }, r.prototype.getHighlightLayerByName = function(e) { for (var t = 0; t < this.highlightLayers.length; t++)
                if (this.highlightLayers[t].name === e) return this.highlightLayers[t];
            return null }, Object.defineProperty(r.prototype, "uid", { get: function() { return this._uid || (this._uid = e.Tools.RandomId()), this._uid }, enumerable: !0, configurable: !0 }), r.prototype.addExternalData = function(t, i) { return this._externalData || (this._externalData = new e.StringDictionary), this._externalData.add(t, i) }, r.prototype.getExternalData = function(e) { return this._externalData ? this._externalData.get(e) : null }, r.prototype.getOrAddExternalDataWithFactory = function(t, i) { return this._externalData || (this._externalData = new e.StringDictionary), this._externalData.getOrAddWithFactory(t, i) }, r.prototype.removeExternalData = function(e) { return this._externalData.remove(e) }, r.prototype._evaluateSubMesh = function(e, t) { if (t.alwaysSelectAsActiveMesh || 1 === t.subMeshes.length || e.isInFrustum(this._frustumPlanes)) { var i = e.getMaterial();
                t.showSubMeshesBoundingBox && this.getBoundingBoxRenderer().renderList.push(e.getBoundingInfo().boundingBox), i && (i.getRenderTargetTextures && this._processedMaterials.indexOf(i) === -1 && (this._processedMaterials.push(i), this._renderTargets.concatWithNoDuplicate(i.getRenderTargetTextures())), this._activeIndices.addCount(e.indexCount, !1), this._renderingManager.dispatch(e)) } }, r.prototype._isInIntermediateRendering = function() { return this._intermediateRendering }, r.prototype._evaluateActiveMeshes = function() { this.activeCamera._activeMeshes.reset(), this._activeMeshes.reset(), this._renderingManager.reset(), this._processedMaterials.reset(), this._activeParticleSystems.reset(), this._activeSkeletons.reset(), this._softwareSkinnedMeshes.reset(), this._boundingBoxRenderer && this._boundingBoxRenderer.reset(), this._edgesRenderers.reset(); var t, i; if (this._selectionOctree) { var r = this._selectionOctree.select(this._frustumPlanes);
                t = r.data, i = r.length } else i = this.meshes.length, t = this.meshes; for (var n = 0; n < i; n++) { var o = t[n]; if (!o.isBlocked && (this._totalVertices.addCount(o.getTotalVertices(), !1), o.isReady() && o.isEnabled())) { o.computeWorldMatrix(), o.actionManager && o.actionManager.hasSpecificTriggers([e.ActionManager.OnIntersectionEnterTrigger, e.ActionManager.OnIntersectionExitTrigger]) && this._meshesForIntersections.pushNoDuplicate(o); var s = o.getLOD(this.activeCamera);
                    s && (o._preActivate(), (o.alwaysSelectAsActiveMesh || o.isVisible && o.visibility > 0 && 0 != (o.layerMask & this.activeCamera.layerMask) && o.isInFrustum(this._frustumPlanes)) && (this._activeMeshes.push(o), this.activeCamera._activeMeshes.push(o), o._activate(this._renderId), this._activeMesh(o, s))) } }
            this._particlesDuration.beginMonitoring();
            e.Tools.Now; if (this.particlesEnabled) { e.Tools.StartPerformanceCounter("Particles", this.particleSystems.length > 0); for (var a = 0; a < this.particleSystems.length; a++) { var h = this.particleSystems[a];
                    h.isStarted() && ((!h.emitter.position || h.emitter && h.emitter.isEnabled()) && (this._activeParticleSystems.push(h), h.animate(), this._renderingManager.dispatchParticles(h))) }
                e.Tools.EndPerformanceCounter("Particles", this.particleSystems.length > 0) }
            this._particlesDuration.endMonitoring(!1) }, r.prototype._activeMesh = function(e, t) { if (t.skeleton && this.skeletonsEnabled && (this._activeSkeletons.pushNoDuplicate(t.skeleton) && t.skeleton.prepare(), t.computeBonesUsingShaders || this._softwareSkinnedMeshes.pushNoDuplicate(t)), (e.showBoundingBox || this.forceShowBoundingBoxes) && this.getBoundingBoxRenderer().renderList.push(e.getBoundingInfo().boundingBox), e._edgesRenderer && this._edgesRenderers.push(e._edgesRenderer), t && t.subMeshes) { var i, r; if (t._submeshesOctree && t.useOctreeForRenderingSelection) { var n = t._submeshesOctree.select(this._frustumPlanes);
                    i = n.length, r = n.data } else r = t.subMeshes, i = r.length; for (var o = 0; o < i; o++) { var s = r[o];
                    this._evaluateSubMesh(s, t) } } }, r.prototype.updateTransformMatrix = function(e) { this.setTransformMatrix(this.activeCamera.getViewMatrix(), this.activeCamera.getProjectionMatrix(e)) }, r.prototype._renderForCamera = function(t) {
            var i = this._engine;
            e.Tools.Now;
            if (this.activeCamera = t, !this.activeCamera) throw new Error("Active camera not set");
            e.Tools.StartPerformanceCounter("Rendering camera " + this.activeCamera.name), i.setViewport(this.activeCamera.viewport), this.resetCachedMaterial(), this._renderId++, this.updateTransformMatrix(), this.onBeforeCameraRenderObservable.notifyObservers(this.activeCamera),
                this._evaluateActiveMeshesDuration.beginMonitoring(), e.Tools.StartPerformanceCounter("Active meshes evaluation"), this._evaluateActiveMeshes(), this._evaluateActiveMeshesDuration.endMonitoring(!1), e.Tools.EndPerformanceCounter("Active meshes evaluation");
            for (var r = 0; r < this._softwareSkinnedMeshes.length; r++) { var n = this._softwareSkinnedMeshes.data[r];
                n.applySkeleton(n.skeleton) }
            this._renderTargetsDuration.beginMonitoring();
            var o = !1;
            e.Tools.Now;
            if (this.renderTargetsEnabled && this._renderTargets.length > 0) { this._intermediateRendering = !0, e.Tools.StartPerformanceCounter("Render targets", this._renderTargets.length > 0); for (var s = 0; s < this._renderTargets.length; s++) { var a = this._renderTargets.data[s]; if (a._shouldRender()) { this._renderId++; var h = a.activeCamera && a.activeCamera !== this.activeCamera;
                        a.render(h, this.dumpNextRenderTargets) } }
                e.Tools.EndPerformanceCounter("Render targets", this._renderTargets.length > 0), this._intermediateRendering = !1, this._renderId++, o = !0 }
            var l = this._engine.getStencilBuffer(),
                c = !1;
            if (this.renderTargetsEnabled && this.highlightLayers && this.highlightLayers.length > 0) { this._intermediateRendering = !0; for (var u = 0; u < this.highlightLayers.length; u++) { var d = this.highlightLayers[u]; if (d.shouldRender() && (!d.camera || d.camera.cameraRigMode === e.Camera.RIG_MODE_NONE && t === d.camera || d.camera.cameraRigMode !== e.Camera.RIG_MODE_NONE && d.camera._rigCameras.indexOf(t) > -1)) { c = !0; var a = d._mainTexture;
                        a._shouldRender() && (this._renderId++, a.render(!1, !1), o = !0) } }
                this._intermediateRendering = !1, this._renderId++ }
            o && i.restoreDefaultFramebuffer(), this._renderTargetsDuration.endMonitoring(!1), this.postProcessManager._prepareFrame(), this._renderDuration.beginMonitoring();
            var f, p;
            if (this.layers.length) { for (i.setDepthBuffer(!1), f = 0; f < this.layers.length; f++) p = this.layers[f], p.isBackground && p.render();
                i.setDepthBuffer(!0) }
            e.Tools.StartPerformanceCounter("Main render"), c && this._engine.setStencilBuffer(!0), this._renderingManager.render(null, null, !0, !0), c && this._engine.setStencilBuffer(l), e.Tools.EndPerformanceCounter("Main render"), this._boundingBoxRenderer && this._boundingBoxRenderer.render();
            for (var _ = 0; _ < this._edgesRenderers.length; _++) this._edgesRenderers.data[_].render();
            if (this.lensFlaresEnabled) { e.Tools.StartPerformanceCounter("Lens flares", this.lensFlareSystems.length > 0); for (var m = 0; m < this.lensFlareSystems.length; m++) { var g = this.lensFlareSystems[m];
                    0 != (t.layerMask & g.layerMask) && g.render() }
                e.Tools.EndPerformanceCounter("Lens flares", this.lensFlareSystems.length > 0) }
            if (this.layers.length) { for (i.setDepthBuffer(!1), f = 0; f < this.layers.length; f++) p = this.layers[f], p.isBackground || p.render();
                i.setDepthBuffer(!0) }
            if (c) { i.setDepthBuffer(!1); for (var u = 0; u < this.highlightLayers.length; u++) this.highlightLayers[u].shouldRender() && this.highlightLayers[u].render();
                i.setDepthBuffer(!0) }
            this._renderDuration.endMonitoring(!1), this.postProcessManager._finalizeFrame(t.isIntermediate), this.activeCamera._updateFromScene(), this._renderTargets.reset(), this.onAfterCameraRenderObservable.notifyObservers(this.activeCamera), e.Tools.EndPerformanceCounter("Rendering camera " + this.activeCamera.name)
        }, r.prototype._processSubCameras = function(t) { if (t.cameraRigMode === e.Camera.RIG_MODE_NONE) return void this._renderForCamera(t); for (var i = 0; i < t._rigCameras.length; i++) this._renderForCamera(t._rigCameras[i]);
            this.activeCamera = t, this.setTransformMatrix(this.activeCamera.getViewMatrix(), this.activeCamera.getProjectionMatrix()), this.activeCamera._updateFromScene() }, r.prototype._checkIntersections = function() { for (var t = 0; t < this._meshesForIntersections.length; t++)
                for (var i = this._meshesForIntersections.data[t], r = 0; r < i.actionManager.actions.length; r++) { var n = i.actionManager.actions[r]; if (n.trigger === e.ActionManager.OnIntersectionEnterTrigger || n.trigger === e.ActionManager.OnIntersectionExitTrigger) { var o = n.getTriggerParameter(),
                            s = o instanceof e.AbstractMesh ? o : o.mesh,
                            a = s.intersectsMesh(i, o.usePreciseIntersection),
                            h = i._intersectionsInProgress.indexOf(s);
                        a && h === -1 ? n.trigger === e.ActionManager.OnIntersectionEnterTrigger ? (n._executeCurrent(e.ActionEvent.CreateNew(i, null, s)), i._intersectionsInProgress.push(s)) : n.trigger === e.ActionManager.OnIntersectionExitTrigger && i._intersectionsInProgress.push(s) : !a && h > -1 && (n.trigger === e.ActionManager.OnIntersectionExitTrigger && n._executeCurrent(e.ActionEvent.CreateNew(i, null, s)), i.actionManager.hasSpecificTrigger(e.ActionManager.OnIntersectionExitTrigger) && n.trigger !== e.ActionManager.OnIntersectionExitTrigger || i._intersectionsInProgress.splice(h, 1)) } } }, r.prototype.render = function() { if (!this.isDisposed) { this._lastFrameDuration.beginMonitoring(), this._particlesDuration.fetchNewFrame(), this._spritesDuration.fetchNewFrame(), this._activeParticles.fetchNewFrame(), this._renderDuration.fetchNewFrame(), this._renderTargetsDuration.fetchNewFrame(), this._evaluateActiveMeshesDuration.fetchNewFrame(), this._totalVertices.fetchNewFrame(), this._activeIndices.fetchNewFrame(), this._activeBones.fetchNewFrame(), this.getEngine().drawCallsPerfCounter.fetchNewFrame(), this._meshesForIntersections.reset(), this.resetCachedMaterial(), e.Tools.StartPerformanceCounter("Scene rendering"), this.actionManager && this.actionManager.processTrigger(e.ActionManager.OnEveryFrameTrigger, null), this.simplificationQueue && !this.simplificationQueue.running && this.simplificationQueue.executeNext(); var t = Math.max(r.MinDeltaTime, Math.min(this._engine.getDeltaTime(), r.MaxDeltaTime));
                this._animationRatio = .06 * t, this._animate(), this._physicsEngine && (e.Tools.StartPerformanceCounter("Physics"), this._physicsEngine._step(t / 1e3), e.Tools.EndPerformanceCounter("Physics")), this.onBeforeRenderObservable.notifyObservers(this), this._renderTargetsDuration.beginMonitoring(); var i = (e.Tools.Now, this.getEngine()),
                    n = this.activeCamera; if (this.renderTargetsEnabled) { e.Tools.StartPerformanceCounter("Custom render targets", this.customRenderTargets.length > 0); for (var o = 0; o < this.customRenderTargets.length; o++) { var s = this.customRenderTargets[o]; if (s._shouldRender()) { if (this._renderId++, this.activeCamera = s.activeCamera || this.activeCamera, !this.activeCamera) throw new Error("Active camera not set");
                            i.setViewport(this.activeCamera.viewport), this.updateTransformMatrix(), s.render(n !== this.activeCamera, this.dumpNextRenderTargets) } }
                    e.Tools.EndPerformanceCounter("Custom render targets", this.customRenderTargets.length > 0), this._renderId++ } if (this.customRenderTargets.length > 0 && i.restoreDefaultFramebuffer(), this._renderTargetsDuration.endMonitoring(), this.activeCamera = n, this.proceduralTexturesEnabled) { e.Tools.StartPerformanceCounter("Procedural textures", this._proceduralTextures.length > 0); for (var a = 0; a < this._proceduralTextures.length; a++) { var h = this._proceduralTextures[a];
                        h._shouldRender() && h.render() }
                    e.Tools.EndPerformanceCounter("Procedural textures", this._proceduralTextures.length > 0) } if (this._engine.clear(this.clearColor, this.autoClear || this.forceWireframe || this.forcePointsCloud, !0, !0), this.shadowsEnabled)
                    for (var l = 0; l < this.lights.length; l++) { var c = this.lights[l],
                            u = c.getShadowGenerator();
                        c.isEnabled() && u && u.getShadowMap().getScene().textures.indexOf(u.getShadowMap()) !== -1 && this._renderTargets.push(u.getShadowMap()) }
                if (this._depthRenderer && this._renderTargets.push(this._depthRenderer.getDepthMap()), this._postProcessRenderPipelineManager && this._postProcessRenderPipelineManager.update(), this.activeCameras.length > 0)
                    for (var d = 0; d < this.activeCameras.length; d++) d > 0 && this._engine.clear(null, !1, !0, !0), this._processSubCameras(this.activeCameras[d]);
                else { if (!this.activeCamera) throw new Error("No camera defined");
                    this._processSubCameras(this.activeCamera) }
                this._checkIntersections(), e.AudioEngine && this._updateAudioParameters(), this.afterRender && this.afterRender(), this.onAfterRenderObservable.notifyObservers(this); for (var f = 0; f < this._toBeDisposed.length; f++) this._toBeDisposed.data[f].dispose(), this._toBeDisposed[f] = null;
                this._toBeDisposed.reset(), this.dumpNextRenderTargets && (this.dumpNextRenderTargets = !1), e.Tools.EndPerformanceCounter("Scene rendering"), this._lastFrameDuration.endMonitoring(), this._totalMeshesCounter.addCount(this.meshes.length, !0), this._totalLightsCounter.addCount(this.lights.length, !0), this._totalMaterialsCounter.addCount(this.materials.length, !0), this._totalTexturesCounter.addCount(this.textures.length, !0), this._activeBones.addCount(0, !0), this._activeIndices.addCount(0, !0), this._activeParticles.addCount(0, !0) } }, r.prototype._updateAudioParameters = function() { if (this.audioEnabled && (0 !== this.mainSoundTrack.soundCollection.length || 1 !== this.soundTracks.length)) { var t, i = e.Engine.audioEngine; if ((t = this.activeCameras.length > 0 ? this.activeCameras[0] : this.activeCamera) && i.canUseWebAudio) { i.audioContext.listener.setPosition(t.position.x, t.position.y, t.position.z); var r = e.Matrix.Invert(t.getViewMatrix()),
                        n = e.Vector3.TransformNormal(new e.Vector3(0, 0, -1), r);
                    n.normalize(), i.audioContext.listener.setOrientation(n.x, n.y, n.z, 0, 1, 0); var o; for (o = 0; o < this.mainSoundTrack.soundCollection.length; o++) { var s = this.mainSoundTrack.soundCollection[o];
                        s.useCustomAttenuation && s.updateDistanceFromListener() } for (o = 0; o < this.soundTracks.length; o++)
                        for (var a = 0; a < this.soundTracks[o].soundCollection.length; a++) s = this.soundTracks[o].soundCollection[a], s.useCustomAttenuation && s.updateDistanceFromListener() } } }, Object.defineProperty(r.prototype, "audioEnabled", { get: function() { return this._audioEnabled }, set: function(t) { this._audioEnabled = t, e.AudioEngine && (this._audioEnabled ? this._enableAudio() : this._disableAudio()) }, enumerable: !0, configurable: !0 }), r.prototype._disableAudio = function() { var e; for (e = 0; e < this.mainSoundTrack.soundCollection.length; e++) this.mainSoundTrack.soundCollection[e].pause(); for (e = 0; e < this.soundTracks.length; e++)
                for (var t = 0; t < this.soundTracks[e].soundCollection.length; t++) this.soundTracks[e].soundCollection[t].pause() }, r.prototype._enableAudio = function() { var e; for (e = 0; e < this.mainSoundTrack.soundCollection.length; e++) this.mainSoundTrack.soundCollection[e].isPaused && this.mainSoundTrack.soundCollection[e].play(); for (e = 0; e < this.soundTracks.length; e++)
                for (var t = 0; t < this.soundTracks[e].soundCollection.length; t++) this.soundTracks[e].soundCollection[t].isPaused && this.soundTracks[e].soundCollection[t].play() }, Object.defineProperty(r.prototype, "headphone", { get: function() { return this._headphone }, set: function(t) { this._headphone = t, e.AudioEngine && (this._headphone ? this._switchAudioModeForHeadphones() : this._switchAudioModeForNormalSpeakers()) }, enumerable: !0, configurable: !0 }), r.prototype._switchAudioModeForHeadphones = function() { this.mainSoundTrack.switchPanningModelToHRTF(); for (var e = 0; e < this.soundTracks.length; e++) this.soundTracks[e].switchPanningModelToHRTF() }, r.prototype._switchAudioModeForNormalSpeakers = function() { this.mainSoundTrack.switchPanningModelToEqualPower(); for (var e = 0; e < this.soundTracks.length; e++) this.soundTracks[e].switchPanningModelToEqualPower() }, r.prototype.enableDepthRenderer = function() { return this._depthRenderer ? this._depthRenderer : (this._depthRenderer = new e.DepthRenderer(this), this._depthRenderer) }, r.prototype.disableDepthRenderer = function() { this._depthRenderer && (this._depthRenderer.dispose(), this._depthRenderer = null) }, r.prototype.freezeMaterials = function() { for (var e = 0; e < this.materials.length; e++) this.materials[e].freeze() }, r.prototype.unfreezeMaterials = function() { for (var e = 0; e < this.materials.length; e++) this.materials[e].unfreeze() }, r.prototype.dispose = function() { this.beforeRender = null, this.afterRender = null, this.skeletons = [], this.morphTargetManagers = [], this._depthRenderer && this._depthRenderer.dispose(), this.activeCamera && (this.activeCamera._activeMeshes.dispose(), this.activeCamera = null), this._activeMeshes.dispose(), this._renderingManager.dispose(), this._processedMaterials.dispose(), this._activeParticleSystems.dispose(), this._activeSkeletons.dispose(), this._softwareSkinnedMeshes.dispose(), this._boundingBoxRenderer && this._boundingBoxRenderer.dispose(), this._edgesRenderers.dispose(), this._meshesForIntersections.dispose(), this._toBeDisposed.dispose(), this._debugLayer && this._debugLayer.hide(), this.onDisposeObservable.notifyObservers(this), this.onDisposeObservable.clear(), this.onBeforeRenderObservable.clear(), this.onAfterRenderObservable.clear(), this.detachControl(), e.AudioEngine && this.disposeSounds(); var t, i = this._engine.getRenderingCanvas(); for (t = 0; t < this.cameras.length; t++) this.cameras[t].detachControl(i); for (; this.lights.length;) this.lights[0].dispose(); for (; this.meshes.length;) this.meshes[0].dispose(!0); for (; this.cameras.length;) this.cameras[0].dispose(); for (; this.materials.length;) this.materials[0].dispose(); for (; this.particleSystems.length;) this.particleSystems[0].dispose(); for (; this.spriteManagers.length;) this.spriteManagers[0].dispose(); for (; this.layers.length;) this.layers[0].dispose(); for (; this.highlightLayers.length;) this.highlightLayers[0].dispose(); for (; this.textures.length;) this.textures[0].dispose();
            this.postProcessManager.dispose(), this._physicsEngine && this.disablePhysicsEngine(), t = this._engine.scenes.indexOf(this), t > -1 && this._engine.scenes.splice(t, 1), this._engine.wipeCaches(), this._engine = null }, Object.defineProperty(r.prototype, "isDisposed", { get: function() { return !this._engine }, enumerable: !0, configurable: !0 }), r.prototype.disposeSounds = function() { this.mainSoundTrack.dispose(); for (var e = 0; e < this.soundTracks.length; e++) this.soundTracks[e].dispose() }, r.prototype.getWorldExtends = function() { for (var t = new e.Vector3(Number.MAX_VALUE, Number.MAX_VALUE, Number.MAX_VALUE), i = new e.Vector3(-Number.MAX_VALUE, -Number.MAX_VALUE, -Number.MAX_VALUE), r = 0; r < this.meshes.length; r++) { var n = this.meshes[r];
                n.computeWorldMatrix(!0); var o = n.getBoundingInfo().boundingBox.minimumWorld,
                    s = n.getBoundingInfo().boundingBox.maximumWorld;
                e.Tools.CheckExtends(o, t, i), e.Tools.CheckExtends(s, t, i) } return { min: t, max: i } }, r.prototype.createOrUpdateSelectionOctree = function(t, i) { void 0 === t && (t = 64), void 0 === i && (i = 2), this._selectionOctree || (this._selectionOctree = new e.Octree(e.Octree.CreationFuncForMeshes, t, i)); var r = this.getWorldExtends(); return this._selectionOctree.update(r.min, r.max, this.meshes), this._selectionOctree }, r.prototype.createPickingRay = function(t, i, r, n, o) { void 0 === o && (o = !1); var s = this._engine; if (!n) { if (!this.activeCamera) throw new Error("Active camera not set");
                n = this.activeCamera } var a = n.viewport,
                h = a.toGlobal(s.getRenderWidth(), s.getRenderHeight()); return t = t / this._engine.getHardwareScalingLevel() - h.x, i = i / this._engine.getHardwareScalingLevel() - (this._engine.getRenderHeight() - h.y - h.height), e.Ray.CreateNew(t, i, h.width, h.height, r || e.Matrix.Identity(), o ? e.Matrix.Identity() : n.getViewMatrix(), n.getProjectionMatrix()) }, r.prototype.createPickingRayInCameraSpace = function(t, i, r) { if (!e.PickingInfo) return null; var n = this._engine; if (!r) { if (!this.activeCamera) throw new Error("Active camera not set");
                r = this.activeCamera } var o = r.viewport,
                s = o.toGlobal(n.getRenderWidth(), n.getRenderHeight()),
                a = e.Matrix.Identity(); return t = t / this._engine.getHardwareScalingLevel() - s.x, i = i / this._engine.getHardwareScalingLevel() - (this._engine.getRenderHeight() - s.y - s.height), e.Ray.CreateNew(t, i, s.width, s.height, a, a, r.getProjectionMatrix()) }, r.prototype._internalPick = function(t, i, r) { if (!e.PickingInfo) return null; for (var n = null, o = 0; o < this.meshes.length; o++) { var s = this.meshes[o]; if (i) { if (!i(s)) continue } else if (!s.isEnabled() || !s.isVisible || !s.isPickable) continue; var a = s.getWorldMatrix(),
                    h = t(a),
                    l = s.intersects(h, r); if (l && l.hit && ((r || null == n || !(l.distance >= n.distance)) && (n = l, r))) break } return n || new e.PickingInfo }, r.prototype._internalMultiPick = function(t, i) { if (!e.PickingInfo) return null; for (var r = new Array, n = 0; n < this.meshes.length; n++) { var o = this.meshes[n]; if (i) { if (!i(o)) continue } else if (!o.isEnabled() || !o.isVisible || !o.isPickable) continue; var s = o.getWorldMatrix(),
                    a = t(s),
                    h = o.intersects(a, !1);
                h && h.hit && r.push(h) } return r }, r.prototype._internalPickSprites = function(t, i, r, n) { if (!e.PickingInfo) return null; var o = null; if (n = n || this.activeCamera, this.spriteManagers.length > 0)
                for (var s = 0; s < this.spriteManagers.length; s++) { var a = this.spriteManagers[s]; if (a.isPickable) { var h = a.intersects(t, n, i, r); if (h && h.hit && (r || null == o || !(h.distance >= o.distance)) && (o = h, r)) break } }
            return o || new e.PickingInfo }, r.prototype.pick = function(e, t, i, r, n) { var o = this; return this._internalPick((function(i) { return o.createPickingRay(e, t, i, n) }), i, r) }, r.prototype.pickSprite = function(e, t, i, r, n) { return this._internalPickSprites(this.createPickingRayInCameraSpace(e, t, n), i, r, n) }, r.prototype.pickWithRay = function(t, i, r) { var n = this; return this._internalPick((function(i) { return n._pickWithRayInverseMatrix || (n._pickWithRayInverseMatrix = e.Matrix.Identity()), i.invertToRef(n._pickWithRayInverseMatrix), e.Ray.Transform(t, n._pickWithRayInverseMatrix) }), i, r) }, r.prototype.multiPick = function(e, t, i, r) { var n = this; return this._internalMultiPick((function(i) { return n.createPickingRay(e, t, i, r) }), i) }, r.prototype.multiPickWithRay = function(t, i) { var r = this; return this._internalMultiPick((function(i) { return r._pickWithRayInverseMatrix || (r._pickWithRayInverseMatrix = e.Matrix.Identity()), i.invertToRef(r._pickWithRayInverseMatrix), e.Ray.Transform(t, r._pickWithRayInverseMatrix) }), i) }, r.prototype.setPointerOverMesh = function(t) { this._pointerOverMesh !== t && (this._pointerOverMesh && this._pointerOverMesh.actionManager && this._pointerOverMesh.actionManager.processTrigger(e.ActionManager.OnPointerOutTrigger, e.ActionEvent.CreateNew(this._pointerOverMesh)), this._pointerOverMesh = t, this._pointerOverMesh && this._pointerOverMesh.actionManager && this._pointerOverMesh.actionManager.processTrigger(e.ActionManager.OnPointerOverTrigger, e.ActionEvent.CreateNew(this._pointerOverMesh))) }, r.prototype.getPointerOverMesh = function() { return this._pointerOverMesh }, r.prototype.setPointerOverSprite = function(t) { this._pointerOverSprite !== t && (this._pointerOverSprite && this._pointerOverSprite.actionManager && this._pointerOverSprite.actionManager.processTrigger(e.ActionManager.OnPointerOutTrigger, e.ActionEvent.CreateNewFromSprite(this._pointerOverSprite, this)), this._pointerOverSprite = t, this._pointerOverSprite && this._pointerOverSprite.actionManager && this._pointerOverSprite.actionManager.processTrigger(e.ActionManager.OnPointerOverTrigger, e.ActionEvent.CreateNewFromSprite(this._pointerOverSprite, this))) }, r.prototype.getPointerOverSprite = function() { return this._pointerOverSprite }, r.prototype.getPhysicsEngine = function() { return this._physicsEngine }, r.prototype.enablePhysics = function(t, i) { if (this._physicsEngine) return !0; try { return this._physicsEngine = new e.PhysicsEngine(t, i), !0 } catch (t) { return e.Tools.Error(t.message), !1 } }, r.prototype.disablePhysicsEngine = function() { this._physicsEngine && (this._physicsEngine.dispose(), this._physicsEngine = void 0) }, r.prototype.isPhysicsEnabled = function() { return void 0 !== this._physicsEngine }, r.prototype.deleteCompoundImpostor = function(e) { var t = e.parts[0].mesh;
            t.physicsImpostor.dispose(), t.physicsImpostor = null }, r.prototype.createDefaultCameraOrLight = function(t) { if (void 0 === t && (t = !1), 0 === this.lights.length && new e.HemisphericLight("default light", e.Vector3.Up(), this), !this.activeCamera) { var i, r = this.getWorldExtends(),
                    n = r.min.add(r.max.subtract(r.min).scale(.5));
                t ? (i = new e.ArcRotateCamera("default camera", 0, 0, 10, e.Vector3.Zero(), this), i.setPosition(new e.Vector3(n.x, n.y, r.min.z - (r.max.z - r.min.z))), i.lowerRadiusLimit = .5, i.setTarget(n)) : (i = new e.FreeCamera("default camera", e.Vector3.Zero(), this), i.position = new e.Vector3(n.x, n.y, r.min.z - (r.max.z - r.min.z)), i.setTarget(n)), i.minZ = .1; var o = r.max.subtract(r.min).length();
                i.wheelPrecision = 100 / o, this.activeCamera = i } }, r.prototype._getByTags = function(t, i, r) { if (void 0 === i) return t; var n = [];
            r = r || function(e) {}; for (var o in t) { var s = t[o];
                e.Tags.MatchesQuery(s, i) && (n.push(s), r(s)) } return n }, r.prototype.getMeshesByTags = function(e, t) { return this._getByTags(this.meshes, e, t) }, r.prototype.getCamerasByTags = function(e, t) { return this._getByTags(this.cameras, e, t) }, r.prototype.getLightsByTags = function(e, t) { return this._getByTags(this.lights, e, t) }, r.prototype.getMaterialByTags = function(e, t) { return this._getByTags(this.materials, e, t).concat(this._getByTags(this.multiMaterials, e, t)) }, r.prototype.setRenderingOrder = function(e, t, i, r) { void 0 === t && (t = null), void 0 === i && (i = null), void 0 === r && (r = null), this._renderingManager.setRenderingOrder(e, t, i, r) }, r.prototype.setRenderingAutoClearDepthStencil = function(e, t, i, r) { void 0 === i && (i = !0), void 0 === r && (r = !0), this._renderingManager.setRenderingAutoClearDepthStencil(e, t, i, r) }, r.prototype.markAllMaterialsAsDirty = function(e, t) { for (var i = 0, r = this.materials; i < r.length; i++) { var n = r[i];
                t && !t(n) || n.markAsDirty(e) } }, r
    })();
    a._FOGMODE_NONE = 0, a._FOGMODE_EXP = 1, a._FOGMODE_EXP2 = 2, a._FOGMODE_LINEAR = 3, a.MinDeltaTime = 1, a.MaxDeltaTime = 1e3, a.DragMovementThreshold = 10, a.LongPressDelay = 500, a.DoubleClickDelay = 300, a.ExclusiveDoubleClickMode = !1, e.Scene = a
})(BABYLON || (BABYLON = {}));
var BABYLON;
!(function(e) { var t = (function() {
        function t(t, i, r, n, o, s) { t instanceof e.Mesh ? this._engine = t.getScene().getEngine() : this._engine = t, this._updatable = r, this._data = i, this._strideSize = n, o || this.create(), this._instanced = s } return t.prototype.createVertexBuffer = function(t, i, r, n) { return new e.VertexBuffer(this._engine, this, t, this._updatable, !0, n || this._strideSize, this._instanced, i, r) }, t.prototype.isUpdatable = function() { return this._updatable }, t.prototype.getData = function() { return this._data }, t.prototype.getBuffer = function() { return this._buffer }, t.prototype.getStrideSize = function() { return this._strideSize }, t.prototype.getIsInstanced = function() { return this._instanced }, t.prototype.create = function(e) {!e && this._buffer || (e = e || this._data, this._buffer ? this._updatable && (this._engine.updateDynamicVertexBuffer(this._buffer, e), this._data = e) : this._updatable ? (this._buffer = this._engine.createDynamicVertexBuffer(e), this._data = e) : this._buffer = this._engine.createVertexBuffer(e)) }, t.prototype.update = function(e) { this.create(e) }, t.prototype.updateDirectly = function(e, t, i) { this._buffer && this._updatable && (this._engine.updateDynamicVertexBuffer(this._buffer, e, t, i ? i * this.getStrideSize() : void 0), this._data = null) }, t.prototype.dispose = function() { this._buffer && this._engine._releaseBuffer(this._buffer) && (this._buffer = null) }, t })();
    e.Buffer = t })(BABYLON || (BABYLON = {}));
var BABYLON;
!(function(e) { var t = (function() {
        function t(i, r, n, o, s, a, h, l, c) { if (!a) switch (n) {
                case t.PositionKind:
                case t.NormalKind:
                    a = 3; break;
                case t.UVKind:
                case t.UV2Kind:
                case t.UV3Kind:
                case t.UV4Kind:
                case t.UV5Kind:
                case t.UV6Kind:
                    a = 2; break;
                case t.TangentKind:
                case t.ColorKind:
                    a = 4; break;
                case t.MatricesIndicesKind:
                case t.MatricesIndicesExtraKind:
                    a = 4; break;
                case t.MatricesWeightsKind:
                case t.MatricesWeightsExtraKind:
                    a = 4 }
            r instanceof e.Buffer ? (a || (a = r.getStrideSize()), this._buffer = r, this._ownsBuffer = !1) : (this._buffer = new e.Buffer(i, r, o, a, s, h), this._ownsBuffer = !0), this._stride = a, this._offset = l || 0, this._size = c || a, this._kind = n } return t.prototype.getKind = function() { return this._kind }, t.prototype.isUpdatable = function() { return this._buffer.isUpdatable() }, t.prototype.getData = function() { return this._buffer.getData() }, t.prototype.getBuffer = function() { return this._buffer.getBuffer() }, t.prototype.getStrideSize = function() { return this._stride }, t.prototype.getOffset = function() { return this._offset }, t.prototype.getSize = function() { return this._size }, t.prototype.getIsInstanced = function() { return this._buffer.getIsInstanced() }, t.prototype.create = function(e) { return this._buffer.create(e) }, t.prototype.update = function(e) { return this._buffer.update(e) }, t.prototype.updateDirectly = function(e, t) { return this._buffer.updateDirectly(e, t) }, t.prototype.dispose = function() { this._ownsBuffer && this._buffer.dispose() }, Object.defineProperty(t, "PositionKind", { get: function() { return t._PositionKind }, enumerable: !0, configurable: !0 }), Object.defineProperty(t, "NormalKind", { get: function() { return t._NormalKind }, enumerable: !0, configurable: !0 }), Object.defineProperty(t, "TangentKind", { get: function() { return t._TangentKind }, enumerable: !0, configurable: !0 }), Object.defineProperty(t, "UVKind", { get: function() { return t._UVKind }, enumerable: !0, configurable: !0 }), Object.defineProperty(t, "UV2Kind", { get: function() { return t._UV2Kind }, enumerable: !0, configurable: !0 }), Object.defineProperty(t, "UV3Kind", { get: function() { return t._UV3Kind }, enumerable: !0, configurable: !0 }), Object.defineProperty(t, "UV4Kind", { get: function() { return t._UV4Kind }, enumerable: !0, configurable: !0 }), Object.defineProperty(t, "UV5Kind", { get: function() { return t._UV5Kind }, enumerable: !0, configurable: !0 }), Object.defineProperty(t, "UV6Kind", { get: function() { return t._UV6Kind }, enumerable: !0, configurable: !0 }), Object.defineProperty(t, "ColorKind", { get: function() { return t._ColorKind }, enumerable: !0, configurable: !0 }), Object.defineProperty(t, "MatricesIndicesKind", { get: function() { return t._MatricesIndicesKind }, enumerable: !0, configurable: !0 }), Object.defineProperty(t, "MatricesWeightsKind", { get: function() { return t._MatricesWeightsKind }, enumerable: !0, configurable: !0 }), Object.defineProperty(t, "MatricesIndicesExtraKind", { get: function() { return t._MatricesIndicesExtraKind }, enumerable: !0, configurable: !0 }), Object.defineProperty(t, "MatricesWeightsExtraKind", { get: function() { return t._MatricesWeightsExtraKind }, enumerable: !0, configurable: !0 }), t })();
    t._PositionKind = "position", t._NormalKind = "normal", t._TangentKind = "tangent", t._UVKind = "uv", t._UV2Kind = "uv2", t._UV3Kind = "uv3", t._UV4Kind = "uv4", t._UV5Kind = "uv5", t._UV6Kind = "uv6", t._ColorKind = "color", t._MatricesIndicesKind = "matricesIndices", t._MatricesWeightsKind = "matricesWeights", t._MatricesIndicesExtraKind = "matricesIndicesExtra", t._MatricesWeightsExtraKind = "matricesWeightsExtra", e.VertexBuffer = t })(BABYLON || (BABYLON = {}));
var BABYLON;
!(function(e) { var t = (function() {
        function t(t) { this._hasAlpha = !1, this.getAlphaFromRGB = !1, this.level = 1, this.coordinatesIndex = 0, this._coordinatesMode = e.Texture.EXPLICIT_MODE, this.wrapU = e.Texture.WRAP_ADDRESSMODE, this.wrapV = e.Texture.WRAP_ADDRESSMODE, this.anisotropicFilteringLevel = 4, this.isCube = !1, this.isRenderTarget = !1, this.animations = new Array, this.onDisposeObservable = new e.Observable, this.delayLoadState = e.Engine.DELAYLOADSTATE_NONE, this._scene = t || e.Engine.LastCreatedScene, this._scene.textures.push(this), this._uid = null } return Object.defineProperty(t.prototype, "hasAlpha", { get: function() { return this._hasAlpha }, set: function(t) { this._hasAlpha !== t && (this._hasAlpha = t, this._scene.markAllMaterialsAsDirty(e.Material.TextureDirtyFlag)) }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "coordinatesMode", { get: function() { return this._coordinatesMode }, set: function(t) { this._coordinatesMode !== t && (this._coordinatesMode = t, this._scene.markAllMaterialsAsDirty(e.Material.TextureDirtyFlag)) }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "uid", { get: function() { return this._uid || (this._uid = e.Tools.RandomId()), this._uid }, enumerable: !0, configurable: !0 }), t.prototype.toString = function() { return this.name }, Object.defineProperty(t.prototype, "onDispose", { set: function(e) { this._onDisposeObserver && this.onDisposeObservable.remove(this._onDisposeObserver), this._onDisposeObserver = this.onDisposeObservable.add(e) }, enumerable: !0, configurable: !0 }), t.prototype.getScene = function() { return this._scene }, t.prototype.getTextureMatrix = function() { return null }, t.prototype.getReflectionTextureMatrix = function() { return null }, t.prototype.getInternalTexture = function() { return this._texture }, t.prototype.isReady = function() { return this.delayLoadState === e.Engine.DELAYLOADSTATE_NOTLOADED || !!this._texture && this._texture.isReady }, t.prototype.getSize = function() { return this._texture._width ? new e.Size(this._texture._width, this._texture._height) : this._texture._size ? new e.Size(this._texture._size, this._texture._size) : e.Size.Zero() }, t.prototype.getBaseSize = function() { return this.isReady() && this._texture ? this._texture._size ? new e.Size(this._texture._size, this._texture._size) : new e.Size(this._texture._baseWidth, this._texture._baseHeight) : e.Size.Zero() }, t.prototype.scale = function(e) {}, Object.defineProperty(t.prototype, "canRescale", { get: function() { return !1 }, enumerable: !0, configurable: !0 }), t.prototype._removeFromCache = function(e, t) { for (var i = this._scene.getEngine().getLoadedTexturesCache(), r = 0; r < i.length; r++) { var n = i[r]; if (n.url === e && n.noMipmap === t) return void i.splice(r, 1) } }, t.prototype._getFromCache = function(e, t, i) { for (var r = this._scene.getEngine().getLoadedTexturesCache(), n = 0; n < r.length; n++) { var o = r[n]; if (o.url === e && o.noMipmap === t && (!i || i === o.samplingMode)) return o.references++, o } return null }, t.prototype.delayLoad = function() {}, t.prototype.clone = function() { return null }, t.prototype.releaseInternalTexture = function() { this._texture && (this._scene.getEngine().releaseInternalTexture(this._texture), delete this._texture) }, t.prototype.dispose = function() { this.getScene().stopAnimation(this), this._scene._removePendingData(this); var e = this._scene.textures.indexOf(this);
            e >= 0 && this._scene.textures.splice(e, 1), void 0 !== this._texture && (this.releaseInternalTexture(), this.onDisposeObservable.notifyObservers(this), this.onDisposeObservable.clear()) }, t.prototype.serialize = function() { if (!this.name) return null; var t = e.SerializationHelper.Serialize(this); return e.Animation.AppendSerializedAnimations(this, t), t }, t })();
    __decorate([e.serialize()], t.prototype, "name", void 0), __decorate([e.serialize("hasAlpha")], t.prototype, "_hasAlpha", void 0), __decorate([e.serialize()], t.prototype, "getAlphaFromRGB", void 0), __decorate([e.serialize()], t.prototype, "level", void 0), __decorate([e.serialize()], t.prototype, "coordinatesIndex", void 0), __decorate([e.serialize("coordinatesMode")], t.prototype, "_coordinatesMode", void 0), __decorate([e.serialize()], t.prototype, "wrapU", void 0), __decorate([e.serialize()], t.prototype, "wrapV", void 0), __decorate([e.serialize()], t.prototype, "anisotropicFilteringLevel", void 0), __decorate([e.serialize()], t.prototype, "isCube", void 0), __decorate([e.serialize()], t.prototype, "isRenderTarget", void 0), e.BaseTexture = t })(BABYLON || (BABYLON = {}));
var BABYLON;
!(function(e) {
        var t = (function(t) {
                    function i(r, n, o, s, a, h, l, c, u, d) { void 0 === o && (o = !1), void 0 === s && (s = !0), void 0 === a && (a = i.TRILINEAR_SAMPLINGMODE), void 0 === h && (h = null), void 0 === l && (l = null), void 0 === c && (c = null), void 0 === u && (u = !1); var f = t.call(this, n) || this; if (f.uOffset = 0, f.vOffset = 0, f.uScale = 1, f.vScale = 1, f.uAng = 0, f.vAng = 0, f.wAng = 0, f.name = r, f.url = r, f._noMipmap = o, f._invertY = s, f._samplingMode = a, f._buffer = c, f._deleteBuffer = u, f._format = d, !r) return f;
                        f._texture = f._getFromCache(r, o, a); var p = function() { f._onLoadObservarble && f._onLoadObservarble.hasObservers() && f.onLoadObservable.notifyObservers(!0), h && h() }; return f._texture ? f._texture.isReady ? e.Tools.SetImmediate((function() { return p() })) : f._texture.onLoadedCallbacks.push(p) : n.useDelayedTextureLoading ? (f.delayLoadState = e.Engine.DELAYLOADSTATE_NOTLOADED, f._delayedOnLoad = p, f._delayedOnError = l) : (f._texture = n.getEngine().createTexture(r, o, s, n, f._samplingMode, p, l, f._buffer, null, f._format), u && delete f._buffer), f }
                    return __extends(i, t), Object.defineProperty(i.prototype, "noMipmap", { get: function() { return this._noMipmap }, enumerable: !0, configurable: !0 }), i.prototype.delayLoad = function() { this.delayLoadState === e.Engine.DELAYLOADSTATE_NOTLOADED && (this.delayLoadState = e.Engine.DELAYLOADSTATE_LOADED, this._texture = this._getFromCache(this.url, this._noMipmap, this._samplingMode), this._texture || (this._texture = this.getScene().getEngine().createTexture(this.url, this._noMipmap, this._invertY, this.getScene(), this._samplingMode, this._delayedOnLoad, this._delayedOnError, this._buffer, null, this._format), this._deleteBuffer && delete this._buffer)) }, i.prototype.updateSamplingMode = function(e) { this._texture && (this._samplingMode = e, this.getScene().getEngine().updateTextureSamplingMode(e, this._texture)) }, i.prototype._prepareRowForTextureGeneration = function(t, i, r, n) { t *= this.uScale, i *= this.vScale, t -= .5 * this.uScale, i -= .5 * this.vScale, r -= .5, e.Vector3.TransformCoordinatesFromFloatsToRef(t, i, r, this._rowGenerationMatrix, n), n.x += .5 * this.uScale + this.uOffset, n.y += .5 * this.vScale + this.vOffset, n.z += .5 }, i.prototype.getTextureMatrix = function() {
                            return this.uOffset === this._cachedUOffset && this.vOffset === this._cachedVOffset && this.uScale === this._cachedUScale && this.vScale === this._cachedVScale && this.uAng === this._cachedUAng && this.vAng === this._cachedVAng && this.wAng === this._cachedWAng ? this._cachedTextureMatrix : (this._cachedUOffset = this.uOffset, this._cachedVOffset = this.vOffset, this._cachedUScale = this.uScale, this._cachedVScale = this.vScale, this._cachedUAng = this.uAng, this._cachedVAng = this.vAng, this._cachedWAng = this.wAng, this._cachedTextureMatrix || (this._cachedTextureMatrix = e.Matrix.Zero(), this._rowGenerationMatrix = new e.Matrix, this._t0 = e.Vector3.Zero(), this._t1 = e.Vector3.Zero(), this._t2 = e.Vector3.Zero()), e.Matrix.RotationYawPitchRollToRef(this.vAng, this.uAng, this.wAng, this._rowGenerationMatrix), this._prepareRowForTextureGeneration(0, 0, 0, this._t0), this._prepareRowForTextureGeneration(1, 0, 0, this._t1), this._prepareRowForTextureGeneration(0, 1, 0, this._t2), this._t1.subtractInPlace(this._t0), this._t2.subtractInPlace(this._t0), e.Matrix.IdentityToRef(this._cachedTextureMatrix), this._cachedTextureMatrix.m[0] = this._t1.x, this._cachedTextureMatrix.m[1] = this._t1.y, this._cachedTextureMatrix.m[2] = this._t1.z, this._cachedTextureMatrix.m[4] = this._t2.x, this._cachedTextureMatrix.m[5] = this._t2.y, this._cachedTextureMatrix.m[6] = this._t2.z, this._cachedTextureMatrix.m[8] = this._t0.x, this._cachedTextureMatrix.m[9] = this._t0.y, this._cachedTextureMatrix.m[10] = this._t0.z, this._cachedTextureMatrix)
                        }, i.prototype.getReflectionTextureMatrix = function() { if (this.uOffset === this._cachedUOffset && this.vOffset === this._cachedVOffset && this.uScale === this._cachedUScale && this.vScale === this._cachedVScale && this.coordinatesMode === this._cachedCoordinatesMode) return this._cachedTextureMatrix; switch (this._cachedTextureMatrix || (this._cachedTextureMatrix = e.Matrix.Zero(), this._projectionModeMatrix = e.Matrix.Zero()), this._cachedCoordinatesMode = this.coordinatesMode, this.coordinatesMode) {
                                case i.PLANAR_MODE:
                                    e.Matrix.IdentityToRef(this._cachedTextureMatrix), this._cachedTextureMatrix[0] = this.uScale, this._cachedTextureMatrix[5] = this.vScale, this._cachedTextureMatrix[12] = this.uOffset, this._cachedTextureMatrix[13] = this.vOffset; break;
                                case i.PROJECTION_MODE:
                                    e.Matrix.IdentityToRef(this._projectionModeMatrix), this._projectionModeMatrix.m[0] = .5, this._projectionModeMatrix.m[5] = -.5, this._projectionModeMatrix.m[10] = 0, this._projectionModeMatrix.m[12] = .5, this._projectionModeMatrix.m[13] = .5, this._projectionModeMatrix.m[14] = 1, this._projectionModeMatrix.m[15] = 1, this.getScene().getProjectionMatrix().multiplyToRef(this._projectionModeMatrix, this._cachedTextureMatrix); break;
                                default:
                                    e.Matrix.IdentityToRef(this._cachedTextureMatrix) } return this._cachedTextureMatrix }, i.prototype.clone = function() { var t = this; return e.SerializationHelper.Clone((function() { return new i(t._texture.url, t.getScene(), t._noMipmap, t._invertY, t._samplingMode) }), this) }, Object.defineProperty(i.prototype, "onLoadObservable", { get: function() { return this._onLoadObservarble || (this._onLoadObservarble = new e.Observable), this._onLoadObservarble }, enumerable: !0, configurable: !0 }), i.CreateFromBase64String = function(t, r, n, o, s, a, h, l, c) { return void 0 === a && (a = i.TRILINEAR_SAMPLINGMODE), void 0 === h && (h = null), void 0 === l && (l = null), void 0 === c && (c = e.Engine.TEXTUREFORMAT_RGBA), new i("data:" + r, n, o, s, a, h, l, t, !1, c) }, i.Parse = function(t, r, n) { if (t.customType) { var o = e.Tools.Instantiate(t.customType),
                                    s = o.Parse(t, r, n); return t.samplingMode && s.updateSamplingMode && s._samplingMode && s._samplingMode !== t.samplingMode && s.updateSamplingMode(t.samplingMode), s } if (t.isCube) return e.CubeTexture.Parse(t, r, n); if (!t.name && !t.isRenderTarget) return null; var a = e.SerializationHelper.Parse((function() { if (t.mirrorPlane) { var o = new e.MirrorTexture(t.name, t.renderTargetSize, r); return o._waitingRenderList = t.renderList, o.mirrorPlane = e.Plane.FromArray(t.mirrorPlane), o } if (t.isRenderTarget) { var s = new e.RenderTargetTexture(t.name, t.renderTargetSize, r); return s._waitingRenderList = t.renderList, s } return t.base64String ? i.CreateFromBase64String(t.base64String, t.name, r) : new i(n + t.name, r) }), t, r); if (t.samplingMode) { var h = t.samplingMode;
                                a._samplingMode !== h &&